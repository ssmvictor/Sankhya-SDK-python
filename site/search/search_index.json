{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Sankhya SDK Python","text":"<p>Biblioteca Python para integra\u00e7\u00e3o com a API Sankhya, oferecendo uma interface moderna e intuitiva para opera\u00e7\u00f5es CRUD, gerenciamento de sess\u00f5es e servi\u00e7os espec\u00edficos.</p> <ul> <li> <p> In\u00edcio R\u00e1pido</p> <p>Configure o SDK e crie sua primeira integra\u00e7\u00e3o em minutos.</p> <p> Come\u00e7ar</p> </li> <li> <p> Conceitos Fundamentais</p> <p>Entenda a arquitetura, sess\u00f5es e sistema de entidades.</p> <p> Conceitos</p> </li> <li> <p> Refer\u00eancia da API</p> <p>Documenta\u00e7\u00e3o completa de classes, m\u00e9todos e tipos.</p> <p> API Reference</p> </li> <li> <p> Exemplos</p> <p>Exemplos pr\u00e1ticos para casos de uso comuns.</p> <p> Exemplos</p> </li> </ul>"},{"location":"#instalacao","title":"Instala\u00e7\u00e3o","text":"Bash<pre><code>pip install sankhya-sdk-python\n</code></pre>"},{"location":"#exemplo-rapido","title":"Exemplo R\u00e1pido","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n    partners = crud.find(Partner, \"ATIVO = 'S'\", max_results=10)\n\n    for partner in partners:\n        print(f\"{partner.code_partner}: {partner.name}\")\n</code></pre>"},{"location":"#recursos-principais","title":"Recursos Principais","text":"Recurso Descri\u00e7\u00e3o Opera\u00e7\u00f5es CRUD Find, Insert, Update, Remove com entidades tipadas Pagina\u00e7\u00e3o Consultas paginadas para grandes volumes de dados Sess\u00f5es Gerenciamento de m\u00faltiplas sess\u00f5es e multi-threading Async/Await Suporte completo a opera\u00e7\u00f5es ass\u00edncronas Servi\u00e7os Espec\u00edficos NF-e, faturamento, arquivos e imagens Valida\u00e7\u00f5es Sistema de valida\u00e7\u00e3o de entidades"},{"location":"#compatibilidade","title":"Compatibilidade","text":"<ul> <li>Python: 3.10+</li> <li>Sankhya API: Todas as vers\u00f5es suportadas</li> <li>Sistemas: Windows, Linux, macOS</li> </ul>"},{"location":"#licenca","title":"Licen\u00e7a","text":"<p>Este projeto est\u00e1 licenciado sob a MIT License.</p>"},{"location":"attributes/","title":"Sistema de Atributos (Decoradores)","text":"<p>O Sankhya SDK para Python utiliza um sistema de decoradores baseado em Pydantic v2 para mapear classes Python para entidades da API Sankhya, replicando a funcionalidade do SDK .NET.</p>"},{"location":"attributes/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Os decoradores permitem definir metadados em classes e campos, que s\u00e3o usados para: 1. Mapear nomes de classes para nomes de entidades Sankhya. 2. Mapear nomes de propriedades para nomes de campos XML. 3. Identificar chaves prim\u00e1rias. 4. Controlar a serializa\u00e7\u00e3o e o rastreamento de modifica\u00e7\u00f5es (dirty tracking). 5. Validar restri\u00e7\u00f5es de dados (ex: tamanho m\u00e1ximo).</p>"},{"location":"attributes/#decoradores-disponiveis","title":"Decoradores Dispon\u00edveis","text":""},{"location":"attributes/#decoradores-de-classe","title":"Decoradores de Classe","text":"Decorador Descri\u00e7\u00e3o Exemplo <code>@entity(name)</code> Define o nome da entidade Sankhya. <code>@entity(\"Parceiro\")</code>"},{"location":"attributes/#decoradores-de-campo","title":"Decoradores de Campo","text":"Decorador Descri\u00e7\u00e3o Exemplo <code>entity_key()</code> Marca o campo como chave prim\u00e1ria. <code>id: int = entity_key()</code> <code>entity_element(name)</code> Mapeia o campo para um elemento XML espec\u00edfico. <code>name: str = entity_element(\"NOMEPARC\")</code> <code>entity_reference()</code> Marca um relacionamento com outra entidade. <code>partner: Partner = entity_reference()</code> <code>entity_ignore()</code> Ignora o campo na serializa\u00e7\u00e3o. <code>temp: str = entity_ignore()</code> <code>entity_custom_data(max_length)</code> Adiciona metadados de valida\u00e7\u00e3o. <code>code: str = entity_custom_data(max_length=10)</code>"},{"location":"attributes/#exemplo-de-uso","title":"Exemplo de Uso","text":"Python<pre><code>from typing import Optional\nfrom sankhya_sdk.attributes import entity, entity_key, entity_element, entity_custom_data\nfrom sankhya_sdk.models import EntityBase\n\n@entity(\"Parceiro\")\nclass Partner(EntityBase):\n    code: int = entity_key(entity_element(\"CODPARC\"))\n    name: str = entity_element(\"NOMEPARC\")\n    document: Optional[str] = entity_custom_data(max_length=14, field=entity_element(\"CGC_CPF\"))\n</code></pre>"},{"location":"attributes/#comparativo-net-vs-python","title":"Comparativo .NET vs Python","text":"Recurso .NET (Atributos) Python (Decoradores) Entidade <code>[Entity(\"Nome\")]</code> <code>@entity(\"Nome\")</code> Chave <code>[EntityKey]</code> <code>entity_key()</code> Elemento XML <code>[EntityElement(\"XML\")]</code> <code>entity_element(\"XML\")</code> Ignorar <code>[EntityIgnore]</code> <code>entity_ignore()</code> Valida\u00e7\u00e3o <code>[EntityCustomData(MaxLength=10)]</code> <code>entity_custom_data(max_length=10)</code> Dirty Tracking Flags <code>_fieldSet</code> Atributo <code>_fields_set</code> e <code>model_fields_set</code>"},{"location":"attributes/#introspeccao-e-reflexao","title":"Introspec\u00e7\u00e3o e Reflex\u00e3o","text":"<p>O m\u00f3dulo <code>sankhya_sdk.attributes.reflection</code> fornece fun\u00e7\u00f5es para extrair esses metadados em tempo de execu\u00e7\u00e3o:</p> <ul> <li><code>get_entity_name(cls)</code>: Retorna o nome mapeado da entidade.</li> <li><code>extract_keys(entity)</code>: Extrai as chaves prim\u00e1rias e seus valores.</li> <li><code>get_field_metadata(field_info)</code>: Retorna todos os metadados associados a um campo.</li> </ul>"},{"location":"enums/","title":"Enumera\u00e7\u00f5es do SDK Sankhya","text":"<p>O SDK Sankhya utiliza um sistema de enums tipados com metadados para replicar a funcionalidade dos atributos do .NET.</p>"},{"location":"enums/#sistema-de-metadados","title":"Sistema de Metadados","text":"<p>A classe base <code>MetadataEnum</code> permite associar metadados a cada membro do enum, como valores internos da API e descri\u00e7\u00f5es leg\u00edveis.</p>"},{"location":"enums/#propriedades-disponiveis","title":"Propriedades Dispon\u00edveis","text":"<p>Todos os enums que herdam de <code>MetadataEnum</code> possuem as seguintes propriedades:</p> <ul> <li><code>internal_value</code>: O valor string usado na comunica\u00e7\u00e3o com a API Sankhya.</li> <li><code>human_readable</code>: Uma descri\u00e7\u00e3o amig\u00e1vel do membro do enum.</li> <li><code>metadata</code>: Acesso direto ao objeto <code>EnumMetadata</code>.</li> </ul>"},{"location":"enums/#exemplo-de-uso","title":"Exemplo de Uso","text":"Python<pre><code>from sankhya_sdk.enums import FiscalPersonType, ServiceName\n\n# Acessando valores\nprint(FiscalPersonType.INDIVIDUAL.internal_value)  # Sa\u00edda: \"F\"\nprint(FiscalPersonType.INDIVIDUAL.human_readable)  # Sa\u00edda: \"Pessoa f\u00edsica\"\n\n# Usando em strings (serializa\u00e7\u00e3o autom\u00e1tica para internal_value)\nprint(f\"Tipo: {FiscalPersonType.CORPORATION}\")  # Sa\u00edda: \"Tipo: J\"\n\n# Enums complexos (ServiceName)\nservice = ServiceName.CRUD_FIND\nprint(service.service_module)    # Sa\u00edda: ServiceModule.MGE\nprint(service.service_category)  # Sa\u00edda: ServiceCategory.CRUD\nprint(service.service_type)      # Sa\u00edda: ServiceType.RETRIEVE\n</code></pre>"},{"location":"enums/#lista-de-enums-disponiveis","title":"Lista de Enums Dispon\u00edveis","text":"Enum Descri\u00e7\u00e3o <code>ServiceName</code> Nomes dos servi\u00e7os da API <code>ServiceModule</code> M\u00f3dulos do sistema (MGE, MGECOM, etc) <code>ServiceCategory</code> Categorias de servi\u00e7o (CRUD, Invoice, etc) <code>ServiceType</code> Tipos de servi\u00e7o (Retrieve, Transactional, etc) <code>FiscalPersonType</code> Tipo de pessoa (F\u00edsica/Jur\u00eddica) <code>InvoiceStatus</code> Status de faturas <code>MovementType</code> Tipos de movimento financeiro/estoque ... e outros 22 enums."},{"location":"enums/#implementacao-tecnica","title":"Implementa\u00e7\u00e3o T\u00e9cnica","text":"<p>Os enums s\u00e3o implementados usando uma tupla no valor do membro, onde o primeiro elemento \u00e9 o valor real do enum e o segundo \u00e9 um objeto <code>EnumMetadata</code>.</p> Python<pre><code>class MyEnum(MetadataEnum):\n    MEMBER = (\"MemberValue\", EnumMetadata(internal_value=\"m\", human_readable=\"Human Member\"))\n</code></pre>"},{"location":"exceptions/","title":"Hierarquia de Exce\u00e7\u00f5es","text":"<p>O Sankhya SDK utiliza uma hierarquia robusta de exce\u00e7\u00f5es para fornecer informa\u00e7\u00f5es detalhadas sobre erros que ocorrem durante a intera\u00e7\u00e3o com o web service do Sankhya.</p>"},{"location":"exceptions/#estrutura-principal","title":"Estrutura Principal","text":"<p>A base de todas as exce\u00e7\u00f5es customizadas \u00e9 a <code>SankhyaException</code>. Para erros relacionados a requisi\u00e7\u00f5es de servi\u00e7o, a base \u00e9 <code>ServiceRequestGeneralException</code>, que implementa o protocolo <code>IXmlServiceException</code>.</p>"},{"location":"exceptions/#diagrama-da-hierarquia","title":"Diagrama da Hierarquia","text":"<pre><code>classDiagram\n    Exception &lt;|-- SankhyaException\n    Exception &lt;|-- InvalidKeyFileException\n    Exception &lt;|-- ServiceRequestInvalidAuthorizationException\n    Exception &lt;|-- CanceledOnDemandRequestWrapperException\n    Exception &lt;|-- TooInnerLevelsException\n    Exception &lt;|-- ServiceRequestExpiredAuthenticationException\n    Exception &lt;|-- ServiceRequestInvalidCredentialsException\n\n    SankhyaException &lt;|-- ServiceRequestGeneralException\n    ServiceRequestGeneralException &lt;|-- ServiceRequestTemporarilyException\n    ServiceRequestGeneralException &lt;|-- ServiceRequestPropertyNameException\n    ServiceRequestGeneralException &lt;|-- ServiceRequestCanceledQueryException\n    ServiceRequestGeneralException &lt;|-- PagedRequestException\n    ServiceRequestGeneralException &lt;|-- ConfirmInvoiceException\n    ServiceRequestGeneralException &lt;|-- RemoveInvoiceException\n\n    ServiceRequestTemporarilyException &lt;|-- ServiceRequestTimeoutException\n\n    class IXmlServiceException {\n        &lt;&lt;interface&gt;&gt;\n        +request_xml: Optional[str]\n        +response_xml: Optional[str]\n    }\n\n    class ServiceRequestGeneralException {\n        +request: Optional[Any]\n        +response: Optional[Any]\n        +request_xml: Optional[str]\n        +response_xml: Optional[str]\n    }</code></pre>"},{"location":"exceptions/#categorias-de-excecoes","title":"Categorias de Exce\u00e7\u00f5es","text":""},{"location":"exceptions/#autenticacao-e-autorizacao","title":"Autentica\u00e7\u00e3o e Autoriza\u00e7\u00e3o","text":"<p>Usadas para erros relacionados ao processo de login e permiss\u00f5es.</p> <ul> <li><code>ServiceRequestInvalidAuthorizationException</code>: Acesso n\u00e3o autorizado.</li> <li><code>ServiceRequestInvalidCredentialsException</code>: Credenciais inv\u00e1lidas.</li> <li><code>ServiceRequestExpiredAuthenticationException</code>: Sess\u00e3o expirada.</li> </ul>"},{"location":"exceptions/#erros-de-validacao-de-requisicao","title":"Erros de Valida\u00e7\u00e3o de Requisi\u00e7\u00e3o","text":"<p>Lan\u00e7adas quando os dados enviados na requisi\u00e7\u00e3o n\u00e3o est\u00e3o em conformidade com o esperado pelo Sankhya.</p> <ul> <li><code>ServiceRequestPropertyNameException</code>: Campo n\u00e3o encontrado na entidade.</li> <li><code>ServiceRequestPropertyValueException</code>: Valor do campo inv\u00e1lido.</li> <li><code>ServiceRequestPropertyWidthException</code>: Tamanho do valor excede o permitido.</li> <li><code>ServiceRequestAttributeException</code>: Atributo obrigat\u00f3rio ausente.</li> </ul>"},{"location":"exceptions/#erros-temporarios-e-infraestrutura","title":"Erros Tempor\u00e1rios e Infraestrutura","text":"<p>Erros que podem ser resolvidos com uma nova tentativa (retry).</p> <ul> <li><code>ServiceRequestTemporarilyException</code>: Erro tempor\u00e1rio gen\u00e9rico.</li> <li><code>ServiceRequestTimeoutException</code>: Tempo limite da requisi\u00e7\u00e3o excedido.</li> <li><code>ServiceRequestInaccessibleException</code>: Servidor Sankhya inacess\u00edvel.</li> <li><code>ServiceRequestUnavailableException</code>: Servi\u00e7o temporariamente indispon\u00edvel.</li> </ul>"},{"location":"exceptions/#erros-de-operacao-de-negocio","title":"Erros de Opera\u00e7\u00e3o de Neg\u00f3cio","text":"<p>Lan\u00e7adas durante opera\u00e7\u00f5es espec\u00edficas como confirma\u00e7\u00e3o de nota fiscal.</p> <ul> <li><code>ConfirmInvoiceException</code>: Erro ao confirmar nota.</li> <li><code>NoItemsConfirmInvoiceException</code>: Tentativa de confirmar nota sem itens.</li> <li><code>RemoveInvoiceException</code>: Erro ao remover nota.</li> </ul>"},{"location":"exceptions/#como-usar","title":"Como Usar","text":"<p>Todas as exce\u00e7\u00f5es est\u00e3o dispon\u00edveis no m\u00f3dulo <code>sankhya_sdk.exceptions</code>.</p> Python<pre><code>from sankhya_sdk.exceptions import SankhyaException, ServiceRequestTimeoutException\n\ntry:\n    # Executa opera\u00e7\u00e3o no SDK\n    ...\nexcept ServiceRequestTimeoutException:\n    # Trata timeout especificamente\n    ...\nexcept SankhyaException as e:\n    # Trata qualquer erro do SDK\n    print(f\"Erro no SDK: {e}\")\n</code></pre> <p>Ao capturar uma <code>ServiceRequestGeneralException</code>, voc\u00ea pode acessar o XML da requisi\u00e7\u00e3o e da resposta (se dispon\u00edveis):</p> Python<pre><code>except ServiceRequestGeneralException as e:\n    print(f\"Request XML: {e.request_xml}\")\n    print(f\"Response XML: {e.response_xml}\")\n</code></pre>"},{"location":"helpers/","title":"Helpers Module","text":"<p>Este m\u00f3dulo fornece interfaces, dataclasses, extens\u00f5es e utilit\u00e1rios para manipula\u00e7\u00e3o de entidades e requisi\u00e7\u00f5es de servi\u00e7o no Sankhya SDK.</p>"},{"location":"helpers/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O m\u00f3dulo helpers foi migrado do SDK .NET e inclui:</p> Componente Tipo Descri\u00e7\u00e3o <code>IFilterExpression</code> Protocol Interface para express\u00f5es de filtro <code>EntityQueryOptions</code> Dataclass Op\u00e7\u00f5es de configura\u00e7\u00e3o para queries <code>StatusMessageHelper</code> Classe Processamento de mensagens de erro <code>EntityExtensions</code> Fun\u00e7\u00f5es Utilit\u00e1rios para entidades <code>ServiceRequestExtensions</code> Classe Resolu\u00e7\u00e3o de requests <code>GenericServiceEntity</code> ABC Serializa\u00e7\u00e3o XML de entidades <code>EntityDynamicSerialization</code> Classe Convers\u00e3o din\u00e2mica de tipos"},{"location":"helpers/#uso-basico","title":"Uso B\u00e1sico","text":""},{"location":"helpers/#ifilterexpression","title":"IFilterExpression","text":"Python<pre><code>from sankhya_sdk.helpers import IFilterExpression\n\nclass MyFilter:\n    def build_expression(self) -&gt; str:\n        return \"CODPARC = 123 AND ATIVO = 'S'\"\n\nfilter = MyFilter()\nexpression = filter.build_expression()\n</code></pre>"},{"location":"helpers/#entityqueryoptions","title":"EntityQueryOptions","text":"Python<pre><code>from datetime import timedelta\nfrom sankhya_sdk.helpers import EntityQueryOptions\n\n# Valores padr\u00e3o (30 min timeout)\noptions = EntityQueryOptions()\n\n# Personalizado\noptions = EntityQueryOptions(\n    max_results=100,\n    include_references=True,\n    max_reference_depth=3,\n    timeout=timedelta(minutes=5),\n)\n\n# Fluent API\noptions = EntityQueryOptions().with_max_results(50).with_references(True)\n</code></pre>"},{"location":"helpers/#statusmessagehelper","title":"StatusMessageHelper","text":"Python<pre><code>from sankhya_sdk.helpers import StatusMessageHelper\n\n# Processa mensagem de status e lan\u00e7a exce\u00e7\u00e3o apropriada\nStatusMessageHelper.process_status_message(service, request, response)\n</code></pre>"},{"location":"helpers/#entityextensions","title":"EntityExtensions","text":"Python<pre><code>from sankhya_sdk.helpers import extract_keys\n\n# Extrai chaves prim\u00e1rias de uma entidade\nresult = extract_keys(partner)\nprint(result.keys)  # [{'name': 'CODPARC', 'value': '123'}]\n</code></pre>"},{"location":"helpers/#servicerequestextensions","title":"ServiceRequestExtensions","text":"Python<pre><code>from sankhya_sdk.helpers import ServiceRequestExtensions, resolve\nfrom sankhya_sdk.models.service import ServiceRequest\nfrom sankhya_sdk.enums import ServiceName\n\nrequest = ServiceRequest(ServiceName.CRUD_SERVICE_FIND)\n\n# Resolve baseado no tipo da entidade\nServiceRequestExtensions.resolve_generic(request, Partner)\n\n# Ou usando fun\u00e7\u00e3o de conveni\u00eancia\nresolve(request, Partner)\n</code></pre>"},{"location":"helpers/#genericserviceentity","title":"GenericServiceEntity","text":"Python<pre><code>from sankhya_sdk.helpers import GenericServiceEntity\n\nclass MyEntity(GenericServiceEntity):\n    code: int\n    name: str\n\nentity = MyEntity(code=1, name=\"Test\")\nxml = entity.to_xml_string()\n</code></pre>"},{"location":"helpers/#entitydynamicserialization","title":"EntityDynamicSerialization","text":"Python<pre><code>from sankhya_sdk.helpers import EntityDynamicSerialization\n\ndata = {\"CODPARC\": \"123\", \"NOMEPARC\": \"Test\"}\nserializer = EntityDynamicSerialization(data)\npartner = serializer.convert_to_type(Partner)\n</code></pre>"},{"location":"helpers/#comparacao-net-vs-python","title":"Compara\u00e7\u00e3o .NET vs Python","text":".NET Python <code>IFilterExpression</code> interface <code>IFilterExpression</code> Protocol <code>EntityQueryOptions</code> class <code>EntityQueryOptions</code> Pydantic model <code>TimeSpan</code> <code>timedelta</code> Extension methods Fun\u00e7\u00f5es standalone ou m\u00e9todos est\u00e1ticos <code>ReferenceLevel</code> enum <code>ReferenceLevel</code> MetadataEnum <code>XmlSerializer</code> <code>lxml.etree</code> <code>IEntity</code> <code>EntityBase</code>"},{"location":"helpers/#propriedades-de-entityqueryoptions","title":"Propriedades de EntityQueryOptions","text":"Propriedade Tipo Padr\u00e3o Descri\u00e7\u00e3o <code>max_results</code> <code>Optional[int]</code> <code>None</code> Limite de resultados <code>include_references</code> <code>Optional[bool]</code> <code>None</code> Incluir refer\u00eancias <code>max_reference_depth</code> <code>Optional[int]</code> <code>None</code> Profundidade m\u00e1xima <code>include_presentation_fields</code> <code>Optional[bool]</code> <code>None</code> Campos de apresenta\u00e7\u00e3o <code>use_wildcard_fields</code> <code>Optional[bool]</code> <code>None</code> Usar wildcard (*) <code>timeout</code> <code>timedelta</code> 30 min Tempo limite"},{"location":"helpers/#dependencias-futuras","title":"Depend\u00eancias Futuras","text":"<p>Algumas fun\u00e7\u00f5es dependem de componentes que ser\u00e3o implementados em fases futuras:</p> <ul> <li><code>query()</code>, <code>query_with_criteria()</code>, <code>query_light()</code> \u2192 <code>PagedRequestWrapper</code></li> <li><code>update_on_demand()</code>, <code>remove_on_demand()</code> \u2192 <code>OnDemandRequestFactory</code></li> </ul> <p>Essas fun\u00e7\u00f5es atualmente lan\u00e7am <code>NotImplementedError</code> e ser\u00e3o habilitadas quando as depend\u00eancias forem implementadas.</p>"},{"location":"know_services/","title":"KnowServicesRequestWrapper","text":"<p>O <code>KnowServicesRequestWrapper</code> fornece m\u00e9todos de conveni\u00eancia para servi\u00e7os conhecidos (known services) da API Sankhya, facilitando opera\u00e7\u00f5es comuns como gerenciamento de sess\u00f5es, mensagens, notas fiscais, opera\u00e7\u00f5es financeiras e arquivos.</p>"},{"location":"know_services/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Esta classe foi migrada do SDK .NET (<code>Sankhya-SDK-dotnet/Src/Sankhya/RequestWrappers/KnowServicesRequestWrapper.cs</code>) e implementa o mesmo padr\u00e3o de extens\u00f5es est\u00e1ticas utilizado no C#, adaptado para Python como m\u00e9todos de classe.</p>"},{"location":"know_services/#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Gerenciamento de Sess\u00e3o: Sess\u00e3o dedicada do tipo <code>KNOW_SERVICES</code></li> <li>Context Manager: Suporte a <code>with</code> e <code>async with</code> para gerenciamento autom\u00e1tico de recursos</li> <li>M\u00e9todos S\u00edncronos e Ass\u00edncronos: Opera\u00e7\u00f5es de I/O dispon\u00edveis em ambas vers\u00f5es</li> <li>Logging Detalhado: Logs em n\u00edveis INFO, DEBUG e WARNING</li> <li>Tratamento de Exce\u00e7\u00f5es: Exce\u00e7\u00f5es espec\u00edficas para cada tipo de opera\u00e7\u00e3o</li> </ul>"},{"location":"know_services/#inicio-rapido","title":"In\u00edcio R\u00e1pido","text":""},{"location":"know_services/#inicializacao-manual","title":"Inicializa\u00e7\u00e3o Manual","text":"Python<pre><code>from sankhya_sdk.request_wrappers import KnowServicesRequestWrapper\n\n# Inicializar\nKnowServicesRequestWrapper.initialize()\n\ntry:\n    # Usar os m\u00e9todos\n    sessions = KnowServicesRequestWrapper.get_sessions()\n    print(f\"Sess\u00f5es ativas: {len(sessions)}\")\nfinally:\n    # Sempre limpar recursos\n    KnowServicesRequestWrapper.dispose()\n</code></pre>"},{"location":"know_services/#com-context-manager","title":"Com Context Manager","text":"Python<pre><code>from sankhya_sdk.request_wrappers import KnowServicesRequestWrapper\n\nwith KnowServicesRequestWrapper():\n    # Sess\u00e3o gerenciada automaticamente\n    sessions = KnowServicesRequestWrapper.get_sessions()\n\n    # Criar nota fiscal\n    nunota = KnowServicesRequestWrapper.create_invoice(header, items)\n# Recursos liberados automaticamente\n</code></pre>"},{"location":"know_services/#com-contexto-existente","title":"Com Contexto Existente","text":"Python<pre><code>from sankhya_sdk.core.context import SankhyaContext\nfrom sankhya_sdk.request_wrappers import KnowServicesRequestWrapper\n\n# Usar contexto j\u00e1 existente\nctx = SankhyaContext.from_settings()\nKnowServicesRequestWrapper.initialize(ctx)\n\ntry:\n    # Opera\u00e7\u00f5es...\n    pass\nfinally:\n    KnowServicesRequestWrapper.dispose()\n</code></pre>"},{"location":"know_services/#categorias-de-metodos","title":"Categorias de M\u00e9todos","text":""},{"location":"know_services/#gerenciamento-de-sessoes","title":"Gerenciamento de Sess\u00f5es","text":"M\u00e9todo Descri\u00e7\u00e3o <code>get_sessions()</code> Retorna lista de todas as sess\u00f5es ativas <code>kill_session(session_id)</code> Finaliza uma sess\u00e3o espec\u00edfica Python<pre><code># Obter todas as sess\u00f5es\nsessions = KnowServicesRequestWrapper.get_sessions()\nfor session in sessions:\n    print(f\"Usu\u00e1rio: {session.user_name}\")\n\n# Finalizar uma sess\u00e3o\nKnowServicesRequestWrapper.kill_session(\"ABC123XYZ\")\n</code></pre>"},{"location":"know_services/#mensagens-e-avisos","title":"Mensagens e Avisos","text":"M\u00e9todo Descri\u00e7\u00e3o <code>send_warning(title, description, ...)</code> Envia um aviso do sistema <code>send_message(content, recipients)</code> Envia uma mensagem <code>receive_messages()</code> Recebe novas mensagens Python<pre><code>from sankhya_sdk.enums import SankhyaWarningLevel\n\n# Enviar aviso\nKnowServicesRequestWrapper.send_warning(\n    title=\"Manuten\u00e7\u00e3o Agendada\",\n    description=\"Sistema ficar\u00e1 offline das 22h \u00e0s 23h\",\n    level=SankhyaWarningLevel.WARNING\n)\n\n# Enviar mensagem\nKnowServicesRequestWrapper.send_message(\n    content=\"Backup conclu\u00eddo com sucesso!\"\n)\n\n# Receber mensagens\nmessages = KnowServicesRequestWrapper.receive_messages()\n</code></pre>"},{"location":"know_services/#operacoes-de-nota-fiscal-crud","title":"Opera\u00e7\u00f5es de Nota Fiscal (CRUD)","text":"M\u00e9todo Descri\u00e7\u00e3o Retorno <code>create_invoice(header, items)</code> Cria nova nota <code>int</code> (NUNOTA) <code>remove_invoice(single_number)</code> Remove nota <code>None</code> <code>add_invoice_items(single_number, items)</code> Adiciona itens <code>int</code> (sequ\u00eancia) <code>remove_invoice_items(items)</code> Remove itens <code>None</code> Python<pre><code>from sankhya_sdk.models.service.invoice_types import Invoice, InvoiceItem\n\n# Criar nota fiscal\nheader = Invoice(partner_code=123, top_code=1)\nitems = [\n    InvoiceItem(product_code=\"PROD001\", quantity=10, unit_price=100.0),\n    InvoiceItem(product_code=\"PROD002\", quantity=5, unit_price=50.0),\n]\nnunota = KnowServicesRequestWrapper.create_invoice(header, items)\nprint(f\"Nota criada: NUNOTA={nunota}\")\n\n# Adicionar itens\nnew_items = [InvoiceItem(product_code=\"PROD003\", quantity=2)]\nseq = KnowServicesRequestWrapper.add_invoice_items(nunota, new_items)\n\n# Remover nota\nKnowServicesRequestWrapper.remove_invoice(nunota)\n</code></pre>"},{"location":"know_services/#operacoes-de-faturamento","title":"Opera\u00e7\u00f5es de Faturamento","text":"M\u00e9todo Descri\u00e7\u00e3o Retorno <code>bill(...)</code> Fatura uma nota <code>Tuple[int, List[ClientEvent]]</code> <code>confirm_invoice(single_number)</code> Confirma nota <code>None</code> <code>duplicate_invoice(...)</code> Duplica nota <code>int</code> (novo NUNOTA) Python<pre><code>from sankhya_sdk.enums import BillingType\n\n# Faturar nota\nnunota_faturado, eventos = KnowServicesRequestWrapper.bill(\n    single_number=12345,\n    code_operation_type=1,\n    billing_type=BillingType.NORMAL,\n)\n\n# Confirmar nota\nKnowServicesRequestWrapper.confirm_invoice(12345)\n\n# Duplicar nota\nnovo_nunota = KnowServicesRequestWrapper.duplicate_invoice(\n    single_number=12345,\n    code_operation_type=2,\n    should_update_price=True,\n)\n</code></pre>"},{"location":"know_services/#operacoes-de-status-de-nota","title":"Opera\u00e7\u00f5es de Status de Nota","text":"M\u00e9todo Descri\u00e7\u00e3o <code>flag_invoices_as_not_pending(single_numbers)</code> Marca como n\u00e3o pendente <code>get_invoice_accompaniments(single_numbers)</code> Obt\u00e9m acompanhamentos <code>cancel_invoices(single_numbers, justification)</code> Cancela notas <code>bind_invoice_with_order(...)</code> Vincula a pedido Python<pre><code># Marcar como n\u00e3o pendente\nKnowServicesRequestWrapper.flag_invoices_as_not_pending([123, 456, 789])\n\n# Obter acompanhamentos\ninvoices = KnowServicesRequestWrapper.get_invoice_accompaniments([123])\n\n# Cancelar notas\ntotal, nao_canceladas = KnowServicesRequestWrapper.cancel_invoices(\n    single_numbers=[123, 456],\n    justification=\"Erro de digita\u00e7\u00e3o\"\n)\n</code></pre>"},{"location":"know_services/#operacoes-nfe","title":"Opera\u00e7\u00f5es NFe","text":"M\u00e9todo Descri\u00e7\u00e3o <code>get_fiscal_invoice_authorization(single_numbers)</code> Busca autoriza\u00e7\u00e3o NF-e <code>generate_lot(single_numbers)</code> Gera lote NF-e Python<pre><code># Buscar autoriza\u00e7\u00e3o\nKnowServicesRequestWrapper.get_fiscal_invoice_authorization([123, 456])\n\n# Gerar lote\nKnowServicesRequestWrapper.generate_lot([123, 456])\n</code></pre>"},{"location":"know_services/#operacoes-financeiras","title":"Opera\u00e7\u00f5es Financeiras","text":"M\u00e9todo Descri\u00e7\u00e3o <code>flag_as_payments_paid(financial_numbers, code_account)</code> Marca como pago <code>reverse_payments(financial_numbers)</code> Estorna pagamentos <code>unlink_shipping(financial_number)</code> Desvincula remessa Python<pre><code># Marcar como pago\nKnowServicesRequestWrapper.flag_as_payments_paid(\n    financial_numbers=[1001, 1002],\n    code_account=123\n)\n\n# Estornar pagamentos\nKnowServicesRequestWrapper.reverse_payments([1001, 1002])\n\n# Desvincular remessa\nKnowServicesRequestWrapper.unlink_shipping(1001)\n</code></pre>"},{"location":"know_services/#operacoes-de-arquivo","title":"Opera\u00e7\u00f5es de Arquivo","text":"M\u00e9todo Descri\u00e7\u00e3o Retorno <code>open_file(path)</code> Abre arquivo <code>str</code> (chave) <code>delete_files(paths)</code> Deleta arquivos <code>None</code> <code>get_file(key)</code> Baixa arquivo <code>ServiceFile</code> <code>get_file_async(key)</code> Baixa arquivo (async) <code>ServiceFile</code> Python<pre><code># Abrir arquivo\nkey = KnowServicesRequestWrapper.open_file(\"/caminho/arquivo.pdf\")\n\n# Baixar arquivo\nfile = KnowServicesRequestWrapper.get_file(key)\nwith open(\"local.pdf\", \"wb\") as f:\n    f.write(file.data)\n\n# Deletar arquivos\nKnowServicesRequestWrapper.delete_files([\"/caminho/arquivo1.pdf\"])\n</code></pre>"},{"location":"know_services/#operacoes-de-imagem","title":"Opera\u00e7\u00f5es de Imagem","text":"M\u00e9todo Descri\u00e7\u00e3o Retorno <code>get_image(entity)</code> Obt\u00e9m imagem da entidade <code>ServiceFile</code> <code>get_image_async(entity)</code> Obt\u00e9m imagem (async) <code>ServiceFile</code> Python<pre><code>from sankhya_sdk.models.transport import Product\n\n# Obter imagem do produto\nproduct = Product(code=123)\nimage = KnowServicesRequestWrapper.get_image(product)\n\nwith open(\"produto.jpg\", \"wb\") as f:\n    f.write(image.data)\n</code></pre>"},{"location":"know_services/#tratamento-de-excecoes","title":"Tratamento de Exce\u00e7\u00f5es","text":"<p>O wrapper lan\u00e7a exce\u00e7\u00f5es espec\u00edficas para diferentes tipos de erro:</p> Exce\u00e7\u00e3o Cen\u00e1rio <code>RuntimeError</code> Wrapper n\u00e3o inicializado <code>ValueError</code> Par\u00e2metros inv\u00e1lidos <code>NoItemsConfirmInvoiceException</code> Confirmar nota sem itens <code>ConfirmInvoiceException</code> Erro na confirma\u00e7\u00e3o <code>MarkAsPaymentPaidException</code> Erro na baixa de t\u00edtulo <code>UnlinkShippingException</code> Erro ao desvincular remessa Python<pre><code>from sankhya_sdk.exceptions import (\n    NoItemsConfirmInvoiceException,\n    ConfirmInvoiceException,\n)\n\ntry:\n    KnowServicesRequestWrapper.confirm_invoice(12345)\nexcept NoItemsConfirmInvoiceException:\n    print(\"Nota n\u00e3o possui itens para confirma\u00e7\u00e3o\")\nexcept ConfirmInvoiceException as e:\n    print(f\"Erro ao confirmar: {e}\")\n</code></pre>"},{"location":"know_services/#comparacao-com-sdk-net","title":"Compara\u00e7\u00e3o com SDK .NET","text":"C# (.NET) Python <code>KnowServicesRequestWrapper.GetSessions()</code> <code>KnowServicesRequestWrapper.get_sessions()</code> <code>KnowServicesRequestWrapper.KillSession(id)</code> <code>KnowServicesRequestWrapper.kill_session(id)</code> <code>KnowServicesRequestWrapper.SendWarning(...)</code> <code>KnowServicesRequestWrapper.send_warning(...)</code> <code>KnowServicesRequestWrapper.CreateInvoice(...)</code> <code>KnowServicesRequestWrapper.create_invoice(...)</code> <code>KnowServicesRequestWrapper.Bill(...)</code> <code>KnowServicesRequestWrapper.bill(...)</code> <code>KnowServicesRequestWrapper.ConfirmInvoice(n)</code> <code>KnowServicesRequestWrapper.confirm_invoice(n)</code> <code>KnowServicesRequestWrapper.GetFile(key)</code> <code>KnowServicesRequestWrapper.get_file(key)</code>"},{"location":"know_services/#diagrama-de-fluxo","title":"Diagrama de Fluxo","text":"<pre><code>graph TD\n    A[Inicializa\u00e7\u00e3o] --&gt; B{Contexto fornecido?}\n    B --&gt;|Sim| C[Usar contexto existente]\n    B --&gt;|N\u00e3o| D[Criar novo contexto]\n    C --&gt; E[Registrar sess\u00e3o KNOW_SERVICES]\n    D --&gt; E\n    E --&gt; F[Wrapper Pronto]\n\n    F --&gt; G[Opera\u00e7\u00f5es de Sess\u00e3o]\n    F --&gt; H[Opera\u00e7\u00f5es de Mensagem]\n    F --&gt; I[Opera\u00e7\u00f5es de Nota]\n    F --&gt; J[Opera\u00e7\u00f5es Financeiras]\n    F --&gt; K[Opera\u00e7\u00f5es de Arquivo]\n\n    G --&gt; L{Sucesso?}\n    H --&gt; L\n    I --&gt; L\n    J --&gt; L\n    K --&gt; L\n\n    L --&gt;|Sim| M[Retornar resultado]\n    L --&gt;|N\u00e3o| N[Lan\u00e7ar exce\u00e7\u00e3o espec\u00edfica]\n\n    M --&gt; O[Dispose]\n    N --&gt; O\n    O --&gt; P[Finalizar sess\u00e3o]\n    P --&gt; Q[Limpar recursos]</code></pre>"},{"location":"know_services/#notas-de-implementacao","title":"Notas de Implementa\u00e7\u00e3o","text":"<ol> <li> <p>Thread Safety: A classe usa atributos de classe est\u00e1ticos, ent\u00e3o n\u00e3o \u00e9 thread-safe. Para uso em m\u00faltiplas threads, considere usar inst\u00e2ncias separadas ou locks.</p> </li> <li> <p>Timestamps: O m\u00e9todo <code>receive_messages()</code> atualiza internamente um timestamp para rastrear a \u00faltima verifica\u00e7\u00e3o.</p> </li> <li> <p>Exce\u00e7\u00f5es Silenciadas: O m\u00e9todo <code>confirm_invoice()</code> ignora silenciosamente erros de \"nota j\u00e1 confirmada\".</p> </li> <li> <p>Opera\u00e7\u00f5es Individuais: O m\u00e9todo <code>reverse_payments()</code> faz requisi\u00e7\u00f5es individuais para cada t\u00edtulo, n\u00e3o em lote.</p> </li> </ol>"},{"location":"request_helpers/","title":"Request Helpers - Sistema de Retry","text":"<p>O m\u00f3dulo <code>request_helpers</code> fornece utilit\u00e1rios para gerenciar retentativas de requisi\u00e7\u00f5es HTTP com backoff exponencial, tratamento de exce\u00e7\u00f5es e configura\u00e7\u00e3o de comportamento de requisi\u00e7\u00f5es.</p>"},{"location":"request_helpers/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Este m\u00f3dulo implementa um sistema de retry robusto para lidar com falhas tempor\u00e1rias nas requisi\u00e7\u00f5es \u00e0 API Sankhya. O sistema \u00e9 configur\u00e1vel e segue padr\u00f5es de resili\u00eancia como:</p> <ul> <li>Backoff Exponencial: Delays progressivos entre tentativas</li> <li>Limite de Retentativas: Configura\u00e7\u00e3o m\u00e1xima de tentativas</li> <li>Tratamento de Exce\u00e7\u00f5es Espec\u00edficas: L\u00f3gica diferenciada por tipo de exce\u00e7\u00e3o</li> </ul>"},{"location":"request_helpers/#componentes","title":"Componentes","text":""},{"location":"request_helpers/#requestbehavioroptions","title":"RequestBehaviorOptions","text":"<p>Configura\u00e7\u00f5es imut\u00e1veis para o comportamento de retry.</p> Python<pre><code>from sankhya_sdk.request_helpers import RequestBehaviorOptions\n\n# Usar valores padr\u00e3o (3 tentativas)\noptions = RequestBehaviorOptions()\n\n# Personalizar n\u00famero m\u00e1ximo de retentativas\noptions = RequestBehaviorOptions(max_retry_count=5)\n</code></pre> Atributo Tipo Padr\u00e3o Descri\u00e7\u00e3o <code>max_retry_count</code> <code>int</code> <code>3</code> N\u00famero m\u00e1ximo de tentativas de retry"},{"location":"request_helpers/#requestretrydata","title":"RequestRetryData","text":"<p>Classe mut\u00e1vel para rastrear o estado atual das retentativas.</p> Python<pre><code>from sankhya_sdk.request_helpers import RequestRetryData\n\nretry_data = RequestRetryData()\nprint(retry_data.retry_count)  # 0\n\n# Incrementar ap\u00f3s cada tentativa\nretry_data.retry_count += 1\nretry_data.retry_delay = 10  # segundos at\u00e9 pr\u00f3xima tentativa\n</code></pre> Atributo Tipo Padr\u00e3o Descri\u00e7\u00e3o <code>lock_key</code> <code>str</code> <code>\"\"</code> Identificador \u00fanico para a requisi\u00e7\u00e3o <code>retry_count</code> <code>int</code> <code>0</code> N\u00famero atual de tentativas realizadas <code>retry_delay</code> <code>int</code> <code>0</code> Delay em segundos antes da pr\u00f3xima tentativa"},{"location":"request_helpers/#requestretrydelay","title":"RequestRetryDelay","text":"<p>Constantes de delay baseadas na estabilidade do sistema.</p> Python<pre><code>from sankhya_sdk.request_helpers import RequestRetryDelay\n\n# Usar delay apropriado baseado na condi\u00e7\u00e3o do sistema\ndelay = RequestRetryDelay.FREE      # 10 segundos - sistema livre\ndelay = RequestRetryDelay.STABLE    # 15 segundos - sistema est\u00e1vel\ndelay = RequestRetryDelay.UNSTABLE  # 30 segundos - sistema inst\u00e1vel\ndelay = RequestRetryDelay.BREAKDOWN # 90 segundos - sistema em crise\n</code></pre> Constante Valor (segundos) Uso Recomendado <code>FREE</code> 10 Sistema saud\u00e1vel, erros transientes ocasionais <code>STABLE</code> 15 Sistema operacional com alguma carga <code>UNSTABLE</code> 30 Sistema com problemas intermitentes ou alta carga <code>BREAKDOWN</code> 90 Sistema em recupera\u00e7\u00e3o ou problemas severos"},{"location":"request_helpers/#requestexceptiondetails","title":"RequestExceptionDetails","text":"<p>Contexto sobre uma exce\u00e7\u00e3o ocorrida durante uma requisi\u00e7\u00e3o.</p> Python<pre><code>from sankhya_sdk.request_helpers import RequestExceptionDetails\nfrom sankhya_sdk.enums import ServiceName\n\ntry:\n    # opera\u00e7\u00e3o que falha\n    raise ValueError(\"Erro de teste\")\nexcept Exception as e:\n    details = RequestExceptionDetails(\n        exception=e,\n        service_name=ServiceName.CRUD_FIND,\n        request=None,  # opcional\n    )\n    print(details.service_type)  # ServiceType.RETRIEVE\n</code></pre> Atributo/Propriedade Tipo Descri\u00e7\u00e3o <code>exception</code> <code>Exception</code> A exce\u00e7\u00e3o capturada <code>service_name</code> <code>ServiceName</code> Enum do servi\u00e7o chamado <code>request</code> <code>Optional[Any]</code> Dados da requisi\u00e7\u00e3o (opcional) <code>service_type</code> <code>ServiceType</code> Tipo do servi\u00e7o extra\u00eddo dos metadados"},{"location":"request_helpers/#requestexceptionhandler","title":"RequestExceptionHandler","text":"<p>Handler principal para decidir se uma requisi\u00e7\u00e3o deve ser retentada.</p> Python<pre><code>from sankhya_sdk.request_helpers import (\n    RequestBehaviorOptions,\n    RequestExceptionHandler,\n    RequestExceptionDetails,\n    RequestRetryData,\n)\nfrom sankhya_sdk.enums import ServiceName\n\n# Configurar handler\noptions = RequestBehaviorOptions(max_retry_count=3)\nhandler = RequestExceptionHandler(options)\n\n# Ao capturar uma exce\u00e7\u00e3o\ndetails = RequestExceptionDetails(\n    exception=some_exception,\n    service_name=ServiceName.CRUD_FIND,\n)\nretry_data = RequestRetryData()\n\n# Decidir se deve retentar\nshould_retry = handler.handle(details, retry_data)\n</code></pre>"},{"location":"request_helpers/#interface-irequestexceptionhandler","title":"Interface IRequestExceptionHandler","text":"<p>O handler implementa o protocolo <code>IRequestExceptionHandler</code>:</p> Python<pre><code>from typing import Protocol, runtime_checkable\n\n@runtime_checkable\nclass IRequestExceptionHandler(Protocol):\n    def handle(\n        self,\n        details: RequestExceptionDetails,\n        retry_data: RequestRetryData,\n    ) -&gt; bool:\n        \"\"\"Retorna True se deve retentar, False caso contr\u00e1rio.\"\"\"\n        ...\n</code></pre>"},{"location":"request_helpers/#diagrama-de-fluxo","title":"Diagrama de Fluxo","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant Handler as RequestExceptionHandler\n    participant Details as RequestExceptionDetails\n    participant RetryData as RequestRetryData\n    participant Options as RequestBehaviorOptions\n\n    Client-&gt;&gt;Handler: handle(details, retry_data)\n    Handler-&gt;&gt;RetryData: verificar retry_count\n    alt retry_count &gt; max_retry_count\n        Handler--&gt;&gt;Client: return False (parar retry)\n    else\n        Handler-&gt;&gt;Details: verificar service_type\n        alt \u00e9 TRANSACTIONAL + exce\u00e7\u00e3o espec\u00edfica\n            Handler--&gt;&gt;Client: return False (parar retry)\n        else\n            Handler-&gt;&gt;Handler: _handle_internal()\n            Note over Handler: NotImplementedError&lt;br/&gt;(futuro: backoff exponencial)\n            Handler--&gt;&gt;Client: return True (continuar retry)\n        end\n    end</code></pre>"},{"location":"request_helpers/#regras-de-retry","title":"Regras de Retry","text":""},{"location":"request_helpers/#condicoes-para-nao-retentar","title":"Condi\u00e7\u00f5es para N\u00c3O Retentar","text":"<ol> <li>Limite Excedido: Quando <code>retry_count &gt; max_retry_count</code></li> <li>Servi\u00e7o Transacional: Quando <code>service_type == TRANSACTIONAL</code> E exce\u00e7\u00e3o \u00e9:</li> <li><code>ServiceRequestCompetitionException</code></li> <li><code>ServiceRequestDeadlockException</code></li> <li><code>ServiceRequestTimeoutException</code></li> </ol>"},{"location":"request_helpers/#excecoes-relacionadas","title":"Exce\u00e7\u00f5es Relacionadas","text":"<p>O m\u00f3dulo trabalha em conjunto com as seguintes exce\u00e7\u00f5es de <code>sankhya_sdk.exceptions</code>:</p> <ul> <li><code>ServiceRequestCompetitionException</code>: Erro de competi\u00e7\u00e3o/concorr\u00eancia</li> <li><code>ServiceRequestDeadlockException</code>: Deadlock em transa\u00e7\u00e3o</li> <li><code>ServiceRequestTimeoutException</code>: Timeout na requisi\u00e7\u00e3o</li> </ul>"},{"location":"request_helpers/#exemplo-completo","title":"Exemplo Completo","text":"Python<pre><code>from sankhya_sdk.request_helpers import (\n    RequestBehaviorOptions,\n    RequestExceptionHandler,\n    RequestExceptionDetails,\n    RequestRetryData,\n    RequestRetryDelay,\n)\nfrom sankhya_sdk.enums import ServiceName\nimport time\n\n# Configura\u00e7\u00e3o\noptions = RequestBehaviorOptions(max_retry_count=3)\nhandler = RequestExceptionHandler(options)\n\ndef make_request_with_retry():\n    retry_data = RequestRetryData()\n\n    while True:\n        try:\n            # Fazer requisi\u00e7\u00e3o\n            result = perform_request()\n            return result\n        except Exception as e:\n            details = RequestExceptionDetails(\n                exception=e,\n                service_name=ServiceName.CRUD_SAVE,\n            )\n\n            # Decidir se deve retentar\n            # (NotImplementedError ser\u00e1 lan\u00e7ado at\u00e9 implementa\u00e7\u00e3o futura)\n            try:\n                should_retry = handler.handle(details, retry_data)\n            except NotImplementedError:\n                # L\u00f3gica de retry ainda n\u00e3o implementada\n                should_retry = retry_data.retry_count &lt; options.max_retry_count\n\n            if not should_retry:\n                raise\n\n            # Aplicar delay antes de retentar\n            time.sleep(RequestRetryDelay.STABLE)\n            retry_data.retry_count += 1\n</code></pre>"},{"location":"request_helpers/#status-de-implementacao","title":"Status de Implementa\u00e7\u00e3o","text":"Componente Status <code>RequestBehaviorOptions</code> \u2705 Completo <code>RequestRetryData</code> \u2705 Completo <code>RequestRetryDelay</code> \u2705 Completo <code>RequestExceptionDetails</code> \u2705 Completo <code>IRequestExceptionHandler</code> \u2705 Completo <code>RequestExceptionHandler</code> \u26a0\ufe0f Parcial (backoff pendente) <p>[!NOTE] O m\u00e9todo <code>_handle_internal</code> do <code>RequestExceptionHandler</code> ainda n\u00e3o est\u00e1 implementado.  A l\u00f3gica de backoff exponencial ser\u00e1 adicionada em fases futuras.</p>"},{"location":"request_wrappers/","title":"Request Wrappers","text":"<p>Este m\u00f3dulo fornece wrappers de alto n\u00edvel para opera\u00e7\u00f5es de servi\u00e7o no Sankhya.</p>"},{"location":"request_wrappers/#simplecrudrequestwrapper","title":"SimpleCRUDRequestWrapper","text":"<p>Wrapper para opera\u00e7\u00f5es CRUD simples (Find, Update, Remove) em entidades do Sankhya.</p> Python<pre><code>from sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\n\n# Inicializa\u00e7\u00e3o\nSimpleCRUDRequestWrapper.initialize()\n\n# Buscar entidade\npartner = Partner(code=123)\nresult = SimpleCRUDRequestWrapper.try_find(partner)\n\n# Atualizar entidade\nresult.name = \"Novo Nome\"\nSimpleCRUDRequestWrapper.update(result)\n\n# Remover entidade\nSimpleCRUDRequestWrapper.remove(partner)\n\n# Liberar recursos\nSimpleCRUDRequestWrapper.dispose()\n</code></pre>"},{"location":"request_wrappers/#pagedrequestwrapper","title":"PagedRequestWrapper","text":"<p>Wrapper para requisi\u00e7\u00f5es paginadas de grandes conjuntos de dados.</p>"},{"location":"request_wrappers/#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Carregamento paralelo: P\u00e1ginas s\u00e3o carregadas em thread/task separada</li> <li>Generator/Async Generator: Retorna resultados incrementalmente via yield</li> <li>Callbacks de progresso: Notifica sobre carregamento de p\u00e1ginas</li> <li>Processamento on-demand: Callback para processar lotes de dados</li> <li>Timeout configur\u00e1vel: Evita opera\u00e7\u00f5es penduradas</li> <li>Max results: Limita quantidade de resultados retornados</li> </ul>"},{"location":"request_wrappers/#uso-basico-sincrono","title":"Uso B\u00e1sico (S\u00edncrono)","text":"Python<pre><code>from datetime import timedelta\nfrom sankhya_sdk.enums.service_name import ServiceName\nfrom sankhya_sdk.models.service.service_request import ServiceRequest\nfrom sankhya_sdk.request_wrappers import PagedRequestWrapper, SimpleCRUDRequestWrapper\nfrom your_entities import Partner\n\n# Inicializa wrapper\nSimpleCRUDRequestWrapper.initialize()\ntoken = SimpleCRUDRequestWrapper._session_token\n\n# Configura requisi\u00e7\u00e3o\nrequest = ServiceRequest(service=ServiceName.CRUD_SERVICE_FIND)\n# ... configurar request_body conforme necess\u00e1rio\n\n# Itera sobre resultados\nfor partner in PagedRequestWrapper.get_paged_results(\n    request=request,\n    entity_type=Partner,\n    token=token,\n    timeout=timedelta(minutes=5),\n    max_results=1000,\n):\n    print(f\"Parceiro: {partner.name}\")\n\n# Libera recursos\nSimpleCRUDRequestWrapper.dispose()\n</code></pre>"},{"location":"request_wrappers/#uso-com-callbacks","title":"Uso com Callbacks","text":"Python<pre><code>from sankhya_sdk.value_objects import PagedRequestEventArgs\n\ndef on_page_loaded(args: PagedRequestEventArgs):\n    print(f\"P\u00e1gina {args.current_page}: {args.quantity_loaded} itens\")\n    if args.total_pages:\n        progress = args.progress_percentage\n        print(f\"Progresso: {progress:.1f}%\")\n\ndef on_error(args: PagedRequestEventArgs):\n    print(f\"Erro na p\u00e1gina {args.current_page}: {args.exception}\")\n\nfor partner in PagedRequestWrapper.get_paged_results(\n    request=request,\n    entity_type=Partner,\n    token=token,\n    on_page_loaded=on_page_loaded,\n    on_page_error=on_error,\n):\n    process(partner)\n</code></pre>"},{"location":"request_wrappers/#processamento-on-demand","title":"Processamento On-Demand","text":"Python<pre><code>def enrich_partners(batch: List[Partner]):\n    \"\"\"Enriquece lotes de parceiros com dados adicionais.\"\"\"\n    for partner in batch:\n        # Buscar informa\u00e7\u00f5es complementares\n        partner.extra_info = fetch_extra_info(partner.code)\n\nfor partner in PagedRequestWrapper.get_paged_results(\n    request=request,\n    entity_type=Partner,\n    token=token,\n    process_data=enrich_partners,\n):\n    # Parceiro j\u00e1 enriquecido\n    save_to_database(partner)\n</code></pre>"},{"location":"request_wrappers/#uso-assincrono","title":"Uso Ass\u00edncrono","text":"Python<pre><code>import asyncio\n\nasync def process_partners():\n    async for partner in PagedRequestWrapper.get_paged_results_async(\n        request=request,\n        entity_type=Partner,\n        token=token,\n        timeout=timedelta(minutes=10),\n    ):\n        await process_async(partner)\n\nasyncio.run(process_partners())\n</code></pre>"},{"location":"request_wrappers/#processamento-assincrono-on-demand","title":"Processamento Ass\u00edncrono On-Demand","text":"Python<pre><code>async def enrich_partners_async(batch: List[Partner]):\n    \"\"\"Enriquece lotes de forma ass\u00edncrona.\"\"\"\n    tasks = [fetch_extra_info_async(p.code) for p in batch]\n    results = await asyncio.gather(*tasks)\n    for partner, info in zip(batch, results):\n        partner.extra_info = info\n\nasync for partner in PagedRequestWrapper.get_paged_results_async(\n    request=request,\n    entity_type=Partner,\n    token=token,\n    process_data=enrich_partners_async,\n):\n    await save_to_database_async(partner)\n</code></pre>"},{"location":"request_wrappers/#pagedrequesteventargs","title":"PagedRequestEventArgs","text":"<p>Argumentos de evento para opera\u00e7\u00f5es paginadas.</p>"},{"location":"request_wrappers/#atributos","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>entity_type</code> <code>Type[EntityBase]</code> Tipo da entidade sendo carregada <code>current_page</code> <code>int</code> N\u00famero da p\u00e1gina atual (1-indexed) <code>total_loaded</code> <code>int</code> Total de itens carregados at\u00e9 o momento <code>quantity_loaded</code> <code>Optional[int]</code> Quantidade de itens na p\u00e1gina atual <code>total_pages</code> <code>Optional[int]</code> Total de p\u00e1ginas (se dispon\u00edvel) <code>exception</code> <code>Optional[Exception]</code> Exce\u00e7\u00e3o ocorrida (se houver)"},{"location":"request_wrappers/#propriedades","title":"Propriedades","text":"Propriedade Tipo Descri\u00e7\u00e3o <code>has_error</code> <code>bool</code> Verifica se h\u00e1 erro associado <code>is_complete</code> <code>bool</code> Verifica se carregamento est\u00e1 completo <code>progress_percentage</code> <code>Optional[float]</code> Percentual de progresso (0-100)"},{"location":"request_wrappers/#pagedrequestexception","title":"PagedRequestException","text":"<p>Exce\u00e7\u00e3o espec\u00edfica para erros de requisi\u00e7\u00e3o paginada.</p> Python<pre><code>from sankhya_sdk.request_wrappers import PagedRequestException\n\ntry:\n    for item in PagedRequestWrapper.get_paged_results(...):\n        process(item)\nexcept PagedRequestException as e:\n    print(f\"Erro na p\u00e1gina {e.page}: {e}\")\n    if e.inner_exception:\n        print(f\"Causa: {e.inner_exception}\")\n</code></pre>"},{"location":"request_wrappers/#comparacao-simplecrudrequestwrapper-vs-pagedrequestwrapper","title":"Compara\u00e7\u00e3o: SimpleCRUDRequestWrapper vs PagedRequestWrapper","text":"Caracter\u00edstica SimpleCRUD PagedRequest Uso Opera\u00e7\u00f5es simples Grandes conjuntos de dados Resultados Lista completa Generator (lazy) Mem\u00f3ria Carrega tudo Streaming Timeout N/A Configur\u00e1vel Callbacks N/A Progresso, erro Async Sim Sim Max Results Via options Par\u00e2metro direto"},{"location":"request_wrappers/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"request_wrappers/#timeout","title":"Timeout","text":"<p>Configure timeout adequado para o volume esperado de dados:</p> Python<pre><code># Para datasets pequenos (&lt;1000 registros)\ntimeout = timedelta(minutes=2)\n\n# Para datasets grandes (&gt;10000 registros)\ntimeout = timedelta(minutes=15)\n</code></pre>"},{"location":"request_wrappers/#max-results","title":"Max Results","text":"<p>Use <code>max_results</code> para limitar consumo de mem\u00f3ria e tempo:</p> Python<pre><code># Limita a 1000 resultados\nfor item in PagedRequestWrapper.get_paged_results(\n    ...,\n    max_results=1000,\n):\n    process(item)\n</code></pre>"},{"location":"request_wrappers/#tratamento-de-erros","title":"Tratamento de Erros","text":"<p>Sempre trate exce\u00e7\u00f5es e use callbacks de erro:</p> Python<pre><code>def on_error(args):\n    logger.error(f\"P\u00e1gina {args.current_page} falhou: {args.exception}\")\n    # Notificar monitoramento, etc.\n\ntry:\n    for item in PagedRequestWrapper.get_paged_results(\n        ...,\n        on_page_error=on_error,\n    ):\n        process(item)\nexcept PagedRequestException as e:\n    handle_fatal_error(e)\n</code></pre>"},{"location":"request_wrappers/#processamento-em-lotes","title":"Processamento em Lotes","text":"<p>Use <code>process_data</code> para opera\u00e7\u00f5es que se beneficiam de batching:</p> Python<pre><code>def batch_insert(items: List[Partner]):\n    \"\"\"Insert otimizado em lote.\"\"\"\n    db.execute_many(\n        \"INSERT INTO partners ...\",\n        [(p.code, p.name) for p in items]\n    )\n\nfor item in PagedRequestWrapper.get_paged_results(\n    ...,\n    process_data=batch_insert,\n):\n    pass  # Itens j\u00e1 foram inseridos no callback\n</code></pre>"},{"location":"service_models/","title":"Service Models - Sankhya SDK Python","text":"<p>Documenta\u00e7\u00e3o dos modelos de servi\u00e7o para comunica\u00e7\u00e3o com a API Sankhya.</p>"},{"location":"service_models/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Este m\u00f3dulo implementa a camada de serializa\u00e7\u00e3o XML para comunica\u00e7\u00e3o com os web services Sankhya, migrada do SDK .NET original.</p>"},{"location":"service_models/#arquitetura","title":"Arquitetura","text":"<pre><code>classDiagram\n    class EntityBase {\n        +_fields_set: Set[str]\n        +should_serialize_field(field_name) bool\n        +get_modified_fields() Dict\n    }\n\n    class ServiceRequest {\n        +service: ServiceName\n        +request_body: RequestBody\n        +to_xml() Element\n    }\n\n    class ServiceResponse {\n        +service: ServiceName\n        +status: ServiceResponseStatus\n        +response_body: ResponseBody\n        +from_xml_string(xml) ServiceResponse\n        +entities: List\n    }\n\n    EntityBase &lt;|-- ServiceRequest\n    EntityBase &lt;|-- ServiceResponse\n    ServiceRequest --&gt; RequestBody\n    ServiceResponse --&gt; ResponseBody</code></pre>"},{"location":"service_models/#classes-principais","title":"Classes Principais","text":""},{"location":"service_models/#servicerequest","title":"ServiceRequest","text":"<p>Encapsula uma requisi\u00e7\u00e3o para a API:</p> Python<pre><code>from sankhya_sdk.models.service import ServiceRequest, Entity, Field\nfrom sankhya_sdk.enums import ServiceName\n\nrequest = ServiceRequest(service=ServiceName.CRUD_FIND)\nrequest.request_body.entity = Entity(\n    name=\"Parceiro\",\n    fields=[Field(name=\"CODPARC\"), Field(name=\"NOMEPARC\")]\n)\n\nxml = request.to_xml_string()\n</code></pre>"},{"location":"service_models/#serviceresponse","title":"ServiceResponse","text":"<p>Processa respostas da API:</p> Python<pre><code>from sankhya_sdk.models.service import ServiceResponse\n\nresponse = ServiceResponse.from_xml_string(xml_response)\n\nif response.is_success:\n    for entity in response.entities:\n        print(entity.get(\"CODPARC\"))\nelse:\n    print(f\"Erro: {response.status_message_text}\")\n</code></pre>"},{"location":"service_models/#mapeamento-net-python","title":"Mapeamento .NET \u2192 Python","text":"Classe .NET Classe Python M\u00f3dulo ServiceRequest ServiceRequest service_request.py ServiceResponse ServiceResponse service_response.py RequestBody RequestBody request_body.py ResponseBody ResponseBody response_body.py Entity Entity entity_types.py DataSet DataSet entity_types.py Field Field basic_types.py Criteria Criteria basic_types.py Parameter Parameter basic_types.py LiteralCriteria LiteralCriteria basic_types.py StatusMessage StatusMessage metadata_types.py"},{"location":"service_models/#serializacao-xml","title":"Serializa\u00e7\u00e3o XML","text":"<p>A serializa\u00e7\u00e3o usa <code>lxml.etree</code> para m\u00e1ximo controle:</p> Python<pre><code>from lxml import etree\nfrom sankhya_sdk.models.service import create_xml_element, serialize_bool\n\n# Criar elemento\nelem = create_xml_element(\"field\", \"valor\", {\"name\": \"CODPROD\"})\n\n# Serializar bool\nelem.set(\"active\", serialize_bool(True))  # \"true\"\n</code></pre>"},{"location":"service_models/#exemplo-completo","title":"Exemplo Completo","text":"Python<pre><code>from sankhya_sdk.models.service import (\n    ServiceRequest,\n    ServiceResponse,\n    Entity,\n    Field,\n    LiteralCriteria,\n    Parameter,\n)\nfrom sankhya_sdk.enums import ServiceName, ParameterType\n\n# Criar requisi\u00e7\u00e3o\nrequest = ServiceRequest(service=ServiceName.CRUD_FIND)\nrequest.request_body.entity = Entity(\n    name=\"Produto\",\n    fields=[\n        Field(name=\"CODPROD\"),\n        Field(name=\"DESCRPROD\"),\n        Field(name=\"VLRVENDA\"),\n    ],\n    literal_criteria=LiteralCriteria(\n        expression=\"ATIVO = ?\",\n        parameters=[Parameter(type=ParameterType.TEXT, value=\"S\")]\n    )\n)\n\n# Obter XML\nxml = request.to_xml_bytes()\n\n# Processar resposta (ap\u00f3s chamada HTTP)\nresponse = ServiceResponse.from_xml_bytes(response_bytes)\n\nif response.is_success:\n    for produto in response.entities:\n        print(f\"{produto['CODPROD']}: {produto['DESCRPROD']}\")\nelse:\n    response.raise_for_status()  # Levanta exce\u00e7\u00e3o\n</code></pre>"},{"location":"transport_entities/","title":"Entidades de Transporte","text":"<p>Este documento descreve as entidades de transporte simples do SDK Sankhya Python, migradas do SDK .NET.</p>"},{"location":"transport_entities/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>As entidades de transporte representam objetos de dom\u00ednio do sistema Sankhya. Cada entidade:</p> <ul> <li>Herda de <code>TransportEntityBase</code> para serializa\u00e7\u00e3o XML gen\u00e9rica</li> <li>Utiliza decoradores para mapear propriedades Python para elementos XML</li> <li>Implementa rastreamento de campos modificados via <code>_fields_set</code></li> <li>Suporta compara\u00e7\u00e3o case-insensitive para strings</li> <li>Implementa <code>__eq__</code> e <code>__hash__</code> compat\u00edveis com o SDK .NET</li> </ul>"},{"location":"transport_entities/#entidades-disponiveis","title":"Entidades Dispon\u00edveis","text":""},{"location":"transport_entities/#address-endereco","title":"Address (Endere\u00e7o)","text":"<p>Representa um endere\u00e7o no sistema Sankhya.</p> Python<pre><code>from sankhya_sdk.models.transport import Address\n\n# Cria\u00e7\u00e3o\naddress = Address(\n    code=1,\n    type=\"Residencial\",\n    name=\"Rua Principal\",\n    description_correios=\"Descri\u00e7\u00e3o do Correio\"\n)\n\n# Serializa\u00e7\u00e3o XML\nxml_string = address.to_xml_string()\n# &lt;Endereco&gt;\n#   &lt;CODEND&gt;1&lt;/CODEND&gt;\n#   &lt;TIPO&gt;Residencial&lt;/TIPO&gt;\n#   &lt;NOMEEND&gt;Rua Principal&lt;/NOMEEND&gt;\n#   &lt;DESCRICAOCORREIO&gt;Descri\u00e7\u00e3o do Correio&lt;/DESCRICAOCORREIO&gt;\n# &lt;/Endereco&gt;\n\n# Deserializa\u00e7\u00e3o\nrestored = Address.from_xml_string(xml_string)\n</code></pre>"},{"location":"transport_entities/#state-unidade-federativa","title":"State (Unidade Federativa)","text":"<p>Representa um estado/UF no sistema Sankhya.</p> Python<pre><code>from sankhya_sdk.models.transport import State\n\n# Cria\u00e7\u00e3o\nstate = State(\n    code=35,\n    initials=\"SP\",\n    name=\"S\u00e3o Paulo\",\n    code_country=1058,\n    code_ibge=35\n)\n\n# Serializa\u00e7\u00e3o XML\nxml_string = state.to_xml_string()\n# &lt;UnidadeFederativa&gt;\n#   &lt;CODUF&gt;35&lt;/CODUF&gt;\n#   &lt;UF&gt;SP&lt;/UF&gt;\n#   &lt;DESCRICAO&gt;S\u00e3o Paulo&lt;/DESCRICAO&gt;\n#   &lt;CODPAIS&gt;1058&lt;/CODPAIS&gt;\n#   &lt;CODIBGE&gt;35&lt;/CODIBGE&gt;\n# &lt;/UnidadeFederativa&gt;\n</code></pre>"},{"location":"transport_entities/#region-regiao","title":"Region (Regi\u00e3o)","text":"<p>Representa uma regi\u00e3o no sistema Sankhya. Inclui campo booleano com serializa\u00e7\u00e3o \"S\"/\"N\".</p> Python<pre><code>from sankhya_sdk.models.transport import Region\n\n# Cria\u00e7\u00e3o com campo active\nregion = Region(\n    code=1,\n    name=\"Sudeste\",\n    code_price_table=10\n)\nregion.active = True  # Define active_internal como \"S\"\n\n# Verifica\u00e7\u00e3o\nprint(region.active)  # True\nprint(region.active_internal)  # \"S\"\n\n# Serializa\u00e7\u00e3o XML\nxml_string = region.to_xml_string()\n# &lt;Regiao&gt;\n#   &lt;CODREG&gt;1&lt;/CODREG&gt;\n#   &lt;CODTAB&gt;10&lt;/CODTAB&gt;\n#   &lt;ATIVA&gt;S&lt;/ATIVA&gt;\n#   &lt;NOMEREG&gt;Sudeste&lt;/NOMEREG&gt;\n# &lt;/Regiao&gt;\n</code></pre>"},{"location":"transport_entities/#city-cidade","title":"City (Cidade)","text":"<p>Representa uma cidade no sistema Sankhya. Inclui relacionamentos com State e Region.</p> Python<pre><code>from sankhya_sdk.models.transport import City, State, Region\n\n# Cria\u00e7\u00e3o com relacionamentos\nstate = State(code=35, initials=\"SP\", name=\"S\u00e3o Paulo\")\nregion = Region(code=1, name=\"Sudeste\")\n\ncity = City(\n    code=3550308,\n    code_state=35,\n    code_region=1,\n    name=\"S\u00e3o Paulo\",\n    area_code=11,\n    latitude=\"-23.5505\",\n    longitude=\"-46.6333\",\n    state=state,\n    region=region\n)\n\n# Serializa\u00e7\u00e3o XML (inclui entidades relacionadas)\nxml_string = city.to_xml_string()\n</code></pre>"},{"location":"transport_entities/#sistema-de-rastreamento-de-campos","title":"Sistema de Rastreamento de Campos","text":"<p>Cada entidade rastreia quais campos foram definidos via <code>_fields_set</code>. Isso \u00e9 equivalente ao padr\u00e3o <code>_fieldSet</code> e <code>ShouldSerialize*()</code> do SDK .NET.</p> Python<pre><code>from sankhya_sdk.models.transport import Address\n\n# Somente campos passados no construtor s\u00e3o rastreados\naddress = Address(code=1, name=\"Rua A\")\n\nprint(\"code\" in address._fields_set)  # True\nprint(\"name\" in address._fields_set)  # True\nprint(\"type\" in address._fields_set)  # False (n\u00e3o definido)\n\n# Campos atribu\u00eddos posteriormente s\u00e3o rastreados\naddress.type = \"Comercial\"\nprint(\"type\" in address._fields_set)  # True\n\n# Verificar se deve serializar um campo\nprint(address.should_serialize_field(\"code\"))  # True\nprint(address.should_serialize_field(\"type\"))  # True\nprint(address.should_serialize_field(\"description_correios\"))  # False\n\n# Obter campos modificados\nmodified = address.get_modified_fields()\n# {\"code\": 1, \"name\": \"Rua A\", \"type\": \"Comercial\"}\n</code></pre>"},{"location":"transport_entities/#serializacaodeserializacao-xml","title":"Serializa\u00e7\u00e3o/Deserializa\u00e7\u00e3o XML","text":""},{"location":"transport_entities/#serializacao-para-xml","title":"Serializa\u00e7\u00e3o para XML","text":"Python<pre><code>from sankhya_sdk.models.transport import City\n\ncity = City(code=1, name=\"S\u00e3o Paulo\")\n\n# Para lxml.etree.Element\nxml_element = city.to_xml()\n\n# Para string XML\nxml_string = city.to_xml_string()\n\n# Com formata\u00e7\u00e3o (pretty print)\nxml_formatted = city.to_xml_string(pretty_print=True)\n</code></pre>"},{"location":"transport_entities/#deserializacao-de-xml","title":"Deserializa\u00e7\u00e3o de XML","text":"Python<pre><code>from lxml import etree\nfrom sankhya_sdk.models.transport import City\n\n# De string XML\nxml_str = \"&lt;Cidade&gt;&lt;CODCID&gt;1&lt;/CODCID&gt;&lt;NOMECID&gt;S\u00e3o Paulo&lt;/NOMECID&gt;&lt;/Cidade&gt;\"\ncity = City.from_xml_string(xml_str)\n\n# De elemento lxml\nelem = etree.fromstring(xml_str)\ncity = City.from_xml(elem)\n</code></pre>"},{"location":"transport_entities/#tabela-de-mapeamento-de-campos","title":"Tabela de Mapeamento de Campos","text":""},{"location":"transport_entities/#address","title":"Address","text":"Propriedade Python Elemento XML Propriedade C# Tipo Python Observa\u00e7\u00f5es <code>code</code> <code>CODEND</code> <code>Code</code> <code>int</code> Chave prim\u00e1ria <code>type</code> <code>TIPO</code> <code>Type</code> <code>Optional[str]</code> - <code>name</code> <code>NOMEEND</code> <code>Name</code> <code>Optional[str]</code> Max 60 caracteres <code>description_correios</code> <code>DESCRICAOCORREIO</code> <code>DescriptionCorreios</code> <code>Optional[str]</code> - <code>date_changed</code> <code>DTALTER</code> <code>DateChanged</code> <code>Optional[datetime]</code> -"},{"location":"transport_entities/#state","title":"State","text":"Propriedade Python Elemento XML Propriedade C# Tipo Python Observa\u00e7\u00f5es <code>code</code> <code>CODUF</code> <code>Code</code> <code>int</code> Chave prim\u00e1ria <code>initials</code> <code>UF</code> <code>Initials</code> <code>Optional[str]</code> Sigla UF <code>name</code> <code>DESCRICAO</code> <code>Name</code> <code>Optional[str]</code> - <code>code_country</code> <code>CODPAIS</code> <code>CodeCountry</code> <code>Optional[int]</code> - <code>code_partner_secretary_of_state_revenue</code> <code>CODPARCSECRECEST</code> <code>CodePartnerSecretaryOfStateRevenue</code> <code>Optional[int]</code> - <code>code_ibge</code> <code>CODIBGE</code> <code>CodeIbge</code> <code>Optional[int]</code> - <code>code_revenue</code> <code>CODSTGNRE</code> <code>CodeRevenue</code> <code>Optional[int]</code> - <code>code_revenue_detailing</code> <code>CODDETGNRE</code> <code>CodeRevenueDetailing</code> <code>Optional[int]</code> - <code>code_product</code> <code>CODPRODGNRE</code> <code>CodeProduct</code> <code>Optional[int]</code> - <code>agreement_protocol</code> <code>PROTOCOLOCONVENIO</code> <code>AgreementProtocol</code> <code>Optional[str]</code> -"},{"location":"transport_entities/#region","title":"Region","text":"Propriedade Python Elemento XML Propriedade C# Tipo Python Observa\u00e7\u00f5es <code>code</code> <code>CODREG</code> <code>Code</code> <code>int</code> Chave prim\u00e1ria <code>code_region_father</code> <code>CODREGPAI</code> <code>CodeRegionFather</code> <code>Optional[int]</code> - <code>code_price_table</code> <code>CODTAB</code> <code>CodePriceTable</code> <code>Optional[int]</code> - <code>code_seller</code> <code>CODVEND</code> <code>CodeSeller</code> <code>Optional[int]</code> - <code>active</code> - <code>Active</code> <code>property -&gt; bool</code> Computado de <code>active_internal</code> <code>active_internal</code> <code>ATIVA</code> <code>ActiveInternal</code> <code>Optional[str]</code> \"S\" ou \"N\" <code>name</code> <code>NOMEREG</code> <code>Name</code> <code>Optional[str]</code> - <code>seller</code> - <code>Seller</code> <code>Optional[Seller]</code> Relacionamento"},{"location":"transport_entities/#city","title":"City","text":"Propriedade Python Elemento XML Propriedade C# Tipo Python Observa\u00e7\u00f5es <code>code</code> <code>CODCID</code> <code>Code</code> <code>int</code> Chave prim\u00e1ria <code>code_state</code> <code>UF</code> <code>CodeState</code> <code>Optional[int]</code> FK para State <code>code_region</code> <code>CODREG</code> <code>CodeRegion</code> <code>Optional[int]</code> FK para Region <code>code_fiscal</code> <code>CODMUNFIS</code> <code>CodeFiscal</code> <code>Optional[int]</code> - <code>name</code> <code>NOMECID</code> <code>Name</code> <code>Optional[str]</code> - <code>description_correios</code> <code>DESCRICAOCORREIO</code> <code>DescriptionCorreios</code> <code>Optional[str]</code> - <code>area_code</code> <code>DDD</code> <code>AreaCode</code> <code>Optional[int]</code> - <code>latitude</code> <code>LATITUDE</code> <code>Latitude</code> <code>Optional[str]</code> - <code>longitude</code> <code>LONGITUDE</code> <code>Longitude</code> <code>Optional[str]</code> - <code>state</code> - <code>State</code> <code>Optional[State]</code> Relacionamento <code>region</code> - <code>Region</code> <code>Optional[Region]</code> Relacionamento"},{"location":"transport_entities/#diagrama-de-relacionamentos","title":"Diagrama de Relacionamentos","text":"<pre><code>classDiagram\n    class EntityBase {\n        +_fields_set: Set[str]\n        +should_serialize_field(field_name: str) bool\n        +get_modified_fields() Dict\n    }\n\n    class TransportEntityBase {\n        +to_xml() Element\n        +from_xml(element: Element) Self\n        +to_xml_string() str\n        +from_xml_string(xml: str) Self\n    }\n\n    class Address {\n        +code: int\n        +type: str\n        +name: str\n        +description_correios: str\n        +date_changed: datetime\n    }\n\n    class State {\n        +code: int\n        +initials: str\n        +name: str\n        +code_country: int\n        +code_ibge: int\n    }\n\n    class Region {\n        +code: int\n        +name: str\n        +active: bool\n        +seller: Seller\n    }\n\n    class City {\n        +code: int\n        +name: str\n        +code_state: int\n        +code_region: int\n        +latitude: str\n        +longitude: str\n        +state: State\n        +region: Region\n    }\n\n    EntityBase &lt;|-- TransportEntityBase\n    TransportEntityBase &lt;|-- Address\n    TransportEntityBase &lt;|-- State\n    TransportEntityBase &lt;|-- Region\n    TransportEntityBase &lt;|-- City\n\n    City --&gt; State : references\n    City --&gt; Region : references\n    Region --&gt; Seller : references</code></pre>"},{"location":"transport_entities/#comparacao-e-hash","title":"Compara\u00e7\u00e3o e Hash","text":"<p>As entidades implementam <code>__eq__</code> e <code>__hash__</code> para uso em cole\u00e7\u00f5es:</p> Python<pre><code>from sankhya_sdk.models.transport import Address\n\n# Compara\u00e7\u00e3o case-insensitive para strings\naddr1 = Address(code=1, name=\"RUA PRINCIPAL\")\naddr2 = Address(code=1, name=\"rua principal\")\n\nprint(addr1 == addr2)  # True\n\n# Uso em sets e dicts\naddresses = {addr1, addr2}  # Cont\u00e9m apenas 1 elemento\nprint(len(addresses))  # 1\n</code></pre>"},{"location":"transport_entities/#validacao","title":"Valida\u00e7\u00e3o","text":"<p>Campos com <code>entity_custom_data(max_length=N)</code> s\u00e3o validados automaticamente:</p> Python<pre><code>from sankhya_sdk.models.transport import Address\n\n# Nome com 60 caracteres (OK)\naddress = Address(code=1, name=\"A\" * 60)\n\n# Nome com 61 caracteres (ValueError)\ntry:\n    address = Address(code=1, name=\"A\" * 61)\nexcept ValueError as e:\n    print(f\"Erro: {e}\")\n</code></pre>"},{"location":"validations/","title":"Valida\u00e7\u00f5es de Entidades","text":"<p>O m\u00f3dulo <code>sankhya_sdk.validations</code> fornece utilit\u00e1rios para validar classes de entidade e analisar mensagens de erro da API Sankhya.</p>"},{"location":"validations/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O m\u00f3dulo consiste em duas classes principais:</p> <ol> <li><code>EntityValidator</code>: Valida\u00e7\u00e3o estrutural de entidades usando reflection</li> <li><code>EntityValidation</code>: Padr\u00f5es Regex compilados para an\u00e1lise de mensagens de erro</li> </ol>"},{"location":"validations/#entityvalidator","title":"EntityValidator","text":"<p>A classe <code>EntityValidator</code> fornece m\u00e9todos est\u00e1ticos para validar que classes de entidade implementam corretamente todos os requisitos do SDK.</p>"},{"location":"validations/#validacoes-realizadas","title":"Valida\u00e7\u00f5es Realizadas","text":"Valida\u00e7\u00e3o Descri\u00e7\u00e3o Exce\u00e7\u00e3o Construtor Entidade deve ter construtor sem par\u00e2metros obrigat\u00f3rios <code>MissingConstructorError</code> Decorador Entidade deve ter decorador <code>@entity</code> <code>MissingEntityAttributeError</code> Classe Base Entidade deve herdar de <code>TransportEntityBase</code> <code>MissingBaseClassError</code> Igualdade Entidade deve implementar <code>__eq__</code> e <code>__hash__</code> <code>MissingEqualityMethodsError</code> Propriedades Cada campo deve ter atributo v\u00e1lido <code>InvalidPropertyAttributeError</code>"},{"location":"validations/#uso-basico","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidator, EntityValidationError\n\n# Validar uma \u00fanica entidade\ntry:\n    EntityValidator.validate_entity(MyEntity)\nexcept EntityValidationError as e:\n    print(f\"Entidade inv\u00e1lida: {e}\")\n\n# Validar todas as entidades em um m\u00f3dulo\nimport mymodule\nEntityValidator.validate_entities(mymodule)\n</code></pre>"},{"location":"validations/#verificacao-de-igualdade","title":"Verifica\u00e7\u00e3o de Igualdade","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidator\n\n# Verificar se uma entidade implementa m\u00e9todos de igualdade\nif EntityValidator.implements_equality(MyEntity):\n    print(\"Entidade implementa __eq__ e __hash__\")\n</code></pre>"},{"location":"validations/#integracao-com-validators","title":"Integra\u00e7\u00e3o com Validators","text":"<p>O m\u00f3dulo tamb\u00e9m pode ser usado atrav\u00e9s da fun\u00e7\u00e3o de conveni\u00eancia em <code>validators</code>:</p> Python<pre><code>from sankhya_sdk.attributes.validators import validate_entity_class\n\n# Valida a classe de entidade\nvalidate_entity_class(MyEntity)\n</code></pre>"},{"location":"validations/#entityvalidation","title":"EntityValidation","text":"<p>A classe <code>EntityValidation</code> cont\u00e9m padr\u00f5es Regex compilados para extrair informa\u00e7\u00f5es de mensagens de erro da API Sankhya.</p>"},{"location":"validations/#padroes-disponiveis","title":"Padr\u00f5es Dispon\u00edveis","text":"Padr\u00e3o Descri\u00e7\u00e3o Grupos Nomeados <code>REFERENCE_FIELDS_FIRST_LEVEL_PATTERN</code> Campos de refer\u00eancia de primeiro n\u00edvel <code>entity</code>, <code>field</code> <code>REFERENCE_FIELDS_SECOND_LEVEL_PATTERN</code> Campos de refer\u00eancia de segundo n\u00edvel <code>parentEntity</code>, <code>entity</code>, <code>field</code> <code>PROPERTY_VALUE_ERROR_PATTERN</code> Erro ao obter valor de propriedade <code>propertyName</code> <code>PROPERTY_NAME_ERROR_PATTERN</code> Descritor de campo inv\u00e1lido <code>propertyName</code> <code>PROPERTY_NAME_ASSOCIATION_ERROR_PATTERN</code> Identificador n\u00e3o associado <code>entity</code>, <code>propertyName</code> <code>PROPERTY_NOT_FOUND_PATTERN</code> Campo n\u00e3o existe <code>entity</code>, <code>propertyName</code> <code>PROPERTY_NAME_INVALID_ERROR_PATTERN</code> Nome de coluna inv\u00e1lido <code>propertyName</code> <code>PROPERTY_WIDTH_ERROR_PATTERN</code> Largura acima do limite <code>propertyName</code>, <code>currentWidth</code>, <code>widthAllowed</code> <code>PROPERTY_FOREIGN_KEY_RESTRICTION_PATTERN</code> Conflito de chave estrangeira <code>constraintName</code>, <code>database</code>, <code>table</code>, <code>column</code> <code>DUPLICATED_DOCUMENT_PATTERN</code> CNPJ/CPF duplicado <code>name</code> <code>BUSINESS_RULE_RESTRICTION_PATTERN</code> Regra de neg\u00f3cio bloqueou opera\u00e7\u00e3o <code>ruleName</code>, <code>errorMessage</code> <code>FULL_TRANSACTION_LOGS_PATTERN</code> Log de transa\u00e7\u00f5es cheio <code>database</code> <code>MISSING_RELATION_PATTERN</code> Relacionamento n\u00e3o encontrado <code>missingRelation</code>, <code>entity</code> <code>MISSING_ATTRIBUTE_PATTERN</code> Atributo obrigat\u00f3rio faltando <code>attributeName</code>"},{"location":"validations/#uso-basico_1","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidation\n\n# Verificar se uma mensagem de erro indica campo n\u00e3o encontrado\nerror_message = \"Campo n\u00e3o existe: PARCEIRO-&gt;NOMEPARC\"\nmatch = EntityValidation.match_property_not_found(error_message)\nif match:\n    entity = match.group(\"entity\")       # \"PARCEIRO\"\n    field = match.group(\"propertyName\")  # \"NOMEPARC\"\n    print(f\"Campo '{field}' n\u00e3o existe na entidade '{entity}'\")\n</code></pre>"},{"location":"validations/#metodos-de-conveniencia","title":"M\u00e9todos de Conveni\u00eancia","text":"<p>A classe fornece m\u00e9todos est\u00e1ticos para cada padr\u00e3o:</p> Python<pre><code># Correspond\u00eancia de primeiro n\u00edvel\nmatch = EntityValidation.match_reference_first_level(\"Parceiro_NOMEPARC\")\n\n# Erro de valor de propriedade\nmatch = EntityValidation.match_property_value_error(\n    \"erro ao obter valor da propriedade 'CODPROD'\"\n)\n\n# Restri\u00e7\u00e3o de regra de neg\u00f3cio\nmatch = EntityValidation.match_business_rule_restriction(\n    'A regra \"Valida\u00e7\u00e3o de Cr\u00e9dito\" n\u00e3o permitiu a opera\u00e7\u00e3o.\\n'\n    'Cliente sem limite dispon\u00edvel.'\n)\nif match:\n    rule = match.group(\"ruleName\")          # \"Valida\u00e7\u00e3o de Cr\u00e9dito\"\n    message = match.group(\"errorMessage\")   # \"Cliente sem limite dispon\u00edvel.\"\n</code></pre>"},{"location":"validations/#exemplo-de-tratamento-de-erros","title":"Exemplo de Tratamento de Erros","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidation\nfrom sankhya_sdk.exceptions import SankhyaException\n\ndef handle_sankhya_error(error: SankhyaException) -&gt; None:\n    \"\"\"Trata erros da API Sankhya de forma inteligente.\"\"\"\n    message = str(error)\n\n    # Verifica documento duplicado\n    if match := EntityValidation.match_duplicated_document(message):\n        name = match.group(\"name\")\n        raise ValueError(f\"Parceiro '{name}' j\u00e1 possui este documento\")\n\n    # Verifica viola\u00e7\u00e3o de chave estrangeira\n    if match := EntityValidation.match_foreign_key_restriction(message):\n        table = match.group(\"table\")\n        raise ValueError(f\"Registro referenciado n\u00e3o existe na tabela {table}\")\n\n    # Verifica regra de neg\u00f3cio\n    if match := EntityValidation.match_business_rule_restriction(message):\n        rule = match.group(\"ruleName\")\n        details = match.group(\"errorMessage\")\n        raise ValueError(f\"Regra '{rule}' bloqueou: {details}\")\n\n    # Erro gen\u00e9rico\n    raise error\n</code></pre>"},{"location":"validations/#excecoes","title":"Exce\u00e7\u00f5es","text":""},{"location":"validations/#hierarquia-de-excecoes","title":"Hierarquia de Exce\u00e7\u00f5es","text":"Text Only<pre><code>EntityValidationError (base)\n\u251c\u2500\u2500 MissingConstructorError\n\u251c\u2500\u2500 MissingEntityAttributeError\n\u251c\u2500\u2500 MissingBaseClassError\n\u251c\u2500\u2500 MissingEqualityMethodsError\n\u251c\u2500\u2500 InvalidPropertyAttributeError\n\u2514\u2500\u2500 MissingSerializeMethodError\n</code></pre>"},{"location":"validations/#tratamento-de-excecoes","title":"Tratamento de Exce\u00e7\u00f5es","text":"Python<pre><code>from sankhya_sdk.validations import (\n    EntityValidationError,\n    MissingEntityAttributeError,\n    MissingBaseClassError,\n)\n\ntry:\n    EntityValidator.validate_entity(MyEntity)\nexcept MissingEntityAttributeError:\n    print(\"Adicione o decorador @entity \u00e0 classe\")\nexcept MissingBaseClassError:\n    print(\"A classe deve herdar de TransportEntityBase\")\nexcept EntityValidationError as e:\n    print(f\"Erro de valida\u00e7\u00e3o: {e}\")\n</code></pre>"},{"location":"validations/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<ol> <li> <p>Valide entidades durante o desenvolvimento: Use <code>EntityValidator.validate_entities()</code> em testes para garantir que todas as entidades est\u00e3o corretas.</p> </li> <li> <p>Trate erros da API de forma inteligente: Use <code>EntityValidation</code> para extrair informa\u00e7\u00f5es \u00fateis de mensagens de erro.</p> </li> <li> <p>Implemente <code>__eq__</code> e <code>__hash__</code>: Mesmo que <code>TransportEntityBase</code> forne\u00e7a implementa\u00e7\u00f5es padr\u00e3o, considere sobrescrever para compara\u00e7\u00e3o customizada.</p> </li> <li> <p>Use atributos corretos em campos: Cada campo deve ter <code>entity_element</code>, <code>entity_key</code>, <code>entity_reference</code>, ou <code>entity_ignore</code>.</p> </li> </ol> Python<pre><code>from sankhya_sdk.attributes.decorators import (\n    entity,\n    entity_key,\n    entity_element,\n    entity_reference,\n    entity_ignore,\n)\nfrom sankhya_sdk.models.transport.base import TransportEntityBase\nfrom pydantic import Field\nfrom typing import Optional\n\n\n@entity(\"Parceiro\")\nclass Partner(TransportEntityBase):\n    # Chave prim\u00e1ria\n    code: Optional[int] = Field(\n        default=None,\n        json_schema_extra=entity_key(\"CODPARC\"),\n    )\n\n    # Campo simples\n    name: Optional[str] = Field(\n        default=None,\n        json_schema_extra=entity_element(\"NOMEPARC\"),\n    )\n\n    # Refer\u00eancia a outra entidade\n    city: Optional[\"City\"] = Field(\n        default=None,\n        json_schema_extra=entity_reference(\"Cidade\"),\n    )\n\n    # Campo ignorado na serializa\u00e7\u00e3o\n    internal_cache: Optional[dict] = Field(\n        default=None,\n        json_schema_extra=entity_ignore(),\n    )\n</code></pre>"},{"location":"value_objects/","title":"ValueObjects","text":"<p>Este m\u00f3dulo cont\u00e9m objetos de valor (ValueObjects) que representam conceitos importantes do ecossistema Sankhya, usados principalmente para transfer\u00eancia de dados entre o SDK e os servi\u00e7os da Sankhya.</p>"},{"location":"value_objects/#servicefile","title":"ServiceFile","text":"<p>Representa um arquivo que pode ser enviado para ou recebido de um servi\u00e7o Sankhya.</p>"},{"location":"value_objects/#propriedades","title":"Propriedades","text":"<ul> <li><code>content_type</code>: Tipo MIME do arquivo (ex: <code>application/pdf</code>).</li> <li><code>file_name</code>: Nome do arquivo com extens\u00e3o.</li> <li><code>file_extension</code>: Extens\u00e3o do arquivo (sempre come\u00e7a com <code>.</code>).</li> <li><code>data</code>: Conte\u00fado bin\u00e1rio do arquivo.</li> </ul>"},{"location":"value_objects/#exemplo-de-uso","title":"Exemplo de Uso","text":"Python<pre><code>from pathlib import Path\nfrom sankhya_sdk import ServiceFile\n\n# Criar a partir de um arquivo local\nsf = ServiceFile.from_path(Path(\"relatorio.pdf\"))\n\n# Salvar em um diret\u00f3rio\nsf.save_to(Path(\"./downloads\"))\n</code></pre>"},{"location":"value_objects/#parsepropertymodel","title":"ParsePropertyModel","text":"<p>Modelo usado internamente para descrever como uma propriedade de uma entidade deve ser processada (parse) durante a resolu\u00e7\u00e3o da entidade.</p>"},{"location":"value_objects/#propriedades_1","title":"Propriedades","text":"<ul> <li><code>is_ignored</code>: Se a propriedade deve ser ignorada.</li> <li><code>is_criteria</code>: Se pode ser usada como crit\u00e9rio de busca.</li> <li><code>is_entity_key</code>: Se \u00e9 uma chave prim\u00e1ria.</li> <li><code>is_entity_reference</code>: Se \u00e9 uma refer\u00eancia para outra entidade.</li> <li><code>property_name</code>: Nome da propriedade no Sankhya (mapeado pelo decorator <code>@entity_element</code>).</li> <li><code>custom_data</code>: Metadados customizados (como tamanho m\u00e1ximo).</li> </ul>"},{"location":"value_objects/#entityresolverresult","title":"EntityResolverResult","text":"<p>Resultado consolidado da an\u00e1lise de uma inst\u00e2ncia de entidade, preparando-a para ser enviada em uma requisi\u00e7\u00e3o de servi\u00e7o.</p>"},{"location":"value_objects/#metodos-principais","title":"M\u00e9todos Principais","text":"<ul> <li><code>add_field_value(name, value)</code>: Adiciona um valor de campo.</li> <li><code>add_key(name, value)</code>: Adiciona uma chave prim\u00e1ria.</li> <li><code>add_criteria(name, value)</code>: Adiciona um crit\u00e9rio de filtragem.</li> <li><code>add_field(name)</code>: Adiciona um campo na lista de campos a retornar.</li> <li><code>add_reference(relation_name, field_name)</code>: Adiciona um campo de uma entidade relacionada.</li> </ul>"},{"location":"value_objects/#diagrama-de-relacionamentos","title":"Diagrama de Relacionamentos","text":"<pre><code>classDiagram\n    class ServiceFile {\n        +str content_type\n        +str file_name\n        +str file_extension\n        +bytes data\n        +from_path(Path) ServiceFile\n        +save_to(Path) Path\n    }\n\n    class ParsePropertyModel {\n        +bool is_ignored\n        +bool is_criteria\n        +bool is_entity_key\n        +bool is_entity_reference\n        +str property_name\n        +EntityCustomDataMetadata custom_data\n        +from_field_info(str, FieldInfo) ParsePropertyModel\n    }\n\n    class EntityResolverResult {\n        +str entity_name\n        +List~FieldValue~ field_values\n        +List~FieldValue~ keys\n        +List~Criteria~ criteria\n        +List~Field~ fields\n        +Dict~str,List~Field~~ references\n        +LiteralCriteria literal_criteria\n        +add_field_value(str, str)\n        +add_key(str, str)\n        +add_criteria(str, str)\n    }\n\n    class FieldValue {\n        +str name\n        +Optional~str~ value\n    }\n\n    class Criteria {\n        +str name\n        +str value\n    }\n\n    class Field {\n        +str name\n        +Optional~str~ list\n        +bool except_\n        +Optional~str~ value\n    }\n\n    class LiteralCriteria {\n        +Optional~str~ expression\n        +List~Parameter~ parameters\n    }\n\n    class Parameter {\n        +ParameterType type\n        +str value\n    }\n\n    EntityResolverResult --&gt; FieldValue\n    EntityResolverResult --&gt; Criteria\n    EntityResolverResult --&gt; Field\n    EntityResolverResult --&gt; LiteralCriteria\n    LiteralCriteria --&gt; Parameter\n    ParsePropertyModel --&gt; EntityCustomDataMetadata</code></pre>"},{"location":"value_objects/#comparativo-net-vs-python","title":"Comparativo .NET vs Python","text":".NET SDK Python SDK Observa\u00e7\u00e3o <code>ServiceFile</code> <code>ServiceFile</code> Implementado como Pydantic model. <code>ParsePropertyModel</code> <code>ParsePropertyModel</code> Integrado com metadados Pydantic. <code>EntityResolverResult</code> <code>EntityResolverResult</code> Dataclass com cole\u00e7\u00f5es tipadas. <code>FieldValue</code> <code>FieldValue</code> Compara\u00e7\u00e3o case-insensitive no Python. <code>Criteria</code> <code>Criteria</code> Campos opcionais. <code>Field</code> <code>Field</code> Usa <code>except_</code> para evitar palavra reservada."},{"location":"wrapper/","title":"SankhyaWrapper - Comunica\u00e7\u00e3o HTTP com a API Sankhya","text":"<p>Este m\u00f3dulo fornece classes para gerenciar a comunica\u00e7\u00e3o HTTP com a API Sankhya, incluindo autentica\u00e7\u00e3o, retry autom\u00e1tico e tratamento de exce\u00e7\u00f5es.</p>"},{"location":"wrapper/#visao-geral-da-arquitetura","title":"Vis\u00e3o Geral da Arquitetura","text":"<pre><code>classDiagram\n    class LowLevelSankhyaWrapper {\n        -_http_session: Session\n        -_host: str\n        -_port: int\n        +environment: ServiceEnvironment\n        +database_name: str\n        +user_code: int\n        +_build_service_url() str\n        +_make_request() Response\n    }\n\n    class SankhyaWrapper {\n        -_session_info: SessionInfo\n        -_request_count: int\n        +authenticate(username, password)\n        +service_invoker(request) ServiceResponse\n        +get_file(key) ServiceFile\n        +get_image(entity, keys) ServiceFile\n        +dispose()\n    }\n\n    class SankhyaContext {\n        -_wrapper: SankhyaWrapper\n        +__enter__() SankhyaWrapper\n        +__exit__()\n        +from_settings() SankhyaContext\n    }\n\n    class LockManager {\n        +get_lock(key) Lock\n        +release_lock(key)\n    }\n\n    SankhyaWrapper --|&gt; LowLevelSankhyaWrapper\n    SankhyaContext o-- SankhyaWrapper\n    SankhyaWrapper ..&gt; LockManager</code></pre>"},{"location":"wrapper/#uso-basico","title":"Uso B\u00e1sico","text":""},{"location":"wrapper/#quick-start","title":"Quick Start","text":"<p>A forma mais simples de usar o SDK \u00e9 atrav\u00e9s do <code>SankhyaContext</code>:</p> Python<pre><code>from sankhya_sdk.core import SankhyaContext\nfrom sankhya_sdk.enums import ServiceName\nfrom sankhya_sdk.models.service import ServiceRequest\n\n# Usando context manager (recomendado)\nwith SankhyaContext.from_settings() as wrapper:\n    request = ServiceRequest(service=ServiceName.CRUD_FIND)\n    # Configurar request...\n    response = wrapper.service_invoker(request)\n\n    if response.is_success:\n        for entity in response.entities:\n            print(entity)\n</code></pre>"},{"location":"wrapper/#configuracao-via-env","title":"Configura\u00e7\u00e3o via .env","text":"<p>O SDK carrega configura\u00e7\u00f5es automaticamente de vari\u00e1veis de ambiente:</p> Text Only<pre><code>SANKHYA_URL=http://servidor-sankhya.exemplo.com\nSANKHYA_PORT=8180\nSANKHYA_USERNAME=usuario@empresa.com\nSANKHYA_PASSWORD=senha_segura\nSANKHYA_TIMEOUT=30\nSANKHYA_MAX_RETRIES=3\n</code></pre>"},{"location":"wrapper/#configuracao-manual","title":"Configura\u00e7\u00e3o Manual","text":"<p>Voc\u00ea tamb\u00e9m pode configurar o wrapper manualmente:</p> Python<pre><code>from sankhya_sdk.core import SankhyaWrapper\n\nwrapper = SankhyaWrapper(\n    host=\"http://servidor-sankhya.exemplo.com\",\n    port=8180,\n    timeout=30,\n    max_retries=3,\n)\n\nwrapper.authenticate(\"usuario\", \"senha\")\n\ntry:\n    # Usar o wrapper...\n    pass\nfinally:\n    wrapper.dispose()\n</code></pre>"},{"location":"wrapper/#classes-principais","title":"Classes Principais","text":""},{"location":"wrapper/#sankhyawrapper","title":"SankhyaWrapper","text":"<p>A classe principal que gerencia toda a comunica\u00e7\u00e3o com a API Sankhya.</p>"},{"location":"wrapper/#propriedades","title":"Propriedades","text":"Propriedade Tipo Descri\u00e7\u00e3o <code>is_authenticated</code> <code>bool</code> Se h\u00e1 uma sess\u00e3o ativa <code>session_id</code> <code>Optional[str]</code> ID da sess\u00e3o atual <code>user_code</code> <code>int</code> C\u00f3digo do usu\u00e1rio autenticado <code>environment</code> <code>ServiceEnvironment</code> Ambiente de servi\u00e7o <code>request_count</code> <code>int</code> N\u00famero de requisi\u00e7\u00f5es realizadas"},{"location":"wrapper/#metodos","title":"M\u00e9todos","text":""},{"location":"wrapper/#authenticateusername-str-password-str-none","title":"<code>authenticate(username: str, password: str) -&gt; None</code>","text":"<p>Autentica no servidor Sankhya e inicia uma sess\u00e3o.</p> Python<pre><code>wrapper.authenticate(\"usuario@empresa.com\", \"senha\")\n</code></pre>"},{"location":"wrapper/#service_invokerrequest-servicerequest-serviceresponse","title":"<code>service_invoker(request: ServiceRequest) -&gt; ServiceResponse</code>","text":"<p>Invoca um servi\u00e7o no Sankhya com retry autom\u00e1tico.</p> Python<pre><code>request = ServiceRequest(service=ServiceName.CRUD_FIND)\nresponse = wrapper.service_invoker(request)\n</code></pre>"},{"location":"wrapper/#service_invoker_asyncrequest-servicerequest-serviceresponse","title":"<code>service_invoker_async(request: ServiceRequest) -&gt; ServiceResponse</code>","text":"<p>Vers\u00e3o ass\u00edncrona do <code>service_invoker</code>.</p> Python<pre><code>response = await wrapper.service_invoker_async(request)\n</code></pre>"},{"location":"wrapper/#get_filekey-str-servicefile","title":"<code>get_file(key: str) -&gt; ServiceFile</code>","text":"<p>Baixa um arquivo do reposit\u00f3rio Sankhya.</p> Python<pre><code>file = wrapper.get_file(\"CHAVE_ARQUIVO\")\nwith open(file.filename or \"arquivo.pdf\", \"wb\") as f:\n    f.write(file.data)\n</code></pre>"},{"location":"wrapper/#get_imageentity-str-keys-dictstr-any-optionalservicefile","title":"<code>get_image(entity: str, keys: Dict[str, Any]) -&gt; Optional[ServiceFile]</code>","text":"<p>Baixa uma imagem associada a uma entidade.</p> Python<pre><code>image = wrapper.get_image(\"Parceiro\", {\"CODPARC\": 1})\nif image:\n    with open(f\"parceiro.{image.file_extension}\", \"wb\") as f:\n        f.write(image.data)\n</code></pre>"},{"location":"wrapper/#dispose-none","title":"<code>dispose() -&gt; None</code>","text":"<p>Libera recursos e encerra a sess\u00e3o.</p> Python<pre><code>wrapper.dispose()\n</code></pre>"},{"location":"wrapper/#sankhyacontext","title":"SankhyaContext","text":"<p>Context manager para gerenciamento autom\u00e1tico do ciclo de vida do wrapper.</p>"},{"location":"wrapper/#uso-sincrono","title":"Uso S\u00edncrono","text":"Python<pre><code>with SankhyaContext.from_settings() as wrapper:\n    # Usar wrapper...\n    pass\n# dispose() \u00e9 chamado automaticamente\n</code></pre>"},{"location":"wrapper/#uso-assincrono","title":"Uso Ass\u00edncrono","text":"Python<pre><code>async with SankhyaContext.from_settings() as wrapper:\n    response = await wrapper.service_invoker_async(request)\n</code></pre>"},{"location":"wrapper/#lockmanager","title":"LockManager","text":"<p>Gerenciador de locks thread-safe para opera\u00e7\u00f5es concorrentes.</p> Python<pre><code>from sankhya_sdk.core import LockManager\n\nlock = LockManager.get_lock(\"session_123\")\nwith lock:\n    # Opera\u00e7\u00e3o protegida\n    pass\n</code></pre>"},{"location":"wrapper/#tipos-auxiliares","title":"Tipos Auxiliares","text":""},{"location":"wrapper/#sessioninfo","title":"SessionInfo","text":"<p>Armazena informa\u00e7\u00f5es da sess\u00e3o autenticada.</p> Python<pre><code>from sankhya_sdk.core.types import SessionInfo\n\nsession = SessionInfo(\n    session_id=\"ABC123\",\n    user_code=42,\n    username=\"admin\",\n    password=\"secret\",\n)\n</code></pre>"},{"location":"wrapper/#servicefile","title":"ServiceFile","text":"<p>Representa um arquivo baixado do Sankhya.</p> Python<pre><code>from sankhya_sdk.core.types import ServiceFile\n\n# Retornado por get_file() e get_image()\nfile = wrapper.get_file(\"KEY\")\nprint(file.content_type)     # \"application/pdf\"\nprint(file.file_extension)   # \"pdf\"\nprint(file.filename)         # \"documento.pdf\"\nprint(len(file.data))        # Tamanho em bytes\n</code></pre>"},{"location":"wrapper/#sistema-de-retry","title":"Sistema de Retry","text":"<p>O wrapper implementa retry autom\u00e1tico com backoff exponencial para diferentes tipos de erro:</p>"},{"location":"wrapper/#delays-por-tipo-de-erro","title":"Delays por Tipo de Erro","text":"Tipo de Erro Delay Descri\u00e7\u00e3o Timeout 10s (FREE) Sistema saud\u00e1vel, erro transit\u00f3rio Deadlock 15s (STABLE) Sistema est\u00e1vel mas com carga Unavailable 30s (UNSTABLE) Sistema com problemas intermitentes Inaccessible 90s (BREAKDOWN) Sistema em recupera\u00e7\u00e3o"},{"location":"wrapper/#comportamento","title":"Comportamento","text":"<ol> <li>M\u00e1ximo de retries: 3 tentativas (configur\u00e1vel via <code>max_retries</code>)</li> <li>Reautentica\u00e7\u00e3o autom\u00e1tica: Em caso de sess\u00e3o expirada</li> <li>Thread-safe: Locks por sess\u00e3o garantem opera\u00e7\u00f5es seguras</li> </ol> <pre><code>sequenceDiagram\n    participant Client\n    participant Wrapper\n    participant LockManager\n    participant API\n\n    Client-&gt;&gt;Wrapper: service_invoker(request)\n    Wrapper-&gt;&gt;LockManager: get_lock(session_id)\n\n    loop Retry at\u00e9 3x\n        Wrapper-&gt;&gt;API: POST /service\n        alt Sucesso\n            API--&gt;&gt;Wrapper: XML Response\n            Wrapper--&gt;&gt;Client: ServiceResponse\n        else Erro Retryable\n            Wrapper-&gt;&gt;Wrapper: sleep(delay)\n        else Erro Fatal\n            Wrapper--&gt;&gt;Client: raise Exception\n        end\n    end\n\n    Wrapper-&gt;&gt;LockManager: release_lock()</code></pre>"},{"location":"wrapper/#tratamento-de-excecoes","title":"Tratamento de Exce\u00e7\u00f5es","text":"<p>O wrapper trata automaticamente as seguintes exce\u00e7\u00f5es:</p> Exce\u00e7\u00e3o A\u00e7\u00e3o Retry <code>ServiceRequestInvalidAuthorizationException</code> Reautentica Sim <code>ServiceRequestTimeoutException</code> Aguarda 10s Sim <code>ServiceRequestDeadlockException</code> Aguarda 15s Sim <code>ServiceRequestUnavailableException</code> Aguarda 30s Sim <code>ServiceRequestInaccessibleException</code> Reautentica + 90s Sim <code>ServiceRequestCompetitionException</code> Reautentica Sim Outras exce\u00e7\u00f5es Propaga N\u00e3o"},{"location":"wrapper/#thread-safety","title":"Thread-Safety","text":"<p>O <code>SankhyaWrapper</code> \u00e9 thread-safe e pode ser usado em aplica\u00e7\u00f5es concorrentes:</p> Python<pre><code>import threading\nfrom sankhya_sdk.core import SankhyaContext\n\ndef worker(wrapper, thread_id):\n    request = ServiceRequest(service=ServiceName.CRUD_FIND)\n    response = wrapper.service_invoker(request)\n    print(f\"Thread {thread_id}: {len(response.entities)} entidades\")\n\nwith SankhyaContext.from_settings() as wrapper:\n    threads = [\n        threading.Thread(target=worker, args=(wrapper, i))\n        for i in range(5)\n    ]\n\n    for t in threads:\n        t.start()\n    for t in threads:\n        t.join()\n</code></pre>"},{"location":"wrapper/#ambientes-de-servico","title":"Ambientes de Servi\u00e7o","text":"<p>O ambiente \u00e9 determinado automaticamente pela porta:</p> Porta Ambiente Uso 8180 Production Ambiente de produ\u00e7\u00e3o 8280 Sandbox Ambiente de testes 8380 Training Ambiente de treinamento <p>Voc\u00ea pode especificar manualmente:</p> Python<pre><code>from sankhya_sdk.enums import ServiceEnvironment\n\nwrapper = SankhyaWrapper(\n    host=\"http://exemplo.com\",\n    port=9999,  # Porta customizada\n    environment=ServiceEnvironment.SANDBOX,\n)\n</code></pre>"},{"location":"wrapper/#constantes","title":"Constantes","text":"<p>O m\u00f3dulo <code>sankhya_sdk.core.constants</code> exp\u00f5e constantes \u00fateis:</p> Python<pre><code>from sankhya_sdk.core import (\n    DEFAULT_TIMEOUT,        # 30 segundos\n    MAX_RETRY_COUNT,        # 3 tentativas\n    MIME_TYPES_TO_EXTENSIONS,  # Mapeamento de MIME types\n)\n</code></pre>"},{"location":"api-reference/","title":"Refer\u00eancia da API","text":"<p>Documenta\u00e7\u00e3o completa da API do Sankhya SDK Python.</p>"},{"location":"api-reference/#modulos","title":"M\u00f3dulos","text":"<ul> <li> <p> Core</p> <p>Classes principais: <code>SankhyaContext</code>, <code>SankhyaWrapper</code>, configura\u00e7\u00f5es.</p> <p> Core</p> </li> <li> <p> Enumera\u00e7\u00f5es</p> <p>Enums para tipos, status e configura\u00e7\u00f5es da API.</p> <p> Enums</p> </li> <li> <p> Exce\u00e7\u00f5es</p> <p>Hierarquia de exce\u00e7\u00f5es do SDK.</p> <p> Exce\u00e7\u00f5es</p> </li> <li> <p> Modelos</p> <p>Modelos de servi\u00e7o e entidades de transporte.</p> <p> Modelos</p> </li> <li> <p> Request Wrappers</p> <p>Wrappers de alto n\u00edvel para opera\u00e7\u00f5es.</p> <p> Wrappers</p> </li> <li> <p> Helpers</p> <p>Utilit\u00e1rios e extens\u00f5es.</p> <p> Helpers</p> </li> <li> <p> Valida\u00e7\u00f5es</p> <p>Validadores de entidades.</p> <p> Valida\u00e7\u00f5es</p> </li> </ul>"},{"location":"api-reference/#sumario-rapido","title":"Sum\u00e1rio R\u00e1pido","text":"Classe M\u00f3dulo Descri\u00e7\u00e3o <code>SankhyaContext</code> <code>sankhya_sdk.core</code> Gerenciador de contexto e sess\u00f5es <code>SankhyaWrapper</code> <code>sankhya_sdk.core</code> Cliente de alto n\u00edvel para API <code>SimpleCRUDRequestWrapper</code> <code>sankhya_sdk.request_wrappers</code> Opera\u00e7\u00f5es CRUD <code>PagedRequestWrapper</code> <code>sankhya_sdk.request_wrappers</code> Consultas paginadas <code>OnDemandRequestWrapper</code> <code>sankhya_sdk.request_wrappers</code> Processamento em lote <code>KnowServicesRequestWrapper</code> <code>sankhya_sdk.request_wrappers</code> Servi\u00e7os espec\u00edficos <code>EntityValidator</code> <code>sankhya_sdk.validations</code> Valida\u00e7\u00e3o de entidades <code>ServiceRequest</code> <code>sankhya_sdk.service_models</code> Modelo de requisi\u00e7\u00e3o <code>ServiceResponse</code> <code>sankhya_sdk.service_models</code> Modelo de resposta"},{"location":"api-reference/#importacao-rapida","title":"Importa\u00e7\u00e3o R\u00e1pida","text":"Python<pre><code># Principais\nfrom sankhya_sdk import SankhyaContext, SankhyaSettings\n\n# Request Wrappers\nfrom sankhya_sdk.request_wrappers import (\n    SimpleCRUDRequestWrapper,\n    PagedRequestWrapper,\n    OnDemandRequestWrapper,\n    KnowServicesRequestWrapper,\n)\n\n# Entidades\nfrom sankhya_sdk.transport_entities import (\n    Partner,\n    Product,\n    InvoiceHeader,\n)\n\n# Exce\u00e7\u00f5es\nfrom sankhya_sdk.exceptions import (\n    SankhyaException,\n    ServiceRequestException,\n    ServiceRequestInvalidAuthorizationException,\n)\n\n# Valida\u00e7\u00f5es\nfrom sankhya_sdk.validations import EntityValidator\n\n# Helpers\nfrom sankhya_sdk.helpers import (\n    EntityQueryOptions,\n    FilterExpression,\n)\n</code></pre>"},{"location":"api-reference/core/","title":"Core","text":"<p>Documenta\u00e7\u00e3o das classes principais do SDK: <code>SankhyaContext</code>, <code>SankhyaWrapper</code> e <code>SankhyaSettings</code>.</p>"},{"location":"api-reference/core/#sankhyacontext","title":"SankhyaContext","text":"<p>Gerenciador central de contexto e sess\u00f5es.</p>"},{"location":"api-reference/core/#uso-basico","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\n\n# Com context manager (recomendado)\nwith SankhyaContext.from_settings() as ctx:\n    result = ctx.wrapper.find(Partner, \"CODPARC &gt; 0\")\n\n# Sem context manager\nctx = SankhyaContext.from_settings()\ntry:\n    result = ctx.wrapper.find(Partner, \"CODPARC &gt; 0\")\nfinally:\n    ctx.dispose()\n</code></pre>"},{"location":"api-reference/core/#metodos-de-classe","title":"M\u00e9todos de Classe","text":""},{"location":"api-reference/core/#from_settingssettings-sankhyasettings-none-none-sankhyacontext","title":"<code>from_settings(settings: SankhyaSettings | None = None) -&gt; SankhyaContext</code>","text":"<p>Cria um contexto a partir de configura\u00e7\u00f5es.</p> Python<pre><code># Usa vari\u00e1veis de ambiente\nctx = SankhyaContext.from_settings()\n\n# Usa configura\u00e7\u00f5es personalizadas\nsettings = SankhyaSettings(\n    base_url=\"https://api.sankhya.com.br\",\n    username=\"usuario\",\n    password=\"senha\"\n)\nctx = SankhyaContext.from_settings(settings)\n</code></pre>"},{"location":"api-reference/core/#propriedades","title":"Propriedades","text":"Propriedade Tipo Descri\u00e7\u00e3o <code>wrapper</code> <code>SankhyaWrapper</code> Wrapper principal para opera\u00e7\u00f5es <code>user_code</code> <code>int</code> C\u00f3digo do usu\u00e1rio autenticado <code>session_token</code> <code>str</code> Token da sess\u00e3o atual <code>is_authenticated</code> <code>bool</code> Se est\u00e1 autenticado"},{"location":"api-reference/core/#metodos-de-instancia","title":"M\u00e9todos de Inst\u00e2ncia","text":""},{"location":"api-reference/core/#acquire_session-uuid","title":"<code>acquire_session() -&gt; UUID</code>","text":"<p>Adquire uma nova sess\u00e3o paralela.</p> Python<pre><code>token = ctx.acquire_session()\n# Use invoke_with_token para opera\u00e7\u00f5es com esta sess\u00e3o\n</code></pre>"},{"location":"api-reference/core/#finalize_sessiontoken-uuid-none","title":"<code>finalize_session(token: UUID) -&gt; None</code>","text":"<p>Finaliza uma sess\u00e3o paralela.</p> Python<pre><code>ctx.finalize_session(token)\n</code></pre>"},{"location":"api-reference/core/#detach_sessiontoken-uuid-dict","title":"<code>detach_session(token: UUID) -&gt; dict</code>","text":"<p>Detacha uma sess\u00e3o para uso em outro contexto.</p> Python<pre><code>session_data = ctx.detach_session(token)\n# Pode ser serializado e enviado para outro processo\n</code></pre>"},{"location":"api-reference/core/#invoke_with_tokentoken-uuid-service_name-str-request-servicerequest-serviceresponse","title":"<code>invoke_with_token(token: UUID, service_name: str, request: ServiceRequest) -&gt; ServiceResponse</code>","text":"<p>Invoca um servi\u00e7o usando uma sess\u00e3o espec\u00edfica.</p> Python<pre><code>response = ctx.invoke_with_token(token, \"ServiceName\", request)\n</code></pre>"},{"location":"api-reference/core/#dispose-none","title":"<code>dispose() -&gt; None</code>","text":"<p>Libera todos os recursos e fecha sess\u00f5es.</p> Python<pre><code>ctx.dispose()\n</code></pre>"},{"location":"api-reference/core/#sankhyawrapper","title":"SankhyaWrapper","text":"<p>Cliente de alto n\u00edvel para comunica\u00e7\u00e3o com a API.</p>"},{"location":"api-reference/core/#uso-basico_1","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\n\nwith SankhyaContext.from_settings() as ctx:\n    wrapper = ctx.wrapper\n    partners = wrapper.find(Partner, \"CODPARC &gt; 0\")\n</code></pre>"},{"location":"api-reference/core/#metodos-de-autenticacao","title":"M\u00e9todos de Autentica\u00e7\u00e3o","text":""},{"location":"api-reference/core/#login-none","title":"<code>login() -&gt; None</code>","text":"<p>Realiza login na API.</p> Python<pre><code>wrapper.login()\n</code></pre>"},{"location":"api-reference/core/#logout-none","title":"<code>logout() -&gt; None</code>","text":"<p>Realiza logout da API.</p> Python<pre><code>wrapper.logout()\n</code></pre>"},{"location":"api-reference/core/#metodos-crud","title":"M\u00e9todos CRUD","text":""},{"location":"api-reference/core/#findentity_type-typet-criteria-str-max_results-int-0-listt","title":"<code>find(entity_type: Type[T], criteria: str = \"\", max_results: int = 0) -&gt; list[T]</code>","text":"<p>Busca entidades.</p> Python<pre><code># Busca simples\npartners = wrapper.find(Partner, \"CODPARC &gt; 0\")\n\n# Com limite\npartners = wrapper.find(Partner, \"ATIVO = 'S'\", max_results=100)\n</code></pre>"},{"location":"api-reference/core/#updateentity-entitybase-entitybase","title":"<code>update(entity: EntityBase) -&gt; EntityBase</code>","text":"<p>Atualiza uma entidade.</p> Python<pre><code>partner.email = \"novo@email.com\"\nupdated = wrapper.update(partner)\n</code></pre>"},{"location":"api-reference/core/#insertentity-entitybase-entitybase","title":"<code>insert(entity: EntityBase) -&gt; EntityBase</code>","text":"<p>Insere uma nova entidade.</p> Python<pre><code>partner = Partner()\npartner.name = \"Novo Parceiro\"\ncreated = wrapper.insert(partner)\n</code></pre>"},{"location":"api-reference/core/#removeentity-entitybase-bool","title":"<code>remove(entity: EntityBase) -&gt; bool</code>","text":"<p>Remove uma entidade.</p> Python<pre><code>success = wrapper.remove(partner)\n</code></pre>"},{"location":"api-reference/core/#metodos-de-servico","title":"M\u00e9todos de Servi\u00e7o","text":""},{"location":"api-reference/core/#invoke_serviceservice_name-str-request-servicerequest-serviceresponse","title":"<code>invoke_service(service_name: str, request: ServiceRequest) -&gt; ServiceResponse</code>","text":"<p>Invoca um servi\u00e7o da API.</p> Python<pre><code>request = ServiceRequest(service_name=\"ServiceName\")\nresponse = wrapper.invoke_service(\"ServiceName\", request)\n</code></pre>"},{"location":"api-reference/core/#metodos-de-arquivo","title":"M\u00e9todos de Arquivo","text":""},{"location":"api-reference/core/#get_filefilename-str-bytes","title":"<code>get_file(filename: str) -&gt; bytes</code>","text":"<p>Baixa um arquivo.</p> Python<pre><code>content = wrapper.get_file(\"relatorio.pdf\")\nwith open(\"relatorio.pdf\", \"wb\") as f:\n    f.write(content)\n</code></pre>"},{"location":"api-reference/core/#get_imageprimary_key-dict-entity_name-str-produto-bytes","title":"<code>get_image(primary_key: dict, entity_name: str = \"Produto\") -&gt; bytes</code>","text":"<p>Baixa uma imagem de entidade.</p> Python<pre><code>image = wrapper.get_image({\"CODPROD\": 100}, \"Produto\")\n</code></pre>"},{"location":"api-reference/core/#sankhyasettings","title":"SankhyaSettings","text":"<p>Configura\u00e7\u00f5es do SDK.</p>"},{"location":"api-reference/core/#uso-basico_2","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk.core.settings import SankhyaSettings\n\n# A partir de vari\u00e1veis de ambiente\nsettings = SankhyaSettings()\n\n# Expl\u00edcito\nsettings = SankhyaSettings(\n    base_url=\"https://api.sankhya.com.br\",\n    username=\"usuario\",\n    password=\"senha\",\n    environment=\"producao\"\n)\n</code></pre>"},{"location":"api-reference/core/#propriedades_1","title":"Propriedades","text":"Propriedade Tipo Padr\u00e3o Descri\u00e7\u00e3o <code>base_url</code> <code>str</code> (obrigat\u00f3rio) URL base da API <code>username</code> <code>str</code> (obrigat\u00f3rio) Nome de usu\u00e1rio <code>password</code> <code>str</code> (obrigat\u00f3rio) Senha <code>environment</code> <code>str</code> <code>\"producao\"</code> Ambiente (producao/homologacao/treinamento) <code>timeout</code> <code>int</code> <code>30</code> Timeout em segundos <code>max_retries</code> <code>int</code> <code>3</code> M\u00e1ximo de tentativas <code>log_level</code> <code>str</code> <code>\"INFO\"</code> N\u00edvel de logging"},{"location":"api-reference/core/#variaveis-de-ambiente","title":"Vari\u00e1veis de Ambiente","text":"Vari\u00e1vel Corresponde a <code>SANKHYA_BASE_URL</code> <code>base_url</code> <code>SANKHYA_USERNAME</code> <code>username</code> <code>SANKHYA_PASSWORD</code> <code>password</code> <code>SANKHYA_ENVIRONMENT</code> <code>environment</code> <code>SANKHYA_TIMEOUT</code> <code>timeout</code> <code>SANKHYA_MAX_RETRIES</code> <code>max_retries</code> <code>SANKHYA_LOG_LEVEL</code> <code>log_level</code>"},{"location":"api-reference/core/#metodos","title":"M\u00e9todos","text":""},{"location":"api-reference/core/#from_key_filepath-str-passphrase-str-sankhyasettings","title":"<code>from_key_file(path: str, passphrase: str) -&gt; SankhyaSettings</code>","text":"<p>Carrega configura\u00e7\u00f5es de arquivo .key.</p> Python<pre><code>settings = SankhyaSettings.from_key_file(\"credenciais.key\", \"senha_secreta\")\n</code></pre>"},{"location":"api-reference/core/#to_key_filepath-str-passphrase-str-none","title":"<code>to_key_file(path: str, passphrase: str) -&gt; None</code>","text":"<p>Salva configura\u00e7\u00f5es em arquivo .key.</p> Python<pre><code>settings.to_key_file(\"credenciais.key\", \"senha_secreta\")\n</code></pre>"},{"location":"api-reference/core/#lowlevelsankhyawrapper","title":"LowLevelSankhyaWrapper","text":"<p>Cliente de baixo n\u00edvel para comunica\u00e7\u00e3o HTTP/XML.</p> <p>Uso Avan\u00e7ado</p> <p>Use apenas quando precisar de controle total sobre requisi\u00e7\u00f5es.</p>"},{"location":"api-reference/core/#metodos_1","title":"M\u00e9todos","text":""},{"location":"api-reference/core/#posturl-str-data-str-headers-dict-none-none-str","title":"<code>post(url: str, data: str, headers: dict | None = None) -&gt; str</code>","text":"<p>Envia requisi\u00e7\u00e3o POST.</p> Python<pre><code>xml_response = low_level.post(\"/mge/service.sbr\", xml_request)\n</code></pre>"},{"location":"api-reference/core/#geturl-str-headers-dict-none-none-bytes","title":"<code>get(url: str, headers: dict | None = None) -&gt; bytes</code>","text":"<p>Envia requisi\u00e7\u00e3o GET.</p> Python<pre><code>content = low_level.get(\"/mge/file.sbr?file=relatorio.pdf\")\n</code></pre>"},{"location":"api-reference/core/#serialize_requestrequest-servicerequest-str","title":"<code>serialize_request(request: ServiceRequest) -&gt; str</code>","text":"<p>Serializa requisi\u00e7\u00e3o para XML.</p> Python<pre><code>xml = low_level.serialize_request(request)\n</code></pre>"},{"location":"api-reference/core/#deserialize_responsexml-str-serviceresponse","title":"<code>deserialize_response(xml: str) -&gt; ServiceResponse</code>","text":"<p>Deserializa resposta XML.</p> Python<pre><code>response = low_level.deserialize_response(xml_string)\n</code></pre>"},{"location":"api-reference/enums/","title":"Enumera\u00e7\u00f5es","text":"<p>Documenta\u00e7\u00e3o das enumera\u00e7\u00f5es (enums) dispon\u00edveis no SDK.</p>"},{"location":"api-reference/enums/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O SDK define enums para representar valores fixos da API Sankhya:</p> Python<pre><code>from sankhya_sdk.enums import (\n    EnvironmentType,\n    PartnerType,\n    ProductStatus,\n    InvoiceStatus,\n    OperationType,\n    # ... e mais\n)\n</code></pre>"},{"location":"api-reference/enums/#sistema-de-metadados","title":"Sistema de Metadados","text":"<p>Cada enum possui metadados que facilitam convers\u00f5es:</p> Python<pre><code>from sankhya_sdk.enums import PartnerType\n\n# Valor interno (usado na API)\nprint(PartnerType.CLIENT.internal_value)  # \"C\"\n\n# Descri\u00e7\u00e3o amig\u00e1vel\nprint(PartnerType.CLIENT.description)  # \"Cliente\"\n\n# A partir de valor interno\npartner_type = PartnerType.from_internal_value(\"C\")\nprint(partner_type)  # PartnerType.CLIENT\n</code></pre>"},{"location":"api-reference/enums/#enums-de-ambiente","title":"Enums de Ambiente","text":""},{"location":"api-reference/enums/#environmenttype","title":"EnvironmentType","text":"<p>Tipos de ambiente da API.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>PRODUCTION</code> <code>\"producao\"</code> Produ\u00e7\u00e3o <code>HOMOLOGATION</code> <code>\"homologacao\"</code> Homologa\u00e7\u00e3o <code>TRAINING</code> <code>\"treinamento\"</code> Treinamento Python<pre><code>from sankhya_sdk.enums import EnvironmentType\n\nenv = EnvironmentType.PRODUCTION\nprint(env.database_name)  # \"SANKHYA_PRODUCAO\"\n</code></pre>"},{"location":"api-reference/enums/#enums-de-parceiro","title":"Enums de Parceiro","text":""},{"location":"api-reference/enums/#partnertype","title":"PartnerType","text":"<p>Tipos de parceiro (cliente/fornecedor).</p> Membro Valor Interno Descri\u00e7\u00e3o <code>CLIENT</code> <code>\"C\"</code> Cliente <code>SUPPLIER</code> <code>\"F\"</code> Fornecedor <code>BOTH</code> <code>\"A\"</code> Ambos (cliente e fornecedor) <code>CARRIER</code> <code>\"T\"</code> Transportadora <code>EMPLOYEE</code> <code>\"E\"</code> Funcion\u00e1rio Python<pre><code>from sankhya_sdk.enums import PartnerType\n\n# Criar parceiro como cliente\npartner.type_partner = PartnerType.CLIENT.internal_value\n</code></pre>"},{"location":"api-reference/enums/#partnersituation","title":"PartnerSituation","text":"<p>Situa\u00e7\u00e3o do parceiro.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>ACTIVE</code> <code>\"A\"</code> Ativo <code>INACTIVE</code> <code>\"I\"</code> Inativo <code>PENDING</code> <code>\"P\"</code> Pendente"},{"location":"api-reference/enums/#enums-de-produto","title":"Enums de Produto","text":""},{"location":"api-reference/enums/#productstatus","title":"ProductStatus","text":"<p>Status de produto.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>ACTIVE</code> <code>\"A\"</code> Ativo <code>INACTIVE</code> <code>\"I\"</code> Inativo <code>BLOCKED</code> <code>\"B\"</code> Bloqueado"},{"location":"api-reference/enums/#producttype","title":"ProductType","text":"<p>Tipos de produto.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>FINISHED</code> <code>\"P\"</code> Produto Acabado <code>RAW_MATERIAL</code> <code>\"M\"</code> Mat\u00e9ria-prima <code>SERVICE</code> <code>\"S\"</code> Servi\u00e7o <code>ASSET</code> <code>\"I\"</code> Ativo Imobilizado <code>RESALE</code> <code>\"R\"</code> Revenda"},{"location":"api-reference/enums/#enums-de-nota-fiscal","title":"Enums de Nota Fiscal","text":""},{"location":"api-reference/enums/#invoicestatus","title":"InvoiceStatus","text":"<p>Status de nota fiscal.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>PENDING</code> <code>\"P\"</code> Pendente <code>APPROVED</code> <code>\"A\"</code> Aprovada <code>CANCELLED</code> <code>\"C\"</code> Cancelada <code>BILLED</code> <code>\"F\"</code> Faturada <code>DENIED</code> <code>\"N\"</code> Negada"},{"location":"api-reference/enums/#invoicetype","title":"InvoiceType","text":"<p>Tipos de nota fiscal.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>ENTRY</code> <code>\"E\"</code> Entrada <code>EXIT</code> <code>\"S\"</code> Sa\u00edda"},{"location":"api-reference/enums/#movementtype","title":"MovementType","text":"<p>Tipos de movimenta\u00e7\u00e3o.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>SALE</code> <code>\"V\"</code> Venda <code>PURCHASE</code> <code>\"C\"</code> Compra <code>TRANSFER</code> <code>\"T\"</code> Transfer\u00eancia <code>RETURN</code> <code>\"D\"</code> Devolu\u00e7\u00e3o"},{"location":"api-reference/enums/#enums-de-operacao","title":"Enums de Opera\u00e7\u00e3o","text":""},{"location":"api-reference/enums/#operationtype","title":"OperationType","text":"<p>Tipos de opera\u00e7\u00e3o CRUD.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>FIND</code> <code>\"loadRecords\"</code> Busca <code>INSERT</code> <code>\"saveRecord\"</code> Inser\u00e7\u00e3o <code>UPDATE</code> <code>\"saveRecord\"</code> Atualiza\u00e7\u00e3o <code>DELETE</code> <code>\"removeRecord\"</code> Exclus\u00e3o"},{"location":"api-reference/enums/#crudoperationtype","title":"CRUDOperationType","text":"<p>Tipos de opera\u00e7\u00e3o para wrapper simples.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>READ</code> <code>\"R\"</code> Leitura <code>CREATE</code> <code>\"C\"</code> Cria\u00e7\u00e3o <code>UPDATE</code> <code>\"U\"</code> Atualiza\u00e7\u00e3o <code>DELETE</code> <code>\"D\"</code> Exclus\u00e3o"},{"location":"api-reference/enums/#enums-de-servico","title":"Enums de Servi\u00e7o","text":""},{"location":"api-reference/enums/#servicestatus","title":"ServiceStatus","text":"<p>Status de resposta de servi\u00e7o.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>SUCCESS</code> <code>\"1\"</code> Sucesso <code>ERROR</code> <code>\"0\"</code> Erro <code>WARNING</code> <code>\"2\"</code> Aviso"},{"location":"api-reference/enums/#messagetype","title":"MessageType","text":"<p>Tipos de mensagem de status.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>ERROR</code> <code>\"E\"</code> Erro <code>WARNING</code> <code>\"W\"</code> Aviso <code>INFO</code> <code>\"I\"</code> Informa\u00e7\u00e3o <code>SUCCESS</code> <code>\"S\"</code> Sucesso"},{"location":"api-reference/enums/#enums-de-servicos-especificos","title":"Enums de Servi\u00e7os Espec\u00edficos","text":""},{"location":"api-reference/enums/#billingtype","title":"BillingType","text":"<p>Tipos de faturamento.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>INVOICE</code> <code>\"NF\"</code> Nota Fiscal <code>ORDER</code> <code>\"PD\"</code> Pedido <code>CONTRACT</code> <code>\"CT\"</code> Contrato"},{"location":"api-reference/enums/#nfeeventtype","title":"NFeEventType","text":"<p>Tipos de evento NFe.</p> Membro Valor Interno Descri\u00e7\u00e3o <code>CANCELLATION</code> <code>\"110111\"</code> Cancelamento <code>CORRECTION</code> <code>\"110110\"</code> Carta de Corre\u00e7\u00e3o <code>MANIFESTATION</code> <code>\"210200\"</code> Manifesta\u00e7\u00e3o"},{"location":"api-reference/enums/#criando-enums-customizados","title":"Criando Enums Customizados","text":"<p>Para criar enums customizados compat\u00edveis com o SDK:</p> Python<pre><code>from sankhya_sdk.enums.base import SankhyaEnum, EnumMetadata\n\nclass MeuStatus(SankhyaEnum):\n    \"\"\"Status customizado.\"\"\"\n\n    ATIVO = EnumMetadata(\"A\", \"Ativo\")\n    INATIVO = EnumMetadata(\"I\", \"Inativo\")\n    PENDENTE = EnumMetadata(\"P\", \"Pendente\")\n\n    def __init__(self, metadata: EnumMetadata):\n        self._internal_value = metadata.internal_value\n        self._description = metadata.description\n\n    @property\n    def internal_value(self) -&gt; str:\n        return self._internal_value\n\n    @property\n    def description(self) -&gt; str:\n        return self._description\n\n    @classmethod\n    def from_internal_value(cls, value: str) -&gt; \"MeuStatus\":\n        for member in cls:\n            if member.internal_value == value:\n                return member\n        raise ValueError(f\"Valor n\u00e3o encontrado: {value}\")\n</code></pre>"},{"location":"api-reference/enums/#uso-em-entidades","title":"Uso em Entidades","text":"Python<pre><code>from sankhya_sdk.transport_entities import Partner\nfrom sankhya_sdk.enums import PartnerType\n\n# Usando enum em entidade\npartner = Partner()\npartner.type_partner = PartnerType.CLIENT.internal_value\n\n# Convertendo de volta\npartner_type = PartnerType.from_internal_value(partner.type_partner)\nprint(partner_type.description)  # \"Cliente\"\n</code></pre>"},{"location":"api-reference/enums/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Exce\u00e7\u00f5es - Hierarquia de exce\u00e7\u00f5es</li> <li>Modelos - Modelos de servi\u00e7o</li> <li>Core - Classes principais</li> </ul>"},{"location":"api-reference/exceptions/","title":"Exce\u00e7\u00f5es","text":"<p>Documenta\u00e7\u00e3o completa das exce\u00e7\u00f5es do SDK.</p>"},{"location":"api-reference/exceptions/#hierarquia","title":"Hierarquia","text":"<pre><code>classDiagram\n    Exception &lt;|-- SankhyaException\n    SankhyaException &lt;|-- ServiceRequestException\n    SankhyaException &lt;|-- InvalidKeyFileException\n    SankhyaException &lt;|-- OperationException\n    SankhyaException &lt;|-- PagedRequestException\n    ServiceRequestException &lt;|-- ServiceRequestInvalidAuthorizationException\n    ServiceRequestException &lt;|-- ServiceRequestCompetitionException\n    ServiceRequestException &lt;|-- ServiceRequestDeadlockException</code></pre>"},{"location":"api-reference/exceptions/#importacao","title":"Importa\u00e7\u00e3o","text":"Python<pre><code>from sankhya_sdk.exceptions import (\n    SankhyaException,\n    ServiceRequestException,\n    ServiceRequestInvalidAuthorizationException,\n    ServiceRequestCompetitionException,\n    ServiceRequestDeadlockException,\n    InvalidKeyFileException,\n    OperationException,\n    PagedRequestException,\n)\n</code></pre>"},{"location":"api-reference/exceptions/#sankhyaexception","title":"SankhyaException","text":"<p>Classe base para todas as exce\u00e7\u00f5es do SDK.</p>"},{"location":"api-reference/exceptions/#atributos","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>message</code> <code>str</code> Mensagem de erro <code>inner_exception</code> <code>Exception \\| None</code> Exce\u00e7\u00e3o interna/causa"},{"location":"api-reference/exceptions/#uso","title":"Uso","text":"Python<pre><code>from sankhya_sdk.exceptions import SankhyaException\n\ntry:\n    # opera\u00e7\u00e3o\nexcept SankhyaException as e:\n    print(f\"Erro: {e.message}\")\n    if e.inner_exception:\n        print(f\"Causa: {e.inner_exception}\")\n</code></pre>"},{"location":"api-reference/exceptions/#servicerequestexception","title":"ServiceRequestException","text":"<p>Erro durante comunica\u00e7\u00e3o com a API.</p>"},{"location":"api-reference/exceptions/#atributos_1","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>message</code> <code>str</code> Mensagem de erro <code>status_message</code> <code>str</code> Mensagem de status da API <code>status_code</code> <code>int</code> C\u00f3digo de status <code>service_name</code> <code>str</code> Nome do servi\u00e7o chamado"},{"location":"api-reference/exceptions/#uso_1","title":"Uso","text":"Python<pre><code>from sankhya_sdk.exceptions import ServiceRequestException\n\ntry:\n    result = wrapper.find(Partner, \"CODPARC &gt; 0\")\nexcept ServiceRequestException as e:\n    print(f\"Servi\u00e7o: {e.service_name}\")\n    print(f\"Status: {e.status_code}\")\n    print(f\"Mensagem: {e.status_message}\")\n</code></pre>"},{"location":"api-reference/exceptions/#servicerequestinvalidauthorizationexception","title":"ServiceRequestInvalidAuthorizationException","text":"<p>Credenciais inv\u00e1lidas ou sess\u00e3o n\u00e3o autorizada.</p>"},{"location":"api-reference/exceptions/#atributos_2","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>message</code> <code>str</code> Mensagem de erro <code>username</code> <code>str</code> Nome de usu\u00e1rio utilizado"},{"location":"api-reference/exceptions/#uso_2","title":"Uso","text":"Python<pre><code>from sankhya_sdk.exceptions import ServiceRequestInvalidAuthorizationException\n\ntry:\n    ctx = SankhyaContext.from_settings()\nexcept ServiceRequestInvalidAuthorizationException as e:\n    print(f\"Usu\u00e1rio inv\u00e1lido: {e.username}\")\n    # N\u00e3o adianta retry - credenciais erradas\n</code></pre>"},{"location":"api-reference/exceptions/#quando-ocorre","title":"Quando Ocorre","text":"<ul> <li>Usu\u00e1rio ou senha incorretos</li> <li>Usu\u00e1rio sem permiss\u00e3o para API</li> <li>Token de sess\u00e3o expirado e n\u00e3o renov\u00e1vel</li> </ul>"},{"location":"api-reference/exceptions/#servicerequestcompetitionexception","title":"ServiceRequestCompetitionException","text":"<p>Erro de concorr\u00eancia/lock no recurso.</p>"},{"location":"api-reference/exceptions/#atributos_3","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>message</code> <code>str</code> Mensagem de erro <code>retry_after</code> <code>int</code> Segundos para aguardar antes de retry"},{"location":"api-reference/exceptions/#uso_3","title":"Uso","text":"Python<pre><code>from sankhya_sdk.exceptions import ServiceRequestCompetitionException\nimport time\n\ntry:\n    crud.update(entity)\nexcept ServiceRequestCompetitionException as e:\n    print(f\"Recurso bloqueado, retry em: {e.retry_after}s\")\n    time.sleep(e.retry_after)\n    crud.update(entity)  # Tentar novamente\n</code></pre>"},{"location":"api-reference/exceptions/#quando-ocorre_1","title":"Quando Ocorre","text":"<ul> <li>Outro processo est\u00e1 editando o mesmo registro</li> <li>Lock de tabela ativo</li> <li>Transa\u00e7\u00e3o bloqueante em andamento</li> </ul>"},{"location":"api-reference/exceptions/#servicerequestdeadlockexception","title":"ServiceRequestDeadlockException","text":"<p>Deadlock detectado no banco de dados.</p>"},{"location":"api-reference/exceptions/#atributos_4","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>message</code> <code>str</code> Mensagem de erro <code>transaction_id</code> <code>str</code> ID da transa\u00e7\u00e3o envolvida"},{"location":"api-reference/exceptions/#uso_4","title":"Uso","text":"Python<pre><code>from sankhya_sdk.exceptions import ServiceRequestDeadlockException\n\ntry:\n    crud.update(entity)\nexcept ServiceRequestDeadlockException as e:\n    print(f\"Deadlock na transa\u00e7\u00e3o: {e.transaction_id}\")\n    # SDK normalmente faz retry autom\u00e1tico\n</code></pre>"},{"location":"api-reference/exceptions/#quando-ocorre_2","title":"Quando Ocorre","text":"<ul> <li>Duas ou mais transa\u00e7\u00f5es aguardando recursos uma da outra</li> <li>Atualiza\u00e7\u00e3o massiva conflitante</li> </ul>"},{"location":"api-reference/exceptions/#invalidkeyfileexception","title":"InvalidKeyFileException","text":"<p>Erro ao processar arquivo .key de credenciais.</p>"},{"location":"api-reference/exceptions/#atributos_5","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>message</code> <code>str</code> Mensagem de erro <code>file_path</code> <code>str</code> Caminho do arquivo"},{"location":"api-reference/exceptions/#uso_5","title":"Uso","text":"Python<pre><code>from sankhya_sdk.exceptions import InvalidKeyFileException\n\ntry:\n    settings = SankhyaSettings.from_key_file(\"credenciais.key\", \"senha\")\nexcept InvalidKeyFileException as e:\n    print(f\"Erro no arquivo: {e.file_path}\")\n    print(f\"Motivo: {e.message}\")\n</code></pre>"},{"location":"api-reference/exceptions/#quando-ocorre_3","title":"Quando Ocorre","text":"<ul> <li>Arquivo n\u00e3o encontrado</li> <li>Formato inv\u00e1lido</li> <li>Senha incorreta para descriptografia</li> <li>Arquivo corrompido</li> </ul>"},{"location":"api-reference/exceptions/#operationexception","title":"OperationException","text":"<p>Erro durante opera\u00e7\u00e3o em entidade.</p>"},{"location":"api-reference/exceptions/#atributos_6","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>message</code> <code>str</code> Mensagem de erro <code>operation</code> <code>str</code> Tipo de opera\u00e7\u00e3o (find, update, etc.) <code>entity_type</code> <code>type</code> Tipo da entidade envolvida"},{"location":"api-reference/exceptions/#uso_6","title":"Uso","text":"Python<pre><code>from sankhya_sdk.exceptions import OperationException\n\ntry:\n    crud.insert(partner)\nexcept OperationException as e:\n    print(f\"Opera\u00e7\u00e3o: {e.operation}\")\n    print(f\"Entidade: {e.entity_type.__name__}\")\n    print(f\"Erro: {e.message}\")\n</code></pre>"},{"location":"api-reference/exceptions/#quando-ocorre_4","title":"Quando Ocorre","text":"<ul> <li>Valida\u00e7\u00e3o de entidade falhou</li> <li>Opera\u00e7\u00e3o n\u00e3o permitida</li> <li>Regra de neg\u00f3cio violada</li> </ul>"},{"location":"api-reference/exceptions/#pagedrequestexception","title":"PagedRequestException","text":"<p>Erro durante opera\u00e7\u00e3o paginada.</p>"},{"location":"api-reference/exceptions/#atributos_7","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>message</code> <code>str</code> Mensagem de erro <code>page_number</code> <code>int</code> N\u00famero da p\u00e1gina com erro <code>total_pages</code> <code>int</code> Total de p\u00e1ginas esperado"},{"location":"api-reference/exceptions/#uso_7","title":"Uso","text":"Python<pre><code>from sankhya_sdk.exceptions import PagedRequestException\n\ntry:\n    for partner in paged.get_paged_results(Partner):\n        process(partner)\nexcept PagedRequestException as e:\n    print(f\"Erro na p\u00e1gina {e.page_number}/{e.total_pages}\")\n    print(f\"Motivo: {e.message}\")\n</code></pre>"},{"location":"api-reference/exceptions/#quando-ocorre_5","title":"Quando Ocorre","text":"<ul> <li>Timeout ao carregar p\u00e1gina</li> <li>Erro de comunica\u00e7\u00e3o durante pagina\u00e7\u00e3o</li> <li>Sess\u00e3o expirada durante itera\u00e7\u00e3o</li> </ul>"},{"location":"api-reference/exceptions/#padrao-de-tratamento-recomendado","title":"Padr\u00e3o de Tratamento Recomendado","text":"Python<pre><code>from sankhya_sdk.exceptions import (\n    SankhyaException,\n    ServiceRequestException,\n    ServiceRequestInvalidAuthorizationException,\n    ServiceRequestCompetitionException,\n    ServiceRequestDeadlockException,\n    OperationException,\n    PagedRequestException,\n)\n\ntry:\n    # Sua opera\u00e7\u00e3o\n    result = crud.find(Partner, \"CODPARC &gt; 0\")\n\nexcept ServiceRequestInvalidAuthorizationException:\n    # Credenciais incorretas - n\u00e3o adianta retry\n    logging.error(\"Credenciais inv\u00e1lidas\")\n    raise\n\nexcept ServiceRequestCompetitionException as e:\n    # Concorr\u00eancia - pode tentar novamente\n    logging.warning(f\"Recurso bloqueado, aguardando {e.retry_after}s\")\n    time.sleep(e.retry_after)\n    result = crud.find(Partner, \"CODPARC &gt; 0\")\n\nexcept ServiceRequestDeadlockException:\n    # Deadlock - SDK deve fazer retry autom\u00e1tico\n    # Se chegou aqui, esgotou tentativas\n    logging.error(\"Deadlock persistente\")\n    raise\n\nexcept ServiceRequestException as e:\n    # Outros erros de comunica\u00e7\u00e3o\n    logging.error(f\"Erro API: {e.status_message}\")\n    raise\n\nexcept OperationException as e:\n    # Erro de opera\u00e7\u00e3o (valida\u00e7\u00e3o, regra de neg\u00f3cio)\n    logging.error(f\"Erro de opera\u00e7\u00e3o: {e.message}\")\n    raise\n\nexcept SankhyaException as e:\n    # Qualquer outro erro do SDK\n    logging.error(f\"Erro SDK: {e.message}\")\n    raise\n\nexcept Exception as e:\n    # Erros inesperados\n    logging.exception(f\"Erro inesperado: {e}\")\n    raise\n</code></pre>"},{"location":"api-reference/exceptions/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Tratamento de Erros - Estrat\u00e9gias avan\u00e7adas</li> <li>Request Helpers - Configura\u00e7\u00e3o de retry</li> <li>Core - Classes principais</li> </ul>"},{"location":"api-reference/helpers/","title":"Helpers","text":"<p>Documenta\u00e7\u00e3o dos utilit\u00e1rios e extens\u00f5es do SDK.</p>"},{"location":"api-reference/helpers/#visao-geral","title":"Vis\u00e3o Geral","text":"Python<pre><code>from sankhya_sdk.helpers import (\n    EntityExtensions,\n    EntityQueryOptions,\n    FilterExpression,\n    StatusMessageHelper,\n    ServiceRequestExtensions,\n)\n</code></pre>"},{"location":"api-reference/helpers/#entityqueryoptions","title":"EntityQueryOptions","text":"<p>Op\u00e7\u00f5es para consultas de entidades.</p>"},{"location":"api-reference/helpers/#uso","title":"Uso","text":"Python<pre><code>from sankhya_sdk.helpers import EntityQueryOptions\n\noptions = EntityQueryOptions(\n    include_fields=[\"CODPARC\", \"NOMEPARC\", \"CGC_CPF\"],\n    exclude_fields=[\"SENHA\"],\n    order_by=\"NOMEPARC ASC\",\n    max_results=100,\n    include_references=True\n)\n\npartners = crud.find_with_options(Partner, \"ATIVO = 'S'\", options)\n</code></pre>"},{"location":"api-reference/helpers/#atributos","title":"Atributos","text":"Atributo Tipo Padr\u00e3o Descri\u00e7\u00e3o <code>include_fields</code> <code>list[str] \\| None</code> <code>None</code> Campos a incluir <code>exclude_fields</code> <code>list[str] \\| None</code> <code>None</code> Campos a excluir <code>order_by</code> <code>str \\| None</code> <code>None</code> Ordena\u00e7\u00e3o <code>max_results</code> <code>int</code> <code>0</code> Limite de resultados <code>include_references</code> <code>bool</code> <code>False</code> Incluir refer\u00eancias <code>distinct</code> <code>bool</code> <code>False</code> Resultados distintos"},{"location":"api-reference/helpers/#filterexpression","title":"FilterExpression","text":"<p>Construtor fluente de filtros.</p>"},{"location":"api-reference/helpers/#uso-basico","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk.helpers import FilterExpression\n\n# Constru\u00e7\u00e3o fluente\nfilter_expr = (\n    FilterExpression()\n    .equals(\"CODPARC\", 1)\n    .and_()\n    .greater_than(\"VLRNOTA\", 1000)\n)\n\ncriteria = filter_expr.build()\n# \"CODPARC = 1 AND VLRNOTA &gt; 1000\"\n</code></pre>"},{"location":"api-reference/helpers/#metodos-de-comparacao","title":"M\u00e9todos de Compara\u00e7\u00e3o","text":""},{"location":"api-reference/helpers/#equalsfield-value-filterexpression","title":"<code>equals(field, value) -&gt; FilterExpression</code>","text":"<p>Igualdade.</p> Python<pre><code>filter_expr.equals(\"CODPARC\", 1)\n# CODPARC = 1\n</code></pre>"},{"location":"api-reference/helpers/#not_equalsfield-value-filterexpression","title":"<code>not_equals(field, value) -&gt; FilterExpression</code>","text":"<p>Diferen\u00e7a.</p> Python<pre><code>filter_expr.not_equals(\"STATUS\", \"C\")\n# STATUS &lt;&gt; 'C'\n</code></pre>"},{"location":"api-reference/helpers/#greater_thanfield-value-filterexpression","title":"<code>greater_than(field, value) -&gt; FilterExpression</code>","text":"<p>Maior que.</p> Python<pre><code>filter_expr.greater_than(\"VLRNOTA\", 1000)\n# VLRNOTA &gt; 1000\n</code></pre>"},{"location":"api-reference/helpers/#greater_or_equalfield-value-filterexpression","title":"<code>greater_or_equal(field, value) -&gt; FilterExpression</code>","text":"<p>Maior ou igual.</p> Python<pre><code>filter_expr.greater_or_equal(\"DTMOV\", date(2024, 1, 1))\n# DTMOV &gt;= '01/01/2024'\n</code></pre>"},{"location":"api-reference/helpers/#less_thanfield-value-filterexpression","title":"<code>less_than(field, value) -&gt; FilterExpression</code>","text":"<p>Menor que.</p> Python<pre><code>filter_expr.less_than(\"ESTOQUE\", 10)\n# ESTOQUE &lt; 10\n</code></pre>"},{"location":"api-reference/helpers/#less_or_equalfield-value-filterexpression","title":"<code>less_or_equal(field, value) -&gt; FilterExpression</code>","text":"<p>Menor ou igual.</p> Python<pre><code>filter_expr.less_or_equal(\"VLRDESC\", 100)\n# VLRDESC &lt;= 100\n</code></pre>"},{"location":"api-reference/helpers/#likefield-pattern-filterexpression","title":"<code>like(field, pattern) -&gt; FilterExpression</code>","text":"<p>Padr\u00e3o LIKE.</p> Python<pre><code>filter_expr.like(\"NOMEPARC\", \"%LTDA%\")\n# NOMEPARC LIKE '%LTDA%'\n</code></pre>"},{"location":"api-reference/helpers/#in_field-values-filterexpression","title":"<code>in_(field, values) -&gt; FilterExpression</code>","text":"<p>Lista de valores.</p> Python<pre><code>filter_expr.in_(\"CODPARC\", [1, 2, 3])\n# CODPARC IN (1, 2, 3)\n</code></pre>"},{"location":"api-reference/helpers/#betweenfield-start-end-filterexpression","title":"<code>between(field, start, end) -&gt; FilterExpression</code>","text":"<p>Intervalo.</p> Python<pre><code>filter_expr.between(\"DTMOV\", date(2024, 1, 1), date(2024, 12, 31))\n# DTMOV BETWEEN '01/01/2024' AND '31/12/2024'\n</code></pre>"},{"location":"api-reference/helpers/#is_nullfield-filterexpression","title":"<code>is_null(field) -&gt; FilterExpression</code>","text":"<p>Valor nulo.</p> Python<pre><code>filter_expr.is_null(\"EMAIL\")\n# EMAIL IS NULL\n</code></pre>"},{"location":"api-reference/helpers/#is_not_nullfield-filterexpression","title":"<code>is_not_null(field) -&gt; FilterExpression</code>","text":"<p>Valor n\u00e3o nulo.</p> Python<pre><code>filter_expr.is_not_null(\"CGC_CPF\")\n# CGC_CPF IS NOT NULL\n</code></pre>"},{"location":"api-reference/helpers/#metodos-logicos","title":"M\u00e9todos L\u00f3gicos","text":""},{"location":"api-reference/helpers/#and_-filterexpression","title":"<code>and_() -&gt; FilterExpression</code>","text":"<p>Operador AND.</p> Python<pre><code>filter_expr.equals(\"A\", 1).and_().equals(\"B\", 2)\n# A = 1 AND B = 2\n</code></pre>"},{"location":"api-reference/helpers/#or_-filterexpression","title":"<code>or_() -&gt; FilterExpression</code>","text":"<p>Operador OR.</p> Python<pre><code>filter_expr.equals(\"A\", 1).or_().equals(\"B\", 2)\n# A = 1 OR B = 2\n</code></pre>"},{"location":"api-reference/helpers/#group_start-filterexpression","title":"<code>group_start() -&gt; FilterExpression</code>","text":"<p>Inicia grupo.</p> Python<pre><code>filter_expr.group_start().equals(\"A\", 1).or_().equals(\"B\", 2).group_end()\n# (A = 1 OR B = 2)\n</code></pre>"},{"location":"api-reference/helpers/#group_end-filterexpression","title":"<code>group_end() -&gt; FilterExpression</code>","text":"<p>Finaliza grupo.</p>"},{"location":"api-reference/helpers/#exemplo-complexo","title":"Exemplo Complexo","text":"Python<pre><code>filter_expr = (\n    FilterExpression()\n    .equals(\"ATIVO\", \"S\")\n    .and_()\n    .group_start()\n        .equals(\"TIPPESSOA\", \"C\")\n        .or_()\n        .equals(\"TIPPESSOA\", \"A\")\n    .group_end()\n    .and_()\n    .greater_than(\"VLRNOTA\", 1000)\n    .and_()\n    .like(\"NOMEPARC\", \"%LTDA%\")\n)\n\n# ATIVO = 'S' AND (TIPPESSOA = 'C' OR TIPPESSOA = 'A') AND VLRNOTA &gt; 1000 AND NOMEPARC LIKE '%LTDA%'\n</code></pre>"},{"location":"api-reference/helpers/#entityextensions","title":"EntityExtensions","text":"<p>Utilit\u00e1rios para manipula\u00e7\u00e3o de entidades.</p>"},{"location":"api-reference/helpers/#metodos","title":"M\u00e9todos","text":""},{"location":"api-reference/helpers/#extract_keysentity-dict","title":"<code>extract_keys(entity) -&gt; dict</code>","text":"<p>Extrai valores das chaves.</p> Python<pre><code>from sankhya_sdk.helpers import EntityExtensions\n\npartner = Partner()\npartner.code_partner = 1\n\nkeys = EntityExtensions.extract_keys(partner)\n# {\"CODPARC\": 1}\n</code></pre>"},{"location":"api-reference/helpers/#is_update_operationentity-bool","title":"<code>is_update_operation(entity) -&gt; bool</code>","text":"<p>Verifica se \u00e9 atualiza\u00e7\u00e3o.</p> Python<pre><code>is_update = EntityExtensions.is_update_operation(partner)\n# True se entidade tem chaves preenchidas\n</code></pre>"},{"location":"api-reference/helpers/#cloneentity-entitybase","title":"<code>clone(entity) -&gt; EntityBase</code>","text":"<p>Clona uma entidade.</p> Python<pre><code>cloned = EntityExtensions.clone(partner)\n</code></pre>"},{"location":"api-reference/helpers/#get_changed_fieldsoriginal-modified-liststr","title":"<code>get_changed_fields(original, modified) -&gt; list[str]</code>","text":"<p>Lista campos alterados.</p> Python<pre><code>changes = EntityExtensions.get_changed_fields(original, modified)\n# [\"email\", \"phone\"]\n</code></pre>"},{"location":"api-reference/helpers/#statusmessagehelper","title":"StatusMessageHelper","text":"<p>Utilit\u00e1rio para interpretar mensagens de status.</p>"},{"location":"api-reference/helpers/#uso_1","title":"Uso","text":"Python<pre><code>from sankhya_sdk.helpers import StatusMessageHelper\n\nmessage = \"E|100|Registro n\u00e3o encontrado|Detalhes adicionais\"\nparsed = StatusMessageHelper.parse(message)\n\nprint(parsed.type)      # \"ERROR\"\nprint(parsed.code)      # \"100\"\nprint(parsed.message)   # \"Registro n\u00e3o encontrado\"\nprint(parsed.details)   # \"Detalhes adicionais\"\n</code></pre>"},{"location":"api-reference/helpers/#estrutura-parsed","title":"Estrutura Parsed","text":"Atributo Tipo Descri\u00e7\u00e3o <code>type</code> <code>str</code> Tipo (ERROR/WARNING/INFO) <code>code</code> <code>str</code> C\u00f3digo interno <code>message</code> <code>str</code> Mensagem principal <code>details</code> <code>str \\| None</code> Detalhes adicionais"},{"location":"api-reference/helpers/#metodos_1","title":"M\u00e9todos","text":""},{"location":"api-reference/helpers/#is_errormessage-bool","title":"<code>is_error(message) -&gt; bool</code>","text":"<p>Verifica se \u00e9 erro.</p> Python<pre><code>if StatusMessageHelper.is_error(status_message):\n    handle_error()\n</code></pre>"},{"location":"api-reference/helpers/#is_warningmessage-bool","title":"<code>is_warning(message) -&gt; bool</code>","text":"<p>Verifica se \u00e9 aviso.</p> Python<pre><code>if StatusMessageHelper.is_warning(status_message):\n    log_warning()\n</code></pre>"},{"location":"api-reference/helpers/#servicerequestextensions","title":"ServiceRequestExtensions","text":"<p>Utilit\u00e1rios para requisi\u00e7\u00f5es.</p>"},{"location":"api-reference/helpers/#metodos_2","title":"M\u00e9todos","text":""},{"location":"api-reference/helpers/#apply_options_to_requestrequest-options-servicerequest","title":"<code>apply_options_to_request(request, options) -&gt; ServiceRequest</code>","text":"<p>Aplica op\u00e7\u00f5es a uma requisi\u00e7\u00e3o.</p> Python<pre><code>from sankhya_sdk.helpers import ServiceRequestExtensions, EntityQueryOptions\n\noptions = EntityQueryOptions(max_results=100)\nrequest = ServiceRequestExtensions.apply_options_to_request(request, options)\n</code></pre>"},{"location":"api-reference/helpers/#build_criteria_requestentity_type-criteria-servicerequest","title":"<code>build_criteria_request(entity_type, criteria) -&gt; ServiceRequest</code>","text":"<p>Constr\u00f3i requisi\u00e7\u00e3o de busca.</p> Python<pre><code>request = ServiceRequestExtensions.build_criteria_request(\n    Partner,\n    \"CODPARC &gt; 0\"\n)\n</code></pre>"},{"location":"api-reference/helpers/#genericserviceentity","title":"GenericServiceEntity","text":"<p>Entidade gen\u00e9rica para servi\u00e7os.</p>"},{"location":"api-reference/helpers/#uso_2","title":"Uso","text":"Python<pre><code>from sankhya_sdk.helpers import GenericServiceEntity\n\n# Para chamadas de servi\u00e7o gen\u00e9ricas\nentity = GenericServiceEntity(\"MeuServico\")\nentity.set_field(\"CAMPO1\", \"valor1\")\nentity.set_field(\"CAMPO2\", 123)\n\nxml = entity.to_xml()\n</code></pre>"},{"location":"api-reference/helpers/#entitydynamicserialization","title":"EntityDynamicSerialization","text":"<p>Serializa\u00e7\u00e3o din\u00e2mica de entidades.</p>"},{"location":"api-reference/helpers/#metodos_3","title":"M\u00e9todos","text":""},{"location":"api-reference/helpers/#serializeentity-element","title":"<code>serialize(entity) -&gt; Element</code>","text":"<p>Serializa entidade para XML.</p> Python<pre><code>from sankhya_sdk.helpers import EntityDynamicSerialization\n\nxml = EntityDynamicSerialization.serialize(partner)\n</code></pre>"},{"location":"api-reference/helpers/#deserializexml-entity_type-entitybase","title":"<code>deserialize(xml, entity_type) -&gt; EntityBase</code>","text":"<p>Deserializa XML para entidade.</p> Python<pre><code>partner = EntityDynamicSerialization.deserialize(xml, Partner)\n</code></pre>"},{"location":"api-reference/helpers/#serialize_listentities-element","title":"<code>serialize_list(entities) -&gt; Element</code>","text":"<p>Serializa lista de entidades.</p> Python<pre><code>xml = EntityDynamicSerialization.serialize_list(partners)\n</code></pre>"},{"location":"api-reference/helpers/#deserialize_listxml-entity_type-listentitybase","title":"<code>deserialize_list(xml, entity_type) -&gt; list[EntityBase]</code>","text":"<p>Deserializa lista de entidades.</p> Python<pre><code>partners = EntityDynamicSerialization.deserialize_list(xml, Partner)\n</code></pre>"},{"location":"api-reference/helpers/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Valida\u00e7\u00f5es - Valida\u00e7\u00e3o de entidades</li> <li>Request Wrappers - Wrappers de opera\u00e7\u00e3o</li> <li>Exemplos - Exemplos pr\u00e1ticos</li> </ul>"},{"location":"api-reference/models/","title":"Modelos","text":"<p>Documenta\u00e7\u00e3o dos modelos de servi\u00e7o e entidades de transporte.</p>"},{"location":"api-reference/models/#modelos-de-servico","title":"Modelos de Servi\u00e7o","text":""},{"location":"api-reference/models/#servicerequest","title":"ServiceRequest","text":"<p>Modelo para requisi\u00e7\u00f5es \u00e0 API.</p> Python<pre><code>from sankhya_sdk.service_models import ServiceRequest\n\nrequest = ServiceRequest(\n    service_name=\"CRUDServiceProvider.loadRecords\",\n    request_body=RequestBody(\n        entity_name=\"Parceiro\",\n        criteria=\"CODPARC &gt; 0\"\n    )\n)\n</code></pre>"},{"location":"api-reference/models/#atributos","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>service_name</code> <code>str</code> Nome do servi\u00e7o <code>request_body</code> <code>RequestBody</code> Corpo da requisi\u00e7\u00e3o <code>output_type</code> <code>str \\| None</code> Tipo de sa\u00edda esperado <code>no_auth</code> <code>bool</code> Se n\u00e3o requer autentica\u00e7\u00e3o"},{"location":"api-reference/models/#serviceresponse","title":"ServiceResponse","text":"<p>Modelo para respostas da API.</p> Python<pre><code>from sankhya_sdk.service_models import ServiceResponse\n\n# T\u00edpico: retornado pelo wrapper\nresponse = wrapper.invoke_service(\"ServiceName\", request)\n\nif response.is_success:\n    entities = response.entities\nelse:\n    print(f\"Erro: {response.status_message}\")\n</code></pre>"},{"location":"api-reference/models/#atributos_1","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>status</code> <code>str</code> Status da resposta (\"1\" = sucesso) <code>status_message</code> <code>str \\| None</code> Mensagem de status <code>response_body</code> <code>ResponseBody</code> Corpo da resposta <code>entities</code> <code>list[EntityBase]</code> Entidades retornadas"},{"location":"api-reference/models/#propriedades","title":"Propriedades","text":"Propriedade Tipo Descri\u00e7\u00e3o <code>is_success</code> <code>bool</code> Se a requisi\u00e7\u00e3o foi bem-sucedida <code>has_entities</code> <code>bool</code> Se h\u00e1 entidades na resposta <code>entity_count</code> <code>int</code> Quantidade de entidades"},{"location":"api-reference/models/#requestbody","title":"RequestBody","text":"<p>Corpo da requisi\u00e7\u00e3o.</p> Python<pre><code>from sankhya_sdk.service_models import RequestBody\n\nbody = RequestBody(\n    entity_name=\"Parceiro\",\n    criteria=\"CODPARC &gt; 0 AND ATIVO = 'S'\",\n    fields=[\"CODPARC\", \"NOMEPARC\", \"CGC_CPF\"],\n    order_by=\"NOMEPARC\",\n    max_results=100\n)\n</code></pre>"},{"location":"api-reference/models/#atributos_2","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>entity_name</code> <code>str</code> Nome da entidade <code>criteria</code> <code>str \\| None</code> Crit\u00e9rio de busca (SQL-like) <code>fields</code> <code>list[str] \\| None</code> Campos a retornar <code>order_by</code> <code>str \\| None</code> Ordena\u00e7\u00e3o <code>max_results</code> <code>int \\| None</code> Limite de resultados <code>include_references</code> <code>bool</code> Incluir refer\u00eancias"},{"location":"api-reference/models/#responsebody","title":"ResponseBody","text":"<p>Corpo da resposta.</p>"},{"location":"api-reference/models/#atributos_3","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>rows</code> <code>list[dict]</code> Linhas de dados <code>total_records</code> <code>int</code> Total de registros <code>page_count</code> <code>int</code> N\u00famero de p\u00e1ginas"},{"location":"api-reference/models/#entidades-de-transporte","title":"Entidades de Transporte","text":""},{"location":"api-reference/models/#entitybase","title":"EntityBase","text":"<p>Classe base abstrata para todas as entidades.</p> Python<pre><code>from sankhya_sdk.transport_entities import EntityBase\n\nclass MinhaEntidade(EntityBase):\n    # Implementa\u00e7\u00e3o customizada\n    pass\n</code></pre>"},{"location":"api-reference/models/#metodos","title":"M\u00e9todos","text":"M\u00e9todo Retorno Descri\u00e7\u00e3o <code>to_xml()</code> <code>Element</code> Serializa para XML <code>from_xml(xml)</code> <code>Self</code> Deserializa de XML <code>validate()</code> <code>list[ValidationError]</code> Valida a entidade <code>get_key_values()</code> <code>dict</code> Retorna valores das chaves"},{"location":"api-reference/models/#partner-parceiro","title":"Partner (Parceiro)","text":"<p>Representa clientes, fornecedores e outros parceiros.</p> Python<pre><code>from sankhya_sdk.transport_entities import Partner\n\npartner = Partner()\npartner.code_partner = 1\npartner.name = \"Cliente LTDA\"\npartner.cgc_cpf = \"12345678000199\"\npartner.type_partner = \"C\"  # Cliente\n</code></pre>"},{"location":"api-reference/models/#campos","title":"Campos","text":"Campo Tipo API Descri\u00e7\u00e3o <code>code_partner</code> <code>int</code> <code>CODPARC</code> C\u00f3digo (chave) <code>name</code> <code>str</code> <code>NOMEPARC</code> Nome/Raz\u00e3o Social <code>cgc_cpf</code> <code>str \\| None</code> <code>CGC_CPF</code> CNPJ ou CPF <code>type_partner</code> <code>str</code> <code>TIPPESSOA</code> Tipo (C/F/A/T/E) <code>email</code> <code>str \\| None</code> <code>EMAIL</code> E-mail <code>phone</code> <code>str \\| None</code> <code>TELEFONE</code> Telefone <code>address</code> <code>str \\| None</code> <code>ENDERECO</code> Endere\u00e7o <code>city</code> <code>str \\| None</code> <code>CIDADE</code> Cidade <code>state</code> <code>str \\| None</code> <code>UF</code> Estado (UF) <code>zip_code</code> <code>str \\| None</code> <code>CEP</code> CEP <code>active</code> <code>bool</code> <code>ATIVO</code> Ativo"},{"location":"api-reference/models/#product-produto","title":"Product (Produto)","text":"<p>Representa produtos e servi\u00e7os.</p> Python<pre><code>from sankhya_sdk.transport_entities import Product\n\nproduct = Product()\nproduct.code_product = 100\nproduct.description = \"Produto Exemplo\"\nproduct.unit = \"UN\"\nproduct.active = True\n</code></pre>"},{"location":"api-reference/models/#campos_1","title":"Campos","text":"Campo Tipo API Descri\u00e7\u00e3o <code>code_product</code> <code>int</code> <code>CODPROD</code> C\u00f3digo (chave) <code>description</code> <code>str</code> <code>DESCRPROD</code> Descri\u00e7\u00e3o <code>unit</code> <code>str</code> <code>CODVOL</code> Unidade <code>reference</code> <code>str \\| None</code> <code>REFERENCIA</code> Refer\u00eancia <code>ncm</code> <code>str \\| None</code> <code>NCM</code> C\u00f3digo NCM <code>sale_price</code> <code>Decimal \\| None</code> <code>VLRVENDA</code> Pre\u00e7o de venda <code>cost_price</code> <code>Decimal \\| None</code> <code>VLRCUSTO</code> Pre\u00e7o de custo <code>stock_quantity</code> <code>Decimal \\| None</code> <code>ESTOQUE</code> Quantidade em estoque <code>active</code> <code>bool</code> <code>ATIVO</code> Ativo"},{"location":"api-reference/models/#invoiceheader-cabecalho-de-nota-fiscal","title":"InvoiceHeader (Cabe\u00e7alho de Nota Fiscal)","text":"<p>Representa o cabe\u00e7alho de notas fiscais.</p> Python<pre><code>from sankhya_sdk.transport_entities import InvoiceHeader\nfrom datetime import date\n\nheader = InvoiceHeader()\nheader.single_number = 12345\nheader.code_partner = 1\nheader.movement_date = date.today()\nheader.code_company = 1\nheader.code_operation_type = 1001\n</code></pre>"},{"location":"api-reference/models/#campos_2","title":"Campos","text":"Campo Tipo API Descri\u00e7\u00e3o <code>single_number</code> <code>int</code> <code>NUNOTA</code> N\u00famero \u00fanico (chave) <code>code_partner</code> <code>int</code> <code>CODPARC</code> C\u00f3digo do parceiro <code>code_company</code> <code>int</code> <code>CODEMP</code> C\u00f3digo da empresa <code>code_operation_type</code> <code>int</code> <code>CODTIPOPER</code> Tipo de opera\u00e7\u00e3o <code>movement_date</code> <code>date</code> <code>DTMOV</code> Data de movimento <code>movement_time</code> <code>timedelta \\| None</code> <code>HRMOV</code> Hora de movimento <code>invoice_number</code> <code>int \\| None</code> <code>NUMNOTA</code> N\u00famero da NF <code>series</code> <code>str \\| None</code> <code>SERIENOTA</code> S\u00e9rie da NF <code>total_value</code> <code>Decimal \\| None</code> <code>VLRNOTA</code> Valor total <code>status</code> <code>str</code> <code>STATUSNOTA</code> Status <code>pending</code> <code>bool</code> <code>PENDENTE</code> Pendente <code>confirmed</code> <code>bool</code> <code>CONFIRMADA</code> Confirmada"},{"location":"api-reference/models/#invoiceitem-item-de-nota-fiscal","title":"InvoiceItem (Item de Nota Fiscal)","text":"<p>Representa itens de notas fiscais.</p> Python<pre><code>from sankhya_sdk.transport_entities import InvoiceItem\n\nitem = InvoiceItem()\nitem.single_number = 12345\nitem.sequence = 1\nitem.code_product = 100\nitem.quantity = 10\nitem.unit_value = Decimal(\"99.90\")\n</code></pre>"},{"location":"api-reference/models/#campos_3","title":"Campos","text":"Campo Tipo API Descri\u00e7\u00e3o <code>single_number</code> <code>int</code> <code>NUNOTA</code> N\u00famero \u00fanico (chave) <code>sequence</code> <code>int</code> <code>SEQUENCIA</code> Sequ\u00eancia (chave) <code>code_product</code> <code>int</code> <code>CODPROD</code> C\u00f3digo do produto <code>quantity</code> <code>Decimal</code> <code>QTDNEG</code> Quantidade <code>unit_value</code> <code>Decimal</code> <code>VLRUNIT</code> Valor unit\u00e1rio <code>total_value</code> <code>Decimal \\| None</code> <code>VLRTOT</code> Valor total <code>discount</code> <code>Decimal \\| None</code> <code>VLRDESC</code> Desconto"},{"location":"api-reference/models/#value-objects","title":"Value Objects","text":""},{"location":"api-reference/models/#filterexpression","title":"FilterExpression","text":"<p>Express\u00e3o de filtro para queries.</p> Python<pre><code>from sankhya_sdk.helpers import FilterExpression\n\n# Constru\u00e7\u00e3o fluente\nfilter_expr = (\n    FilterExpression()\n    .equals(\"CODPARC\", 1)\n    .and_()\n    .greater_than(\"VLRNOTA\", 1000)\n    .and_()\n    .like(\"NOMEPARC\", \"%LTDA%\")\n)\n\ncriteria = filter_expr.build()\n# \"CODPARC = 1 AND VLRNOTA &gt; 1000 AND NOMEPARC LIKE '%LTDA%'\"\n</code></pre>"},{"location":"api-reference/models/#entityqueryoptions","title":"EntityQueryOptions","text":"<p>Op\u00e7\u00f5es para consultas de entidades.</p> Python<pre><code>from sankhya_sdk.helpers import EntityQueryOptions\n\noptions = EntityQueryOptions(\n    include_fields=[\"CODPARC\", \"NOMEPARC\"],\n    order_by=\"NOMEPARC ASC\",\n    max_results=100,\n    include_references=True\n)\n</code></pre>"},{"location":"api-reference/models/#criando-entidades-customizadas","title":"Criando Entidades Customizadas","text":"Python<pre><code>from sankhya_sdk.attributes import entity, entity_key, entity_element\nfrom sankhya_sdk.transport_entities import EntityBase\n\n@entity(\"Contato\", \"AD_CONTATO\")\nclass Contato(EntityBase):\n    \"\"\"Entidade customizada para contatos.\"\"\"\n\n    @entity_key(\"IDCONTATO\")\n    id_contato: int\n\n    @entity_element(\"CODPARC\")\n    code_partner: int\n\n    @entity_element(\"NOME\")\n    nome: str\n\n    @entity_element(\"EMAIL\", required=False)\n    email: str | None = None\n\n    @entity_element(\"TELEFONE\", required=False)\n    telefone: str | None = None\n</code></pre>"},{"location":"api-reference/models/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Request Wrappers - Wrappers de opera\u00e7\u00e3o</li> <li>Sistema de Entidades - Cria\u00e7\u00e3o de entidades</li> <li>Helpers - Utilit\u00e1rios</li> </ul>"},{"location":"api-reference/request-wrappers/","title":"Request Wrappers","text":"<p>Documenta\u00e7\u00e3o dos wrappers de alto n\u00edvel para opera\u00e7\u00f5es com a API.</p>"},{"location":"api-reference/request-wrappers/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Os Request Wrappers abstraem opera\u00e7\u00f5es complexas em interfaces simples:</p> Wrapper Uso <code>SimpleCRUDRequestWrapper</code> Opera\u00e7\u00f5es CRUD b\u00e1sicas <code>PagedRequestWrapper</code> Consultas paginadas <code>OnDemandRequestWrapper</code> Processamento em lote <code>KnowServicesRequestWrapper</code> Servi\u00e7os espec\u00edficos Python<pre><code>from sankhya_sdk.request_wrappers import (\n    SimpleCRUDRequestWrapper,\n    PagedRequestWrapper,\n    OnDemandRequestWrapper,\n    KnowServicesRequestWrapper,\n)\n</code></pre>"},{"location":"api-reference/request-wrappers/#simplecrudrequestwrapper","title":"SimpleCRUDRequestWrapper","text":"<p>Wrapper para opera\u00e7\u00f5es CRUD b\u00e1sicas.</p>"},{"location":"api-reference/request-wrappers/#uso-basico","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Find\n    partners = crud.find(Partner, \"CODPARC &gt; 0\", max_results=10)\n\n    # Update\n    partner = partners[0]\n    partner.email = \"novo@email.com\"\n    crud.update(partner)\n\n    # Insert\n    new_partner = Partner()\n    new_partner.name = \"Novo Cliente\"\n    crud.insert(new_partner)\n\n    # Remove\n    crud.remove(partner)\n</code></pre>"},{"location":"api-reference/request-wrappers/#metodos","title":"M\u00e9todos","text":""},{"location":"api-reference/request-wrappers/#findentity_type-criteria-max_results-listt","title":"<code>find(entity_type, criteria, max_results) -&gt; list[T]</code>","text":"<p>Busca entidades.</p> Python<pre><code>partners = crud.find(Partner, \"ATIVO = 'S'\", max_results=100)\n</code></pre> Par\u00e2metro Tipo Padr\u00e3o Descri\u00e7\u00e3o <code>entity_type</code> <code>Type[T]</code> - Tipo da entidade <code>criteria</code> <code>str</code> <code>\"\"</code> Crit\u00e9rio de busca <code>max_results</code> <code>int</code> <code>0</code> Limite (0 = sem limite)"},{"location":"api-reference/request-wrappers/#find_with_optionsentity_type-criteria-options-listt","title":"<code>find_with_options(entity_type, criteria, options) -&gt; list[T]</code>","text":"<p>Busca com op\u00e7\u00f5es avan\u00e7adas.</p> Python<pre><code>from sankhya_sdk.helpers import EntityQueryOptions\n\noptions = EntityQueryOptions(\n    include_fields=[\"CODPARC\", \"NOMEPARC\"],\n    order_by=\"NOMEPARC\",\n    include_references=True\n)\npartners = crud.find_with_options(Partner, \"ATIVO = 'S'\", options)\n</code></pre>"},{"location":"api-reference/request-wrappers/#updateentity-entitybase","title":"<code>update(entity) -&gt; EntityBase</code>","text":"<p>Atualiza uma entidade.</p> Python<pre><code>partner.email = \"novo@email.com\"\nupdated = crud.update(partner)\n</code></pre>"},{"location":"api-reference/request-wrappers/#insertentity-entitybase","title":"<code>insert(entity) -&gt; EntityBase</code>","text":"<p>Insere nova entidade.</p> Python<pre><code>created = crud.insert(partner)\nprint(created.code_partner)  # C\u00f3digo gerado\n</code></pre>"},{"location":"api-reference/request-wrappers/#removeentity-bool","title":"<code>remove(entity) -&gt; bool</code>","text":"<p>Remove uma entidade.</p> Python<pre><code>success = crud.remove(partner)\n</code></pre>"},{"location":"api-reference/request-wrappers/#pagedrequestwrapper","title":"PagedRequestWrapper","text":"<p>Wrapper para consultas paginadas com grandes volumes de dados.</p>"},{"location":"api-reference/request-wrappers/#uso-basico_1","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk.request_wrappers import PagedRequestWrapper\n\nwith SankhyaContext.from_settings() as ctx:\n    paged = PagedRequestWrapper(ctx.wrapper)\n\n    # Itera sobre resultados paginados\n    for partner in paged.get_paged_results(Partner, \"ATIVO = 'S'\"):\n        print(partner.name)\n</code></pre>"},{"location":"api-reference/request-wrappers/#fluxo-de-paginacao","title":"Fluxo de Pagina\u00e7\u00e3o","text":"<pre><code>flowchart TD\n    A[In\u00edcio] --&gt; B[Carregar P\u00e1gina 1]\n    B --&gt; C[Processar Itens]\n    C --&gt; D{Mais P\u00e1ginas?}\n    D --&gt;|Sim| E[Carregar Pr\u00f3xima]\n    E --&gt; C\n    D --&gt;|N\u00e3o| F[Fim]</code></pre>"},{"location":"api-reference/request-wrappers/#construtor","title":"Construtor","text":"Python<pre><code>paged = PagedRequestWrapper(\n    wrapper=ctx.wrapper,\n    page_size=100,          # Itens por p\u00e1gina\n    max_results=1000,       # Limite total\n    timeout=300,            # Timeout em segundos\n    enable_cache=False      # Cache em mem\u00f3ria\n)\n</code></pre> Par\u00e2metro Tipo Padr\u00e3o Descri\u00e7\u00e3o <code>wrapper</code> <code>SankhyaWrapper</code> - Wrapper para requisi\u00e7\u00f5es <code>page_size</code> <code>int</code> <code>100</code> Itens por p\u00e1gina <code>max_results</code> <code>int</code> <code>0</code> Limite total (0 = sem limite) <code>timeout</code> <code>int</code> <code>300</code> Timeout em segundos <code>enable_cache</code> <code>bool</code> <code>False</code> Habilita cache"},{"location":"api-reference/request-wrappers/#metodos_1","title":"M\u00e9todos","text":""},{"location":"api-reference/request-wrappers/#get_paged_resultsentity_type-criteria-generatort","title":"<code>get_paged_results(entity_type, criteria) -&gt; Generator[T]</code>","text":"<p>Retorna generator para itera\u00e7\u00e3o paginada.</p> Python<pre><code>for partner in paged.get_paged_results(Partner, \"CODPARC &gt; 0\"):\n    process(partner)\n</code></pre>"},{"location":"api-reference/request-wrappers/#get_paged_results_asyncentity_type-criteria-asyncgeneratort","title":"<code>get_paged_results_async(entity_type, criteria) -&gt; AsyncGenerator[T]</code>","text":"<p>Vers\u00e3o ass\u00edncrona.</p> Python<pre><code>async for partner in paged.get_paged_results_async(Partner):\n    await process(partner)\n</code></pre>"},{"location":"api-reference/request-wrappers/#callbacks","title":"Callbacks","text":"Python<pre><code>from sankhya_sdk.value_objects import PagedRequestEventArgs\n\ndef on_page_loaded(args: PagedRequestEventArgs):\n    print(f\"P\u00e1gina {args.current_page}/{args.total_pages}\")\n    print(f\"Itens: {args.items_in_page}\")\n\ndef on_error(args: PagedRequestEventArgs):\n    print(f\"Erro na p\u00e1gina {args.current_page}: {args.error}\")\n\npaged.on_page_loaded = on_page_loaded\npaged.on_error = on_error\n</code></pre>"},{"location":"api-reference/request-wrappers/#ondemandrequestwrapper","title":"OnDemandRequestWrapper","text":"<p>Wrapper para processamento em lote com fila.</p>"},{"location":"api-reference/request-wrappers/#uso-basico_2","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk.request_wrappers import OnDemandRequestWrapper\n\nwith SankhyaContext.from_settings() as ctx:\n    on_demand = OnDemandRequestWrapper(\n        wrapper=ctx.wrapper,\n        throughput=10,  # Itens por lote\n        operation=OperationType.UPDATE\n    )\n\n    # Adiciona itens \u00e0 fila\n    for partner in partners:\n        on_demand.add(partner)\n\n    # Processa fila\n    on_demand.flush()\n</code></pre>"},{"location":"api-reference/request-wrappers/#fluxo-de-processamento","title":"Fluxo de Processamento","text":"<pre><code>flowchart TD\n    A[add item] --&gt; B[Fila]\n    B --&gt; C{Lote cheio?}\n    C --&gt;|Sim| D[Processar Lote]\n    C --&gt;|N\u00e3o| E[Aguardar]\n    E --&gt; B\n    D --&gt; F[Callback]\n    F --&gt; B\n    G[flush] --&gt; H[Processar Fila]\n    H --&gt; I[Fim]</code></pre>"},{"location":"api-reference/request-wrappers/#construtor_1","title":"Construtor","text":"Python<pre><code>on_demand = OnDemandRequestWrapper(\n    wrapper=ctx.wrapper,\n    throughput=10,                    # Itens por lote\n    allow_above_throughput=True,      # Permitir lotes maiores\n    operation=OperationType.UPDATE,   # Tipo de opera\u00e7\u00e3o\n)\n</code></pre>"},{"location":"api-reference/request-wrappers/#metodos_2","title":"M\u00e9todos","text":""},{"location":"api-reference/request-wrappers/#addentity-entitybase-none","title":"<code>add(entity: EntityBase) -&gt; None</code>","text":"<p>Adiciona entidade \u00e0 fila.</p> Python<pre><code>on_demand.add(partner)\n</code></pre>"},{"location":"api-reference/request-wrappers/#flush-none","title":"<code>flush() -&gt; None</code>","text":"<p>Processa todos os itens da fila.</p> Python<pre><code>on_demand.flush()\n</code></pre>"},{"location":"api-reference/request-wrappers/#cancel-none","title":"<code>cancel() -&gt; None</code>","text":"<p>Cancela processamento.</p> Python<pre><code>on_demand.cancel()\n</code></pre>"},{"location":"api-reference/request-wrappers/#callbacks_1","title":"Callbacks","text":"Python<pre><code>def on_batch_processed(entities: list[EntityBase], success: bool):\n    print(f\"Lote processado: {len(entities)} itens, sucesso: {success}\")\n\ndef on_failure(entity: EntityBase, error: Exception):\n    print(f\"Falha em {entity}: {error}\")\n\non_demand.on_batch_processed = on_batch_processed\non_demand.on_failure = on_failure\n</code></pre>"},{"location":"api-reference/request-wrappers/#knowservicesrequestwrapper","title":"KnowServicesRequestWrapper","text":"<p>Wrapper para servi\u00e7os espec\u00edficos (NF-e, faturamento, etc.).</p>"},{"location":"api-reference/request-wrappers/#uso-basico_3","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk.request_wrappers import KnowServicesRequestWrapper\n\nwith SankhyaContext.from_settings() as ctx:\n    services = KnowServicesRequestWrapper(ctx.wrapper)\n\n    # Faturar nota\n    services.bill(single_number=12345, billing_type=BillingType.INVOICE)\n\n    # Confirmar nota\n    services.confirm_invoice(single_number=12345)\n</code></pre>"},{"location":"api-reference/request-wrappers/#metodos-de-sessao","title":"M\u00e9todos de Sess\u00e3o","text":""},{"location":"api-reference/request-wrappers/#keep_alive-none","title":"<code>keep_alive() -&gt; None</code>","text":"<p>Mant\u00e9m sess\u00e3o ativa.</p> Python<pre><code>services.keep_alive()\n</code></pre>"},{"location":"api-reference/request-wrappers/#send_messagemessage-title-recipient_users-none","title":"<code>send_message(message, title, recipient_users) -&gt; None</code>","text":"<p>Envia mensagem interna.</p> Python<pre><code>services.send_message(\n    message=\"Texto da mensagem\",\n    title=\"T\u00edtulo\",\n    recipient_users=[1, 2, 3]\n)\n</code></pre>"},{"location":"api-reference/request-wrappers/#metodos-de-nota-fiscal","title":"M\u00e9todos de Nota Fiscal","text":""},{"location":"api-reference/request-wrappers/#billsingle_number-billing_type-serviceresponse","title":"<code>bill(single_number, billing_type) -&gt; ServiceResponse</code>","text":"<p>Fatura uma nota.</p> Python<pre><code>services.bill(\n    single_number=12345,\n    billing_type=BillingType.INVOICE\n)\n</code></pre>"},{"location":"api-reference/request-wrappers/#confirm_invoicesingle_number-serviceresponse","title":"<code>confirm_invoice(single_number) -&gt; ServiceResponse</code>","text":"<p>Confirma uma nota.</p> Python<pre><code>services.confirm_invoice(single_number=12345)\n</code></pre>"},{"location":"api-reference/request-wrappers/#cancel_invoicesingle_number-justification-serviceresponse","title":"<code>cancel_invoice(single_number, justification) -&gt; ServiceResponse</code>","text":"<p>Cancela uma nota.</p> Python<pre><code>services.cancel_invoice(\n    single_number=12345,\n    justification=\"Motivo do cancelamento\"\n)\n</code></pre>"},{"location":"api-reference/request-wrappers/#duplicate_invoicesingle_number-serviceresponse","title":"<code>duplicate_invoice(single_number) -&gt; ServiceResponse</code>","text":"<p>Duplica uma nota.</p> Python<pre><code>new_note = services.duplicate_invoice(single_number=12345)\n</code></pre>"},{"location":"api-reference/request-wrappers/#metodos-de-nf-e","title":"M\u00e9todos de NF-e","text":""},{"location":"api-reference/request-wrappers/#transmit_nfesingle_number-serviceresponse","title":"<code>transmit_nfe(single_number) -&gt; ServiceResponse</code>","text":"<p>Transmite NF-e para SEFAZ.</p> Python<pre><code>services.transmit_nfe(single_number=12345)\n</code></pre>"},{"location":"api-reference/request-wrappers/#query_nfe_statussingle_number-serviceresponse","title":"<code>query_nfe_status(single_number) -&gt; ServiceResponse</code>","text":"<p>Consulta status da NF-e.</p> Python<pre><code>status = services.query_nfe_status(single_number=12345)\n</code></pre>"},{"location":"api-reference/request-wrappers/#metodos-de-arquivoimagem","title":"M\u00e9todos de Arquivo/Imagem","text":""},{"location":"api-reference/request-wrappers/#get_filefilename-bytes","title":"<code>get_file(filename) -&gt; bytes</code>","text":"<p>Baixa arquivo.</p> Python<pre><code>content = services.get_file(\"relatorio.pdf\")\n</code></pre>"},{"location":"api-reference/request-wrappers/#get_imageprimary_key-entity_name-bytes","title":"<code>get_image(primary_key, entity_name) -&gt; bytes</code>","text":"<p>Baixa imagem de entidade.</p> Python<pre><code>image = services.get_image({\"CODPROD\": 100}, \"Produto\")\n</code></pre>"},{"location":"api-reference/request-wrappers/#async-wrappers","title":"Async Wrappers","text":"<p>Vers\u00f5es ass\u00edncronas dos wrappers principais.</p>"},{"location":"api-reference/request-wrappers/#asyncsimplecrudrequestwrapper","title":"AsyncSimpleCRUDRequestWrapper","text":"Python<pre><code>from sankhya_sdk.request_wrappers import AsyncSimpleCRUDRequestWrapper\n\nasync with AsyncSankhyaContext.from_settings() as ctx:\n    crud = AsyncSimpleCRUDRequestWrapper(ctx.wrapper)\n    partners = await crud.find(Partner, \"CODPARC &gt; 0\")\n</code></pre>"},{"location":"api-reference/request-wrappers/#asyncondemandrequestwrapper","title":"AsyncOnDemandRequestWrapper","text":"Python<pre><code>from sankhya_sdk.request_wrappers import AsyncOnDemandRequestWrapper\n\nasync with AsyncSankhyaContext.from_settings() as ctx:\n    on_demand = AsyncOnDemandRequestWrapper(ctx.wrapper)\n\n    for partner in partners:\n        await on_demand.add(partner)\n\n    await on_demand.flush()\n</code></pre>"},{"location":"api-reference/request-wrappers/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Helpers - Utilit\u00e1rios auxiliares</li> <li>Core - Classes principais</li> <li>Exemplos - Exemplos pr\u00e1ticos</li> </ul>"},{"location":"api-reference/validations/","title":"Valida\u00e7\u00f5es","text":"<p>Documenta\u00e7\u00e3o do sistema de valida\u00e7\u00e3o de entidades.</p>"},{"location":"api-reference/validations/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O SDK inclui um sistema de valida\u00e7\u00e3o para garantir integridade dos dados antes de enviar \u00e0 API:</p> Python<pre><code>from sankhya_sdk.validations import EntityValidator, EntityValidation\n</code></pre>"},{"location":"api-reference/validations/#entityvalidator","title":"EntityValidator","text":"<p>Validador principal de entidades.</p>"},{"location":"api-reference/validations/#uso-basico","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidator\nfrom sankhya_sdk.transport_entities import Partner\n\nvalidator = EntityValidator()\n\npartner = Partner()\npartner.name = \"Cliente\"  # Faltando c\u00f3digo (chave)\n\nresult = validator.validate(partner)\n\nif not result.is_valid:\n    for error in result.errors:\n        print(f\"Campo: {error.field}\")\n        print(f\"Erro: {error.message}\")\n</code></pre>"},{"location":"api-reference/validations/#metodos","title":"M\u00e9todos","text":""},{"location":"api-reference/validations/#validateentity-validationresult","title":"<code>validate(entity) -&gt; ValidationResult</code>","text":"<p>Valida uma entidade.</p> Python<pre><code>result = validator.validate(partner)\n</code></pre>"},{"location":"api-reference/validations/#validate_manyentities-listvalidationresult","title":"<code>validate_many(entities) -&gt; list[ValidationResult]</code>","text":"<p>Valida m\u00faltiplas entidades.</p> Python<pre><code>results = validator.validate_many(partners)\nfor i, result in enumerate(results):\n    if not result.is_valid:\n        print(f\"Entidade {i}: {result.errors}\")\n</code></pre>"},{"location":"api-reference/validations/#validate_for_operationentity-operation-validationresult","title":"<code>validate_for_operation(entity, operation) -&gt; ValidationResult</code>","text":"<p>Valida para opera\u00e7\u00e3o espec\u00edfica.</p> Python<pre><code>from sankhya_sdk.enums import OperationType\n\n# Insert requer mais campos que Update\nresult = validator.validate_for_operation(partner, OperationType.INSERT)\n</code></pre>"},{"location":"api-reference/validations/#regras-de-validacao","title":"Regras de Valida\u00e7\u00e3o","text":"Regra Descri\u00e7\u00e3o Campos obrigat\u00f3rios Verifica se campos <code>required=True</code> est\u00e3o preenchidos Tipos de dados Verifica se tipos est\u00e3o corretos Tamanho m\u00e1ximo Verifica <code>max_length</code> em strings Chaves Verifica se chaves est\u00e3o preenchidas (para update/delete) Refer\u00eancias Valida refer\u00eancias entre entidades"},{"location":"api-reference/validations/#validationresult","title":"ValidationResult","text":"<p>Resultado de uma valida\u00e7\u00e3o.</p>"},{"location":"api-reference/validations/#atributos","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>is_valid</code> <code>bool</code> Se valida\u00e7\u00e3o passou <code>errors</code> <code>list[EntityValidation]</code> Lista de erros <code>warnings</code> <code>list[EntityValidation]</code> Lista de avisos"},{"location":"api-reference/validations/#metodos_1","title":"M\u00e9todos","text":""},{"location":"api-reference/validations/#raise_if_invalid-none","title":"<code>raise_if_invalid() -&gt; None</code>","text":"<p>Lan\u00e7a exce\u00e7\u00e3o se inv\u00e1lido.</p> Python<pre><code>result = validator.validate(partner)\nresult.raise_if_invalid()  # Lan\u00e7a OperationException se inv\u00e1lido\n</code></pre>"},{"location":"api-reference/validations/#to_dict-dict","title":"<code>to_dict() -&gt; dict</code>","text":"<p>Converte para dicion\u00e1rio.</p> Python<pre><code>data = result.to_dict()\n# {\"is_valid\": False, \"errors\": [...], \"warnings\": [...]}\n</code></pre>"},{"location":"api-reference/validations/#entityvalidation","title":"EntityValidation","text":"<p>Representa um erro ou aviso de valida\u00e7\u00e3o.</p>"},{"location":"api-reference/validations/#atributos_1","title":"Atributos","text":"Atributo Tipo Descri\u00e7\u00e3o <code>field</code> <code>str</code> Nome do campo <code>message</code> <code>str</code> Mensagem de erro <code>severity</code> <code>str</code> Severidade (ERROR/WARNING) <code>code</code> <code>str \\| None</code> C\u00f3digo do erro"},{"location":"api-reference/validations/#factory-methods","title":"Factory Methods","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidation\n\n# Erro de campo obrigat\u00f3rio\nerror = EntityValidation.required_field(\"NOMEPARC\", \"Nome do parceiro \u00e9 obrigat\u00f3rio\")\n\n# Erro de tipo\nerror = EntityValidation.invalid_type(\"CODPARC\", \"int\", \"str\")\n\n# Erro de tamanho\nerror = EntityValidation.max_length_exceeded(\"DESCRICAO\", 100, 150)\n\n# Erro customizado\nerror = EntityValidation.custom(\"VALOR\", \"Valor n\u00e3o pode ser negativo\")\n</code></pre>"},{"location":"api-reference/validations/#validacoes-customizadas","title":"Valida\u00e7\u00f5es Customizadas","text":""},{"location":"api-reference/validations/#em-entidades","title":"Em Entidades","text":"<p>Implemente o m\u00e9todo <code>validate</code> na entidade:</p> Python<pre><code>from sankhya_sdk.transport_entities import EntityBase\nfrom sankhya_sdk.validations import EntityValidation\n\nclass MinhaEntidade(EntityBase):\n    @entity_key(\"ID\")\n    id: int\n\n    @entity_element(\"VALOR\")\n    valor: float\n\n    @entity_element(\"DATA_INICIO\")\n    data_inicio: date\n\n    @entity_element(\"DATA_FIM\")\n    data_fim: date\n\n    def validate(self) -&gt; list[EntityValidation]:\n        \"\"\"Valida\u00e7\u00f5es customizadas.\"\"\"\n        errors = super().validate()\n\n        # Valida\u00e7\u00e3o de neg\u00f3cio\n        if self.valor &lt; 0:\n            errors.append(EntityValidation.custom(\n                \"VALOR\",\n                \"Valor n\u00e3o pode ser negativo\"\n            ))\n\n        # Valida\u00e7\u00e3o de intervalo de datas\n        if self.data_fim &lt; self.data_inicio:\n            errors.append(EntityValidation.custom(\n                \"DATA_FIM\",\n                \"Data fim n\u00e3o pode ser anterior \u00e0 data in\u00edcio\"\n            ))\n\n        return errors\n</code></pre>"},{"location":"api-reference/validations/#com-validator-customizado","title":"Com Validator Customizado","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidator, EntityValidation\n\nclass MeuValidator(EntityValidator):\n    \"\"\"Validator com regras adicionais.\"\"\"\n\n    def validate(self, entity) -&gt; ValidationResult:\n        # Valida\u00e7\u00e3o padr\u00e3o\n        result = super().validate(entity)\n\n        # Regras adicionais\n        if isinstance(entity, Partner):\n            self._validate_partner_rules(entity, result)\n\n        return result\n\n    def _validate_partner_rules(self, partner: Partner, result: ValidationResult):\n        # Valida\u00e7\u00e3o de CNPJ/CPF\n        if partner.cgc_cpf and not self._is_valid_cpf_cnpj(partner.cgc_cpf):\n            result.errors.append(EntityValidation.custom(\n                \"CGC_CPF\",\n                \"CPF/CNPJ inv\u00e1lido\"\n            ))\n\n        # Email obrigat\u00f3rio para clientes\n        if partner.type_partner == \"C\" and not partner.email:\n            result.warnings.append(EntityValidation.custom(\n                \"EMAIL\",\n                \"Email recomendado para clientes\",\n                severity=\"WARNING\"\n            ))\n\n    def _is_valid_cpf_cnpj(self, value: str) -&gt; bool:\n        # Implementa\u00e7\u00e3o de valida\u00e7\u00e3o\n        return len(value) in [11, 14]\n</code></pre>"},{"location":"api-reference/validations/#padroes-de-validacao","title":"Padr\u00f5es de Valida\u00e7\u00e3o","text":""},{"location":"api-reference/validations/#validar-antes-de-persistir","title":"Validar Antes de Persistir","text":"Python<pre><code>def save_partner(crud: SimpleCRUDRequestWrapper, partner: Partner):\n    \"\"\"Salva parceiro com valida\u00e7\u00e3o.\"\"\"\n    validator = EntityValidator()\n    result = validator.validate(partner)\n\n    if not result.is_valid:\n        raise ValueError(f\"Parceiro inv\u00e1lido: {result.errors}\")\n\n    if result.warnings:\n        for warning in result.warnings:\n            logging.warning(f\"Aviso: {warning.message}\")\n\n    return crud.insert(partner)\n</code></pre>"},{"location":"api-reference/validations/#validar-em-lote","title":"Validar em Lote","text":"Python<pre><code>def save_partners_batch(crud, partners: list[Partner]):\n    \"\"\"Salva parceiros em lote com valida\u00e7\u00e3o.\"\"\"\n    validator = EntityValidator()\n\n    valid_partners = []\n    invalid_partners = []\n\n    for partner in partners:\n        result = validator.validate(partner)\n        if result.is_valid:\n            valid_partners.append(partner)\n        else:\n            invalid_partners.append((partner, result.errors))\n\n    # Processa v\u00e1lidos\n    for partner in valid_partners:\n        crud.insert(partner)\n\n    # Reporta inv\u00e1lidos\n    if invalid_partners:\n        for partner, errors in invalid_partners:\n            logging.error(f\"Parceiro {partner.name}: {errors}\")\n\n    return len(valid_partners), len(invalid_partners)\n</code></pre>"},{"location":"api-reference/validations/#patterns-de-erro","title":"Patterns de Erro","text":""},{"location":"api-reference/validations/#padroes-de-mensagem","title":"Padr\u00f5es de Mensagem","text":"<p>O SDK usa padr\u00f5es regex para identificar tipos de erro:</p> Python<pre><code>from sankhya_sdk.validations import EntityValidation\n\n# Verifica se \u00e9 erro de propriedade ausente\nif EntityValidation.match_property_name_association(error_text):\n    # Erro de refer\u00eancia/associa\u00e7\u00e3o\n    pass\n\n# Verifica se \u00e9 erro de nome inv\u00e1lido\nif EntityValidation.match_property_name_invalid(error_text):\n    # Erro de nome de propriedade\n    pass\n</code></pre>"},{"location":"api-reference/validations/#integracao-com-formularios","title":"Integra\u00e7\u00e3o com Formul\u00e1rios","text":""},{"location":"api-reference/validations/#exemplo-web","title":"Exemplo Web","text":"Python<pre><code>from flask import request, jsonify\n\n@app.route('/api/partners', methods=['POST'])\ndef create_partner():\n    data = request.json\n\n    partner = Partner()\n    partner.name = data.get('name')\n    partner.cgc_cpf = data.get('cgc_cpf')\n\n    validator = EntityValidator()\n    result = validator.validate(partner)\n\n    if not result.is_valid:\n        return jsonify({\n            'success': False,\n            'errors': [\n                {'field': e.field, 'message': e.message}\n                for e in result.errors\n            ]\n        }), 400\n\n    crud.insert(partner)\n    return jsonify({'success': True, 'id': partner.code_partner})\n</code></pre>"},{"location":"api-reference/validations/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Sistema de Entidades - Cria\u00e7\u00e3o de entidades</li> <li>Tratamento de Erros - Estrat\u00e9gias de erro</li> <li>Exemplos - Exemplos pr\u00e1ticos</li> </ul>"},{"location":"core-concepts/","title":"Conceitos Fundamentais","text":"<p>Esta se\u00e7\u00e3o explica os conceitos fundamentais do Sankhya SDK Python, essenciais para entender como o SDK funciona e como utiliz\u00e1-lo efetivamente.</p>"},{"location":"core-concepts/#topicos","title":"T\u00f3picos","text":"<ul> <li> <p> Arquitetura</p> <p>Entenda a arquitetura em camadas do SDK e como os componentes se integram.</p> <p> Arquitetura</p> </li> <li> <p> Gerenciamento de Sess\u00f5es</p> <p>Aprenda sobre ciclo de vida de sess\u00f5es, concorr\u00eancia e multi-threading.</p> <p> Sess\u00f5es</p> </li> <li> <p> Sistema de Entidades</p> <p>Decoradores, serializa\u00e7\u00e3o XML e cria\u00e7\u00e3o de entidades customizadas.</p> <p> Entidades</p> </li> <li> <p> Tratamento de Erros</p> <p>Hierarquia de exce\u00e7\u00f5es, retry autom\u00e1tico e estrat\u00e9gias de recupera\u00e7\u00e3o.</p> <p> Erros</p> </li> </ul>"},{"location":"core-concepts/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O SDK segue uma arquitetura em camadas que separa responsabilidades:</p> <pre><code>graph TD\n    A[Sua Aplica\u00e7\u00e3o] --&gt; B[Request Wrappers]\n    B --&gt; C[SankhyaContext]\n    C --&gt; D[SankhyaWrapper]\n    D --&gt; E[LowLevelWrapper]\n    E --&gt; F[API Sankhya]\n\n    style A fill:#e1f5fe\n    style B fill:#b3e5fc\n    style C fill:#81d4fa\n    style D fill:#4fc3f7\n    style E fill:#29b6f6\n    style F fill:#03a9f4</code></pre> <p>Cada camada tem uma responsabilidade espec\u00edfica, permitindo flexibilidade e manutenibilidade.</p>"},{"location":"core-concepts/architecture/","title":"Arquitetura","text":"<p>Este documento descreve a arquitetura do Sankhya SDK Python, seus componentes e como eles se integram.</p>"},{"location":"core-concepts/architecture/#visao-geral-da-arquitetura","title":"Vis\u00e3o Geral da Arquitetura","text":"<p>O SDK segue uma arquitetura em camadas, onde cada camada tem responsabilidades bem definidas:</p> <pre><code>graph TD\n    subgraph \"Camada de Aplica\u00e7\u00e3o\"\n        A[Sua Aplica\u00e7\u00e3o]\n    end\n\n    subgraph \"Camada de Alto N\u00edvel\"\n        B[SimpleCRUDRequestWrapper]\n        C[PagedRequestWrapper]\n        D[OnDemandRequestWrapper]\n        E[KnowServicesRequestWrapper]\n    end\n\n    subgraph \"Camada de Contexto\"\n        F[SankhyaContext]\n    end\n\n    subgraph \"Camada de Comunica\u00e7\u00e3o\"\n        G[SankhyaWrapper]\n        H[LowLevelSankhyaWrapper]\n    end\n\n    subgraph \"Camada de Transporte\"\n        I[HTTP/XML]\n    end\n\n    subgraph \"API Externa\"\n        J[API Sankhya]\n    end\n\n    A --&gt; B\n    A --&gt; C\n    A --&gt; D\n    A --&gt; E\n    B --&gt; F\n    C --&gt; F\n    D --&gt; F\n    E --&gt; F\n    F --&gt; G\n    G --&gt; H\n    H --&gt; I\n    I --&gt; J</code></pre>"},{"location":"core-concepts/architecture/#componentes-principais","title":"Componentes Principais","text":""},{"location":"core-concepts/architecture/#1-request-wrappers-camada-de-alto-nivel","title":"1. Request Wrappers (Camada de Alto N\u00edvel)","text":"<p>Abstra\u00e7\u00f5es de alto n\u00edvel que simplificam opera\u00e7\u00f5es comuns:</p> Wrapper Responsabilidade <code>SimpleCRUDRequestWrapper</code> Opera\u00e7\u00f5es CRUD b\u00e1sicas (Find, Insert, Update, Remove) <code>PagedRequestWrapper</code> Consultas paginadas para grandes volumes de dados <code>OnDemandRequestWrapper</code> Processamento em lote com callbacks <code>KnowServicesRequestWrapper</code> Servi\u00e7os espec\u00edficos (NF-e, faturamento, etc.) Python<pre><code>from sankhya_sdk.request_wrappers import (\n    SimpleCRUDRequestWrapper,\n    PagedRequestWrapper,\n    OnDemandRequestWrapper,\n    KnowServicesRequestWrapper,\n)\n</code></pre>"},{"location":"core-concepts/architecture/#2-sankhyacontext-camada-de-contexto","title":"2. SankhyaContext (Camada de Contexto)","text":"<p>Gerenciador central de estado e ciclo de vida:</p> Python<pre><code>from sankhya_sdk import SankhyaContext\n\nwith SankhyaContext.from_settings() as ctx:\n    # ctx gerencia:\n    # - Autentica\u00e7\u00e3o\n    # - Sess\u00f5es\n    # - Wrappers registrados\n    # - Lifecycle (login/logout)\n    pass\n</code></pre> <p>Responsabilidades:</p> <ul> <li>Gerenciamento de sess\u00f5es (\u00fanica e m\u00faltiplas)</li> <li>Registro e descarte de wrappers</li> <li>Context manager para cleanup autom\u00e1tico</li> <li>Invoca\u00e7\u00e3o de servi\u00e7os com tokens espec\u00edficos</li> </ul>"},{"location":"core-concepts/architecture/#3-sankhyawrapper-camada-de-comunicacao","title":"3. SankhyaWrapper (Camada de Comunica\u00e7\u00e3o)","text":"<p>Cliente de alto n\u00edvel para comunica\u00e7\u00e3o com a API:</p> <pre><code>classDiagram\n    class SankhyaWrapper {\n        +login()\n        +logout()\n        +invoke_service(service_name, request)\n        +find(entity_type, criteria)\n        +update(entity)\n        +remove(entity)\n        +insert(entity)\n        +get_file(filename)\n        +get_image(pk)\n    }\n\n    class LowLevelSankhyaWrapper {\n        +post(url, data)\n        +get(url)\n        +serialize_request(request)\n        +deserialize_response(xml)\n    }\n\n    SankhyaWrapper --&gt; LowLevelSankhyaWrapper</code></pre> <p>Responsabilidades:</p> <ul> <li>Serializa\u00e7\u00e3o/deserializa\u00e7\u00e3o XML</li> <li>Retry autom\u00e1tico com backoff exponencial</li> <li>Tratamento de exce\u00e7\u00f5es</li> <li>Gerenciamento de cookies de sess\u00e3o</li> </ul>"},{"location":"core-concepts/architecture/#4-modelos-e-entidades","title":"4. Modelos e Entidades","text":"<pre><code>classDiagram\n    class EntityBase {\n        &lt;&lt;abstract&gt;&gt;\n        +to_xml()\n        +from_xml(xml)\n        +validate()\n    }\n\n    class Partner {\n        +code_partner: int\n        +name: str\n        +cgc_cpf: str\n    }\n\n    class Product {\n        +code_product: int\n        +description: str\n        +unit: str\n    }\n\n    class InvoiceHeader {\n        +single_number: int\n        +code_partner: int\n        +movement_date: date\n    }\n\n    EntityBase &lt;|-- Partner\n    EntityBase &lt;|-- Product\n    EntityBase &lt;|-- InvoiceHeader</code></pre>"},{"location":"core-concepts/architecture/#fluxo-de-dados","title":"Fluxo de Dados","text":""},{"location":"core-concepts/architecture/#requisicao","title":"Requisi\u00e7\u00e3o","text":"<pre><code>sequenceDiagram\n    participant App as Aplica\u00e7\u00e3o\n    participant Wrapper as RequestWrapper\n    participant Ctx as SankhyaContext\n    participant SW as SankhyaWrapper\n    participant LLW as LowLevelWrapper\n    participant API as API Sankhya\n\n    App-&gt;&gt;Wrapper: find(Partner, \"CODPARC &gt; 0\")\n    Wrapper-&gt;&gt;Ctx: get_wrapper()\n    Ctx--&gt;&gt;Wrapper: SankhyaWrapper\n    Wrapper-&gt;&gt;SW: invoke_service(\"CRUDServiceProvider.loadRecords\", request)\n    SW-&gt;&gt;LLW: serialize(request)\n    LLW--&gt;&gt;SW: XML\n    SW-&gt;&gt;LLW: post(url, xml)\n    LLW-&gt;&gt;API: HTTP POST\n    API--&gt;&gt;LLW: XML Response\n    LLW--&gt;&gt;SW: Response\n    SW-&gt;&gt;LLW: deserialize(xml)\n    LLW--&gt;&gt;SW: ServiceResponse\n    SW--&gt;&gt;Wrapper: List[Partner]\n    Wrapper--&gt;&gt;App: List[Partner]</code></pre>"},{"location":"core-concepts/architecture/#tratamento-de-erros","title":"Tratamento de Erros","text":"<pre><code>flowchart TD\n    A[Requisi\u00e7\u00e3o] --&gt; B[Enviar HTTP]\n    B --&gt; C{Sucesso?}\n    C --&gt;|Sim| D[Deserializar]\n    C --&gt;|N\u00e3o| E{Tipo de Erro?}\n\n    E --&gt;|Timeout| F[Retry com Backoff]\n    E --&gt;|Sess\u00e3o Expirada| G[Reautenticar]\n    E --&gt;|Erro de Neg\u00f3cio| H[Lan\u00e7ar Exce\u00e7\u00e3o]\n\n    F --&gt; I{Tentativas &lt; Max?}\n    I --&gt;|Sim| B\n    I --&gt;|N\u00e3o| H\n\n    G --&gt; J[Login]\n    J --&gt; B\n\n    D --&gt; K[Retornar Resultado]\n    H --&gt; L[Propagar Erro]</code></pre>"},{"location":"core-concepts/architecture/#padroes-de-design","title":"Padr\u00f5es de Design","text":""},{"location":"core-concepts/architecture/#1-context-manager","title":"1. Context Manager","text":"<p>O SDK usa context managers para gerenciamento de recursos:</p> Python<pre><code># Padr\u00e3o Python\nwith SankhyaContext.from_settings() as ctx:\n    # Recursos garantidamente liberados\n    pass\n</code></pre>"},{"location":"core-concepts/architecture/#2-factory-pattern","title":"2. Factory Pattern","text":"<p>Cria\u00e7\u00e3o de wrappers e objetos:</p> Python<pre><code># SankhyaContext como factory\nctx = SankhyaContext.from_settings()  # Factory method\ntoken = ctx.acquire_session()          # Factory para sess\u00f5es\n</code></pre>"},{"location":"core-concepts/architecture/#3-strategy-pattern","title":"3. Strategy Pattern","text":"<p>Diferentes estrat\u00e9gias de retry:</p> Python<pre><code>from sankhya_sdk.request_helpers import RequestBehaviorOptions\n\noptions = RequestBehaviorOptions(\n    max_retry_count=5,\n    retry_delay_ms=1000,\n    backoff_multiplier=2.0\n)\n</code></pre>"},{"location":"core-concepts/architecture/#4-decorator-pattern","title":"4. Decorator Pattern","text":"<p>Sistema de decorators para entidades:</p> Python<pre><code>from sankhya_sdk.attributes import entity, entity_key, entity_element\n\n@entity(\"Parceiro\")\nclass Partner:\n    @entity_key(\"CODPARC\")\n    code_partner: int\n\n    @entity_element(\"NOMEPARC\")\n    name: str\n</code></pre>"},{"location":"core-concepts/architecture/#5-observer-pattern","title":"5. Observer Pattern","text":"<p>Callbacks em opera\u00e7\u00f5es paginadas:</p> Python<pre><code>def on_page_loaded(args):\n    print(f\"P\u00e1gina {args.current_page} carregada\")\n\npaged = PagedRequestWrapper(wrapper)\npaged.on_page_loaded += on_page_loaded\n</code></pre>"},{"location":"core-concepts/architecture/#estrutura-de-diretorios","title":"Estrutura de Diret\u00f3rios","text":"Text Only<pre><code>sankhya_sdk/\n\u251c\u2500\u2500 __init__.py              # Exports principais\n\u251c\u2500\u2500 core/\n\u2502   \u251c\u2500\u2500 context.py           # SankhyaContext\n\u2502   \u251c\u2500\u2500 wrapper.py           # SankhyaWrapper\n\u2502   \u251c\u2500\u2500 settings.py          # Configura\u00e7\u00f5es\n\u2502   \u251c\u2500\u2500 constants.py         # Constantes\n\u2502   \u2514\u2500\u2500 types.py             # Tipos base\n\u251c\u2500\u2500 attributes/\n\u2502   \u2514\u2500\u2500 decorators.py        # Decorators de entidades\n\u251c\u2500\u2500 enums/\n\u2502   \u2514\u2500\u2500 __init__.py          # Enumera\u00e7\u00f5es\n\u251c\u2500\u2500 exceptions/\n\u2502   \u2514\u2500\u2500 __init__.py          # Hierarquia de exce\u00e7\u00f5es\n\u251c\u2500\u2500 helpers/\n\u2502   \u251c\u2500\u2500 entity_extensions.py # Utilit\u00e1rios de entidades\n\u2502   \u251c\u2500\u2500 filter_expression.py # Construtor de filtros\n\u2502   \u2514\u2500\u2500 status_message.py    # Mensagens de status\n\u251c\u2500\u2500 request_wrappers/\n\u2502   \u251c\u2500\u2500 simple_crud.py       # CRUD simples\n\u2502   \u251c\u2500\u2500 paged.py             # Pagina\u00e7\u00e3o\n\u2502   \u251c\u2500\u2500 on_demand.py         # Processamento em lote\n\u2502   \u2514\u2500\u2500 know_services.py     # Servi\u00e7os espec\u00edficos\n\u251c\u2500\u2500 service_models/\n\u2502   \u2514\u2500\u2500 __init__.py          # ServiceRequest/Response\n\u251c\u2500\u2500 transport_entities/\n\u2502   \u251c\u2500\u2500 partner.py           # Parceiros\n\u2502   \u251c\u2500\u2500 product.py           # Produtos\n\u2502   \u2514\u2500\u2500 invoice.py           # Notas fiscais\n\u251c\u2500\u2500 validations/\n\u2502   \u251c\u2500\u2500 entity_validator.py  # Validador de entidades\n\u2502   \u2514\u2500\u2500 entity_validation.py # Regras de valida\u00e7\u00e3o\n\u2514\u2500\u2500 value_objects/\n    \u2514\u2500\u2500 __init__.py          # Objetos de valor\n</code></pre>"},{"location":"core-concepts/architecture/#extensibilidade","title":"Extensibilidade","text":""},{"location":"core-concepts/architecture/#criando-entidades-customizadas","title":"Criando Entidades Customizadas","text":"Python<pre><code>from sankhya_sdk.attributes import entity, entity_key, entity_element\nfrom sankhya_sdk.transport_entities import EntityBase\n\n@entity(\"MeuCampo\", \"AD_MEUCAMPO\")\nclass MinhaEntidade(EntityBase):\n    @entity_key(\"IDCAMPO\")\n    id_campo: int\n\n    @entity_element(\"DESCRICAO\")\n    descricao: str\n\n    @entity_element(\"VALOR\", required=False)\n    valor: float = 0.0\n</code></pre>"},{"location":"core-concepts/architecture/#criando-wrappers-customizados","title":"Criando Wrappers Customizados","text":"Python<pre><code>from sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\n\nclass MeuWrapper(SimpleCRUDRequestWrapper):\n    def minha_operacao(self, parametros):\n        # L\u00f3gica customizada\n        return self.wrapper.invoke_service(\n            \"MeuServicoCustomizado\",\n            self._build_request(parametros)\n        )\n</code></pre>"},{"location":"core-concepts/architecture/#consideracoes-de-performance","title":"Considera\u00e7\u00f5es de Performance","text":""},{"location":"core-concepts/architecture/#conexoes-http","title":"Conex\u00f5es HTTP","text":"<ul> <li>Pool de conex\u00f5es gerenciado automaticamente</li> <li>Keep-alive habilitado por padr\u00e3o</li> <li>Timeout configur\u00e1vel</li> </ul>"},{"location":"core-concepts/architecture/#serializacao-xml","title":"Serializa\u00e7\u00e3o XML","text":"<ul> <li>lxml para parsing eficiente</li> <li>Caching de schemas quando poss\u00edvel</li> </ul>"},{"location":"core-concepts/architecture/#grandes-volumes-de-dados","title":"Grandes Volumes de Dados","text":"<ul> <li>Use <code>PagedRequestWrapper</code> para consultas grandes</li> <li>Use <code>OnDemandRequestWrapper</code> para processamento em lote</li> <li>Configure <code>max_results</code> apropriadamente</li> </ul>"},{"location":"core-concepts/architecture/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Gerenciamento de Sess\u00f5es - Detalhes sobre sess\u00f5es</li> <li>Sistema de Entidades - Cria\u00e7\u00e3o de entidades</li> <li>Tratamento de Erros - Estrat\u00e9gias de erro</li> </ul>"},{"location":"core-concepts/entity-system/","title":"Sistema de Entidades","text":"<p>Este documento explica o sistema de entidades do SDK, incluindo decoradores, serializa\u00e7\u00e3o XML e cria\u00e7\u00e3o de entidades customizadas.</p>"},{"location":"core-concepts/entity-system/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O SDK usa um sistema de decoradores para mapear classes Python para entidades da API Sankhya:</p> <pre><code>graph LR\n    A[Classe Python] --&gt; B[\"@entity\"]\n    B --&gt; C[\"@entity_key\"]\n    B --&gt; D[\"@entity_element\"]\n    C --&gt; E[Entidade Serializada]\n    D --&gt; E\n    E --&gt; F[XML para API]</code></pre>"},{"location":"core-concepts/entity-system/#decoradores-principais","title":"Decoradores Principais","text":""},{"location":"core-concepts/entity-system/#entity","title":"@entity","text":"<p>Define uma classe como entidade da API:</p> Python<pre><code>from sankhya_sdk.attributes import entity\n\n@entity(\"Parceiro\", \"TGFPAR\")\nclass Partner:\n    \"\"\"\n    Args:\n        name: Nome l\u00f3gico da entidade na API\n        table_name: Nome da tabela no banco de dados\n    \"\"\"\n    pass\n</code></pre> <p>Par\u00e2metros:</p> Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o <code>name</code> str Sim Nome l\u00f3gico da entidade <code>table_name</code> str N\u00e3o Nome da tabela no banco"},{"location":"core-concepts/entity-system/#entity_key","title":"@entity_key","text":"<p>Define o(s) campo(s) chave da entidade:</p> Python<pre><code>from sankhya_sdk.attributes import entity, entity_key\n\n@entity(\"Parceiro\")\nclass Partner:\n    @entity_key(\"CODPARC\")\n    code_partner: int\n</code></pre> <p>Par\u00e2metros:</p> Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o <code>element_name</code> str Sim Nome do campo na API <code>auto_generated</code> bool N\u00e3o Se \u00e9 gerado automaticamente"},{"location":"core-concepts/entity-system/#entity_element","title":"@entity_element","text":"<p>Define campos regulares da entidade:</p> Python<pre><code>from sankhya_sdk.attributes import entity, entity_key, entity_element\n\n@entity(\"Parceiro\")\nclass Partner:\n    @entity_key(\"CODPARC\")\n    code_partner: int\n\n    @entity_element(\"NOMEPARC\")\n    name: str\n\n    @entity_element(\"CGC_CPF\", required=False)\n    cgc_cpf: str | None = None\n</code></pre> <p>Par\u00e2metros:</p> Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o <code>element_name</code> str Sim Nome do campo na API <code>required</code> bool N\u00e3o Se \u00e9 obrigat\u00f3rio (default: True) <code>read_only</code> bool N\u00e3o Apenas leitura <code>max_length</code> int N\u00e3o Tamanho m\u00e1ximo"},{"location":"core-concepts/entity-system/#entidades-pre-definidas","title":"Entidades Pr\u00e9-definidas","text":"<p>O SDK inclui entidades prontas para uso:</p>"},{"location":"core-concepts/entity-system/#partner-parceiro","title":"Partner (Parceiro)","text":"Python<pre><code>from sankhya_sdk.transport_entities import Partner\n\npartner = Partner()\npartner.code_partner = 1\npartner.name = \"Cliente LTDA\"\npartner.cgc_cpf = \"12345678000199\"\npartner.type_partner = \"C\"  # Cliente\n</code></pre>"},{"location":"core-concepts/entity-system/#product-produto","title":"Product (Produto)","text":"Python<pre><code>from sankhya_sdk.transport_entities import Product\n\nproduct = Product()\nproduct.code_product = 100\nproduct.description = \"Produto Exemplo\"\nproduct.unit = \"UN\"\nproduct.active = True\n</code></pre>"},{"location":"core-concepts/entity-system/#invoiceheader-cabecalho-de-nota-fiscal","title":"InvoiceHeader (Cabe\u00e7alho de Nota Fiscal)","text":"Python<pre><code>from sankhya_sdk.transport_entities import InvoiceHeader\nfrom datetime import date\n\nheader = InvoiceHeader()\nheader.single_number = 12345\nheader.code_partner = 1\nheader.movement_date = date.today()\nheader.code_company = 1\n</code></pre>"},{"location":"core-concepts/entity-system/#criando-entidades-customizadas","title":"Criando Entidades Customizadas","text":""},{"location":"core-concepts/entity-system/#exemplo-basico","title":"Exemplo B\u00e1sico","text":"Python<pre><code>from sankhya_sdk.attributes import entity, entity_key, entity_element\nfrom sankhya_sdk.transport_entities import EntityBase\n\n@entity(\"MeuCampo\", \"AD_MEUCAMPO\")\nclass MinhaEntidade(EntityBase):\n    \"\"\"Entidade customizada para tabela AD_MEUCAMPO.\"\"\"\n\n    @entity_key(\"IDCAMPO\")\n    id_campo: int\n\n    @entity_element(\"DESCRICAO\")\n    descricao: str\n\n    @entity_element(\"VALOR\", required=False)\n    valor: float = 0.0\n\n    @entity_element(\"ATIVO\", required=False)\n    ativo: bool = True\n</code></pre>"},{"location":"core-concepts/entity-system/#exemplo-com-referencias","title":"Exemplo com Refer\u00eancias","text":"Python<pre><code>from sankhya_sdk.attributes import entity, entity_key, entity_element, entity_reference\nfrom sankhya_sdk.transport_entities import EntityBase, Partner\n\n@entity(\"Contato\", \"AD_CONTATO\")\nclass Contato(EntityBase):\n    @entity_key(\"IDCONTATO\")\n    id_contato: int\n\n    @entity_element(\"CODPARC\")\n    code_partner: int\n\n    @entity_element(\"NOME\")\n    nome: str\n\n    @entity_element(\"EMAIL\", required=False)\n    email: str | None = None\n\n    # Refer\u00eancia para entidade Partner\n    @entity_reference(\"Parceiro\", foreign_key=\"CODPARC\")\n    parceiro: Partner | None = None\n</code></pre>"},{"location":"core-concepts/entity-system/#diagrama-de-heranca","title":"Diagrama de Heran\u00e7a","text":"<pre><code>classDiagram\n    class EntityBase {\n        &lt;&lt;abstract&gt;&gt;\n        +to_xml() Element\n        +from_xml(xml) Self\n        +validate() ValidationResult\n        +get_key_values() dict\n    }\n\n    class Partner {\n        +code_partner: int\n        +name: str\n        +cgc_cpf: str\n        +type_partner: str\n    }\n\n    class Product {\n        +code_product: int\n        +description: str\n        +unit: str\n        +active: bool\n    }\n\n    class MinhaEntidade {\n        +id_campo: int\n        +descricao: str\n        +valor: float\n    }\n\n    EntityBase &lt;|-- Partner\n    EntityBase &lt;|-- Product\n    EntityBase &lt;|-- MinhaEntidade</code></pre>"},{"location":"core-concepts/entity-system/#serializacao-xml","title":"Serializa\u00e7\u00e3o XML","text":""},{"location":"core-concepts/entity-system/#entidade-para-xml","title":"Entidade para XML","text":"Python<pre><code>from sankhya_sdk.transport_entities import Partner\n\npartner = Partner()\npartner.code_partner = 1\npartner.name = \"Cliente LTDA\"\n\nxml = partner.to_xml()\nprint(xml)\n</code></pre> <p>Sa\u00edda XML:</p> XML<pre><code>&lt;entity&gt;\n    &lt;field name=\"CODPARC\"&gt;1&lt;/field&gt;\n    &lt;field name=\"NOMEPARC\"&gt;Cliente LTDA&lt;/field&gt;\n&lt;/entity&gt;\n</code></pre>"},{"location":"core-concepts/entity-system/#xml-para-entidade","title":"XML para Entidade","text":"Python<pre><code>from sankhya_sdk.transport_entities import Partner\n\nxml_string = \"\"\"\n&lt;entity&gt;\n    &lt;field name=\"CODPARC\"&gt;1&lt;/field&gt;\n    &lt;field name=\"NOMEPARC\"&gt;Cliente LTDA&lt;/field&gt;\n    &lt;field name=\"CGC_CPF\"&gt;12345678000199&lt;/field&gt;\n&lt;/entity&gt;\n\"\"\"\n\npartner = Partner.from_xml(xml_string)\nprint(partner.name)  # \"Cliente LTDA\"\n</code></pre>"},{"location":"core-concepts/entity-system/#fluxo-de-serializacao","title":"Fluxo de Serializa\u00e7\u00e3o","text":"<pre><code>flowchart TD\n    subgraph \"Python \u2192 API\"\n        A[Objeto Python] --&gt; B[EntityDynamicSerialization]\n        B --&gt; C[Gera XML]\n        C --&gt; D[ServiceRequest]\n        D --&gt; E[API Sankhya]\n    end\n\n    subgraph \"API \u2192 Python\"\n        F[API Sankhya] --&gt; G[ServiceResponse XML]\n        G --&gt; H[EntityDynamicSerialization]\n        H --&gt; I[Deserializa]\n        I --&gt; J[Objeto Python]\n    end</code></pre>"},{"location":"core-concepts/entity-system/#tipos-de-dados-suportados","title":"Tipos de Dados Suportados","text":"Tipo Python Tipo Sankhya Serializa\u00e7\u00e3o <code>int</code> Integer Num\u00e9rico <code>float</code> Decimal Num\u00e9rico com ponto <code>str</code> String Texto <code>bool</code> Boolean \"S\"/\"N\" ou \"1\"/\"0\" <code>date</code> Date \"dd/MM/yyyy\" <code>datetime</code> DateTime \"dd/MM/yyyy HHss\" <code>time</code> Time \"HHss\" <code>timedelta</code> Duration Segundos <code>Decimal</code> BigDecimal Num\u00e9rico preciso"},{"location":"core-concepts/entity-system/#exemplo-com-tipos-complexos","title":"Exemplo com Tipos Complexos","text":"Python<pre><code>from datetime import date, datetime, time\nfrom decimal import Decimal\nfrom sankhya_sdk.attributes import entity, entity_key, entity_element\n\n@entity(\"Lancamento\")\nclass Lancamento(EntityBase):\n    @entity_key(\"NUMLANCAMENTO\")\n    numero: int\n\n    @entity_element(\"DATALANCAMENTO\")\n    data: date\n\n    @entity_element(\"DTHORALANCAMENTO\")\n    data_hora: datetime\n\n    @entity_element(\"HORAENTRADA\")\n    hora_entrada: time\n\n    @entity_element(\"VALOR\")\n    valor: Decimal\n\n    @entity_element(\"ATIVO\")\n    ativo: bool\n</code></pre>"},{"location":"core-concepts/entity-system/#validacoes","title":"Valida\u00e7\u00f5es","text":""},{"location":"core-concepts/entity-system/#validador-de-entidade","title":"Validador de Entidade","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidator\n\npartner = Partner()\npartner.name = \"Cliente\"  # Faltando c\u00f3digo (chave)\n\nvalidator = EntityValidator()\nresult = validator.validate(partner)\n\nif not result.is_valid:\n    for error in result.errors:\n        print(f\"Erro: {error.message}\")\n</code></pre>"},{"location":"core-concepts/entity-system/#validacoes-customizadas","title":"Valida\u00e7\u00f5es Customizadas","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidation\n\nclass MinhaEntidade(EntityBase):\n    @entity_key(\"ID\")\n    id: int\n\n    @entity_element(\"VALOR\")\n    valor: float\n\n    def validate(self) -&gt; list[EntityValidation]:\n        errors = super().validate()\n\n        if self.valor &lt; 0:\n            errors.append(EntityValidation(\n                field=\"valor\",\n                message=\"Valor n\u00e3o pode ser negativo\"\n            ))\n\n        return errors\n</code></pre>"},{"location":"core-concepts/entity-system/#fluxo-de-validacao","title":"Fluxo de Valida\u00e7\u00e3o","text":"<pre><code>flowchart TD\n    A[Entidade] --&gt; B{Campos Obrigat\u00f3rios?}\n    B --&gt;|N\u00e3o| C[Erro: Campo obrigat\u00f3rio]\n    B --&gt;|Sim| D{Tipos Corretos?}\n    D --&gt;|N\u00e3o| E[Erro: Tipo inv\u00e1lido]\n    D --&gt;|Sim| F{Valida\u00e7\u00f5es Custom?}\n    F --&gt;|Erro| G[Erro de Neg\u00f3cio]\n    F --&gt;|OK| H[Entidade V\u00e1lida]</code></pre>"},{"location":"core-concepts/entity-system/#metadados-de-entidade","title":"Metadados de Entidade","text":""},{"location":"core-concepts/entity-system/#acessando-metadados","title":"Acessando Metadados","text":"Python<pre><code>from sankhya_sdk.attributes import get_entity_metadata\n\nmetadata = get_entity_metadata(Partner)\n\nprint(f\"Nome: {metadata.entity_name}\")\nprint(f\"Tabela: {metadata.table_name}\")\nprint(f\"Chaves: {metadata.key_fields}\")\nprint(f\"Campos: {metadata.element_fields}\")\n</code></pre>"},{"location":"core-concepts/entity-system/#estrutura-de-metadados","title":"Estrutura de Metadados","text":"<pre><code>classDiagram\n    class EntityMetadata {\n        +entity_name: str\n        +table_name: str\n        +key_fields: list[FieldMetadata]\n        +element_fields: list[FieldMetadata]\n        +reference_fields: list[ReferenceMetadata]\n        +get_field(name) FieldMetadata\n    }\n\n    class FieldMetadata {\n        +name: str\n        +element_name: str\n        +python_type: type\n        +required: bool\n        +read_only: bool\n        +max_length: int\n    }\n\n    class ReferenceMetadata {\n        +name: str\n        +entity_type: type\n        +foreign_key: str\n        +lazy_load: bool\n    }\n\n    EntityMetadata --&gt; FieldMetadata\n    EntityMetadata --&gt; ReferenceMetadata</code></pre>"},{"location":"core-concepts/entity-system/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"core-concepts/entity-system/#1-use-nomes-descritivos","title":"1. Use Nomes Descritivos","text":"Python<pre><code># \u2705 Bom\n@entity_element(\"NOMEPARC\")\nname: str\n\n# \u274c Evitar\n@entity_element(\"NOMEPARC\")\nnp: str\n</code></pre>"},{"location":"core-concepts/entity-system/#2-documente-entidades-customizadas","title":"2. Documente Entidades Customizadas","text":"Python<pre><code>@entity(\"Contato\", \"AD_CONTATO\")\nclass Contato(EntityBase):\n    \"\"\"\n    Entidade de contatos de parceiros.\n\n    Tabela: AD_CONTATO (customizada)\n\n    Attributes:\n        id_contato: Identificador \u00fanico\n        code_partner: C\u00f3digo do parceiro relacionado\n        nome: Nome do contato\n        email: E-mail do contato (opcional)\n    \"\"\"\n    ...\n</code></pre>"},{"location":"core-concepts/entity-system/#3-use-valores-default-apropriados","title":"3. Use Valores Default Apropriados","text":"Python<pre><code>@entity_element(\"ATIVO\", required=False)\nativo: bool = True  # Default sensato\n\n@entity_element(\"VALOR\", required=False)\nvalor: Decimal = Decimal(\"0.00\")  # Tipo correto\n</code></pre>"},{"location":"core-concepts/entity-system/#4-valide-antes-de-persistir","title":"4. Valide Antes de Persistir","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidator\n\ndef save_entity(entity: EntityBase):\n    validator = EntityValidator()\n    result = validator.validate(entity)\n\n    if not result.is_valid:\n        raise ValueError(f\"Entidade inv\u00e1lida: {result.errors}\")\n\n    return crud.insert(entity)\n</code></pre>"},{"location":"core-concepts/entity-system/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Tratamento de Erros - Estrat\u00e9gias de erro</li> <li>Exemplos: Entidades Customizadas - Exemplos pr\u00e1ticos</li> <li>Refer\u00eancia: Valida\u00e7\u00f5es - API de valida\u00e7\u00e3o</li> </ul>"},{"location":"core-concepts/error-handling/","title":"Tratamento de Erros","text":"<p>Este documento explica a hierarquia de exce\u00e7\u00f5es do SDK, estrat\u00e9gias de retry e boas pr\u00e1ticas de tratamento de erros.</p>"},{"location":"core-concepts/error-handling/#hierarquia-de-excecoes","title":"Hierarquia de Exce\u00e7\u00f5es","text":"<p>O SDK define uma hierarquia clara de exce\u00e7\u00f5es para diferentes tipos de erros:</p> <pre><code>classDiagram\n    class Exception {\n        &lt;&lt;Python Built-in&gt;&gt;\n    }\n\n    class SankhyaException {\n        +message: str\n        +inner_exception: Exception\n    }\n\n    class ServiceRequestException {\n        +status_message: str\n        +status_code: int\n        +service_name: str\n    }\n\n    class ServiceRequestInvalidAuthorizationException {\n        +username: str\n    }\n\n    class ServiceRequestCompetitionException {\n        +retry_after: int\n    }\n\n    class ServiceRequestDeadlockException {\n        +transaction_id: str\n    }\n\n    class InvalidKeyFileException {\n        +file_path: str\n    }\n\n    class OperationException {\n        +operation: str\n        +entity_type: type\n    }\n\n    class PagedRequestException {\n        +page_number: int\n        +total_pages: int\n    }\n\n    Exception &lt;|-- SankhyaException\n    SankhyaException &lt;|-- ServiceRequestException\n    ServiceRequestException &lt;|-- ServiceRequestInvalidAuthorizationException\n    ServiceRequestException &lt;|-- ServiceRequestCompetitionException\n    ServiceRequestException &lt;|-- ServiceRequestDeadlockException\n    SankhyaException &lt;|-- InvalidKeyFileException\n    SankhyaException &lt;|-- OperationException\n    SankhyaException &lt;|-- PagedRequestException</code></pre>"},{"location":"core-concepts/error-handling/#excecoes-principais","title":"Exce\u00e7\u00f5es Principais","text":""},{"location":"core-concepts/error-handling/#sankhyaexception","title":"SankhyaException","text":"<p>Classe base para todas as exce\u00e7\u00f5es do SDK:</p> Python<pre><code>from sankhya_sdk.exceptions import SankhyaException\n\ntry:\n    # opera\u00e7\u00e3o\nexcept SankhyaException as e:\n    print(f\"Erro Sankhya: {e.message}\")\n    if e.inner_exception:\n        print(f\"Causa: {e.inner_exception}\")\n</code></pre>"},{"location":"core-concepts/error-handling/#servicerequestexception","title":"ServiceRequestException","text":"<p>Erro durante comunica\u00e7\u00e3o com a API:</p> Python<pre><code>from sankhya_sdk.exceptions import ServiceRequestException\n\ntry:\n    result = wrapper.find(Partner, \"CODPARC &gt; 0\")\nexcept ServiceRequestException as e:\n    print(f\"Servi\u00e7o: {e.service_name}\")\n    print(f\"Status: {e.status_code}\")\n    print(f\"Mensagem: {e.status_message}\")\n</code></pre>"},{"location":"core-concepts/error-handling/#servicerequestinvalidauthorizationexception","title":"ServiceRequestInvalidAuthorizationException","text":"<p>Credenciais inv\u00e1lidas:</p> Python<pre><code>from sankhya_sdk.exceptions import ServiceRequestInvalidAuthorizationException\n\ntry:\n    ctx = SankhyaContext.from_settings()\nexcept ServiceRequestInvalidAuthorizationException as e:\n    print(f\"Usu\u00e1rio inv\u00e1lido: {e.username}\")\n    # N\u00e3o adianta retry - credenciais erradas\n</code></pre>"},{"location":"core-concepts/error-handling/#servicerequestcompetitionexception","title":"ServiceRequestCompetitionException","text":"<p>Erro de concorr\u00eancia/lock:</p> Python<pre><code>from sankhya_sdk.exceptions import ServiceRequestCompetitionException\n\ntry:\n    crud.update(entity)\nexcept ServiceRequestCompetitionException as e:\n    print(f\"Recurso bloqueado, retry em: {e.retry_after}s\")\n    time.sleep(e.retry_after)\n    crud.update(entity)  # Tentar novamente\n</code></pre>"},{"location":"core-concepts/error-handling/#servicerequestdeadlockexception","title":"ServiceRequestDeadlockException","text":"<p>Deadlock no banco de dados:</p> Python<pre><code>from sankhya_sdk.exceptions import ServiceRequestDeadlockException\n\ntry:\n    crud.update(entity)\nexcept ServiceRequestDeadlockException as e:\n    print(f\"Deadlock na transa\u00e7\u00e3o: {e.transaction_id}\")\n    # SDK deve fazer retry automaticamente\n</code></pre>"},{"location":"core-concepts/error-handling/#retry-automatico","title":"Retry Autom\u00e1tico","text":"<p>O SDK implementa retry autom\u00e1tico com backoff exponencial:</p> <pre><code>flowchart TD\n    A[Requisi\u00e7\u00e3o] --&gt; B[Enviar]\n    B --&gt; C{Sucesso?}\n    C --&gt;|Sim| D[Retornar Resultado]\n    C --&gt;|N\u00e3o| E{Erro Recuper\u00e1vel?}\n    E --&gt;|N\u00e3o| F[Lan\u00e7ar Exce\u00e7\u00e3o]\n    E --&gt;|Sim| G{Tentativas &lt; Max?}\n    G --&gt;|N\u00e3o| F\n    G --&gt;|Sim| H[Calcular Delay]\n    H --&gt; I[Aguardar]\n    I --&gt; J[Incrementar Contador]\n    J --&gt; B</code></pre>"},{"location":"core-concepts/error-handling/#configurando-retry","title":"Configurando Retry","text":"Python<pre><code>from sankhya_sdk.request_helpers import RequestBehaviorOptions\nfrom sankhya_sdk.core.settings import SankhyaSettings\n\nsettings = SankhyaSettings(\n    base_url=\"https://api.sankhya.com.br\",\n    username=\"usuario\",\n    password=\"senha\",\n    request_behavior=RequestBehaviorOptions(\n        max_retry_count=5,          # M\u00e1ximo de tentativas\n        retry_delay_ms=1000,        # Delay inicial (1s)\n        backoff_multiplier=2.0,     # Multiplicador exponencial\n        max_retry_delay_ms=30000,   # Delay m\u00e1ximo (30s)\n    )\n)\n</code></pre>"},{"location":"core-concepts/error-handling/#formula-de-backoff","title":"F\u00f3rmula de Backoff","text":"Text Only<pre><code>delay = min(retry_delay_ms * (backoff_multiplier ^ attempt), max_retry_delay_ms)\n</code></pre> <p>Exemplo com configura\u00e7\u00e3o padr\u00e3o:</p> Tentativa C\u00e1lculo Delay 1 1000 * 2^0 1s 2 1000 * 2^1 2s 3 1000 * 2^2 4s 4 1000 * 2^3 8s 5 1000 * 2^4 16s"},{"location":"core-concepts/error-handling/#erros-recuperaveis-vs-nao-recuperaveis","title":"Erros Recuper\u00e1veis vs N\u00e3o Recuper\u00e1veis","text":"Tipo de Erro Recuper\u00e1vel A\u00e7\u00e3o Timeout \u2705 Retry Sess\u00e3o Expirada \u2705 Reautenticar + Retry Deadlock \u2705 Retry Competition \u2705 Retry com delay Credenciais Inv\u00e1lidas \u274c Falhar imediatamente Erro de Valida\u00e7\u00e3o \u274c Falhar imediatamente Erro de Neg\u00f3cio \u274c Falhar imediatamente"},{"location":"core-concepts/error-handling/#tratamento-manual-de-erros","title":"Tratamento Manual de Erros","text":""},{"location":"core-concepts/error-handling/#padrao-basico","title":"Padr\u00e3o B\u00e1sico","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.exceptions import (\n    SankhyaException,\n    ServiceRequestException,\n    ServiceRequestInvalidAuthorizationException,\n)\n\ntry:\n    with SankhyaContext.from_settings() as ctx:\n        result = ctx.wrapper.find(Partner, \"CODPARC &gt; 0\")\n\nexcept ServiceRequestInvalidAuthorizationException:\n    # Credenciais incorretas - n\u00e3o adianta retry\n    logging.error(\"Credenciais inv\u00e1lidas\")\n    sys.exit(1)\n\nexcept ServiceRequestException as e:\n    # Erro de comunica\u00e7\u00e3o com API\n    logging.error(f\"Erro API: {e.status_message} ({e.status_code})\")\n\nexcept SankhyaException as e:\n    # Outros erros do SDK\n    logging.error(f\"Erro SDK: {e.message}\")\n\nexcept Exception as e:\n    # Erros inesperados\n    logging.exception(f\"Erro inesperado: {e}\")\n</code></pre>"},{"location":"core-concepts/error-handling/#padrao-com-retry-manual","title":"Padr\u00e3o com Retry Manual","text":"Python<pre><code>import time\nfrom sankhya_sdk.exceptions import ServiceRequestCompetitionException\n\ndef update_with_retry(crud, entity, max_retries=3):\n    \"\"\"Atualiza com retry manual para erros de concorr\u00eancia.\"\"\"\n    for attempt in range(max_retries):\n        try:\n            return crud.update(entity)\n        except ServiceRequestCompetitionException as e:\n            if attempt &lt; max_retries - 1:\n                delay = e.retry_after or (2 ** attempt)\n                logging.warning(f\"Retry em {delay}s (tentativa {attempt + 1})\")\n                time.sleep(delay)\n            else:\n                raise\n</code></pre>"},{"location":"core-concepts/error-handling/#padrao-com-circuit-breaker","title":"Padr\u00e3o com Circuit Breaker","text":"Python<pre><code>from datetime import datetime, timedelta\n\nclass CircuitBreaker:\n    def __init__(self, failure_threshold=5, recovery_time=60):\n        self.failure_count = 0\n        self.failure_threshold = failure_threshold\n        self.recovery_time = timedelta(seconds=recovery_time)\n        self.last_failure_time = None\n        self.state = \"closed\"  # closed, open, half-open\n\n    def call(self, func, *args, **kwargs):\n        if self.state == \"open\":\n            if datetime.now() - self.last_failure_time &gt; self.recovery_time:\n                self.state = \"half-open\"\n            else:\n                raise ServiceRequestException(\"Circuit breaker open\")\n\n        try:\n            result = func(*args, **kwargs)\n            self.reset()\n            return result\n        except ServiceRequestException:\n            self.record_failure()\n            raise\n\n    def record_failure(self):\n        self.failure_count += 1\n        self.last_failure_time = datetime.now()\n        if self.failure_count &gt;= self.failure_threshold:\n            self.state = \"open\"\n\n    def reset(self):\n        self.failure_count = 0\n        self.state = \"closed\"\n\n# Uso\nbreaker = CircuitBreaker()\n\ntry:\n    result = breaker.call(crud.find, Partner, \"CODPARC &gt; 0\")\nexcept ServiceRequestException as e:\n    if \"Circuit breaker open\" in str(e):\n        # Sistema indispon\u00edvel, usar fallback\n        result = get_cached_data()\n</code></pre>"},{"location":"core-concepts/error-handling/#logging-de-erros","title":"Logging de Erros","text":""},{"location":"core-concepts/error-handling/#configuracao-recomendada","title":"Configura\u00e7\u00e3o Recomendada","text":"Python<pre><code>import logging\nimport json\nfrom datetime import datetime\n\n# Configura\u00e7\u00e3o de logging\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',\n    handlers=[\n        logging.FileHandler('sankhya_sdk.log'),\n        logging.StreamHandler()\n    ]\n)\n\n# Logger espec\u00edfico para erros\nerror_logger = logging.getLogger('sankhya_sdk.errors')\nerror_logger.setLevel(logging.ERROR)\n</code></pre>"},{"location":"core-concepts/error-handling/#capturar-contexto-de-erro","title":"Capturar Contexto de Erro","text":"Python<pre><code>def log_error_with_context(error: SankhyaException, context: dict):\n    \"\"\"Registra erro com contexto adicional.\"\"\"\n    error_data = {\n        \"timestamp\": datetime.now().isoformat(),\n        \"error_type\": type(error).__name__,\n        \"message\": str(error),\n        \"context\": context,\n    }\n\n    if isinstance(error, ServiceRequestException):\n        error_data[\"service\"] = error.service_name\n        error_data[\"status_code\"] = error.status_code\n\n    error_logger.error(json.dumps(error_data, indent=2))\n\n# Uso\ntry:\n    crud.update(entity)\nexcept SankhyaException as e:\n    log_error_with_context(e, {\n        \"entity_type\": \"Partner\",\n        \"entity_id\": entity.code_partner,\n        \"operation\": \"update\"\n    })\n    raise\n</code></pre>"},{"location":"core-concepts/error-handling/#mensagens-de-status","title":"Mensagens de Status","text":"<p>O SDK fornece helpers para interpretar mensagens de status:</p> Python<pre><code>from sankhya_sdk.helpers import StatusMessageHelper\n\ntry:\n    result = wrapper.invoke_service(\"ServiceName\", request)\nexcept ServiceRequestException as e:\n    # Interpretar mensagem de status\n    parsed = StatusMessageHelper.parse(e.status_message)\n\n    print(f\"Tipo: {parsed.type}\")        # ERROR, WARNING, INFO\n    print(f\"C\u00f3digo: {parsed.code}\")      # C\u00f3digo interno\n    print(f\"Mensagem: {parsed.message}\") # Mensagem amig\u00e1vel\n    print(f\"Detalhes: {parsed.details}\") # Informa\u00e7\u00f5es adicionais\n</code></pre>"},{"location":"core-concepts/error-handling/#tipos-de-status","title":"Tipos de Status","text":"Tipo Descri\u00e7\u00e3o A\u00e7\u00e3o <code>ERROR</code> Erro que impede opera\u00e7\u00e3o Falhar ou retry <code>WARNING</code> Aviso, opera\u00e7\u00e3o pode continuar Log e continuar <code>INFO</code> Informa\u00e7\u00e3o Ignorar ou log <code>VALIDATION</code> Erro de valida\u00e7\u00e3o Corrigir dados"},{"location":"core-concepts/error-handling/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"core-concepts/error-handling/#1-seja-especifico-no-catch","title":"1. Seja Espec\u00edfico no Catch","text":"Python<pre><code># \u2705 Bom - espec\u00edfico\ntry:\n    crud.update(entity)\nexcept ServiceRequestInvalidAuthorizationException:\n    # Tratar autentica\u00e7\u00e3o\nexcept ServiceRequestCompetitionException:\n    # Tratar concorr\u00eancia\nexcept ServiceRequestException:\n    # Outros erros de requisi\u00e7\u00e3o\nexcept SankhyaException:\n    # Outros erros do SDK\n\n# \u274c Evitar - gen\u00e9rico demais\ntry:\n    crud.update(entity)\nexcept Exception:\n    # N\u00e3o sabe o que aconteceu\n</code></pre>"},{"location":"core-concepts/error-handling/#2-nao-engula-excecoes","title":"2. N\u00e3o Engula Exce\u00e7\u00f5es","text":"Python<pre><code># \u2705 Bom - log e propaga\ntry:\n    crud.update(entity)\nexcept SankhyaException as e:\n    logging.error(f\"Erro: {e}\")\n    raise\n\n# \u274c Evitar - engole exce\u00e7\u00e3o\ntry:\n    crud.update(entity)\nexcept SankhyaException:\n    pass  # Silencioso, problema ser\u00e1 dif\u00edcil de debugar\n</code></pre>"},{"location":"core-concepts/error-handling/#3-use-contexto-adequado","title":"3. Use Contexto Adequado","text":"Python<pre><code># \u2705 Bom - adiciona contexto\ntry:\n    crud.update(entity)\nexcept SankhyaException as e:\n    raise OperationException(\n        f\"Falha ao atualizar parceiro {entity.code_partner}\",\n        inner_exception=e\n    )\n</code></pre>"},{"location":"core-concepts/error-handling/#4-implemente-fallbacks","title":"4. Implemente Fallbacks","text":"Python<pre><code>def get_partner(code: int) -&gt; Partner | None:\n    \"\"\"Busca parceiro com fallback para cache.\"\"\"\n    try:\n        partners = crud.find(Partner, f\"CODPARC = {code}\")\n        return partners[0] if partners else None\n    except ServiceRequestException:\n        # Fallback para cache local\n        return cache.get(f\"partner:{code}\")\n</code></pre>"},{"location":"core-concepts/error-handling/#5-monitore-erros","title":"5. Monitore Erros","text":"Python<pre><code>from collections import Counter\n\nerror_counter = Counter()\n\ndef monitored_operation(func):\n    \"\"\"Decorator que monitora erros.\"\"\"\n    def wrapper(*args, **kwargs):\n        try:\n            return func(*args, **kwargs)\n        except SankhyaException as e:\n            error_counter[type(e).__name__] += 1\n            raise\n    return wrapper\n\n@monitored_operation\ndef update_partner(partner: Partner):\n    return crud.update(partner)\n\n# Relat\u00f3rio peri\u00f3dico\ndef error_report():\n    for error_type, count in error_counter.most_common():\n        print(f\"{error_type}: {count} ocorr\u00eancias\")\n</code></pre>"},{"location":"core-concepts/error-handling/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Exemplos: Tratamento de Erros - Exemplos pr\u00e1ticos</li> <li>Refer\u00eancia: Exce\u00e7\u00f5es - API completa</li> <li>Request Helpers - Configura\u00e7\u00e3o de retry</li> </ul>"},{"location":"core-concepts/session-management/","title":"Gerenciamento de Sess\u00f5es","text":"<p>Este documento explica como o Sankhya SDK gerencia sess\u00f5es de autentica\u00e7\u00e3o, incluindo sess\u00f5es \u00fanicas, m\u00faltiplas sess\u00f5es e considera\u00e7\u00f5es de concorr\u00eancia.</p>"},{"location":"core-concepts/session-management/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O SDK oferece dois modos de gerenciamento de sess\u00f5es:</p> Modo Descri\u00e7\u00e3o Uso T\u00edpico Sess\u00e3o \u00danica Uma sess\u00e3o por contexto Aplica\u00e7\u00f5es simples, scripts M\u00faltiplas Sess\u00f5es V\u00e1rias sess\u00f5es simult\u00e2neas Aplica\u00e7\u00f5es multi-thread, APIs"},{"location":"core-concepts/session-management/#ciclo-de-vida-de-sessoes","title":"Ciclo de Vida de Sess\u00f5es","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; Desconectado\n    Desconectado --&gt; Autenticando: from_settings() / login()\n    Autenticando --&gt; Conectado: Sucesso\n    Autenticando --&gt; Erro: Falha\n    Erro --&gt; Autenticando: Retry\n    Erro --&gt; Desconectado: Max retries\n    Conectado --&gt; Executando: invoke_service()\n    Executando --&gt; Conectado: Resposta\n    Executando --&gt; Reconectando: Sess\u00e3o Expirada\n    Reconectando --&gt; Conectado: Reautenticado\n    Conectado --&gt; Desconectado: logout() / dispose()\n    Desconectado --&gt; [*]</code></pre>"},{"location":"core-concepts/session-management/#sessao-unica","title":"Sess\u00e3o \u00danica","text":""},{"location":"core-concepts/session-management/#uso-basico","title":"Uso B\u00e1sico","text":"<p>O modo mais simples, usando context manager:</p> Python<pre><code>from sankhya_sdk import SankhyaContext\n\n# Sess\u00e3o abre automaticamente\nwith SankhyaContext.from_settings() as ctx:\n    # Opera\u00e7\u00f5es aqui\n    resultado = ctx.wrapper.find(Partner, \"CODPARC &gt; 0\")\n# Sess\u00e3o fecha automaticamente (logout)\n</code></pre>"},{"location":"core-concepts/session-management/#fluxo-de-autenticacao","title":"Fluxo de Autentica\u00e7\u00e3o","text":"<pre><code>sequenceDiagram\n    participant App as Aplica\u00e7\u00e3o\n    participant Ctx as SankhyaContext\n    participant Wrapper as SankhyaWrapper\n    participant API as API Sankhya\n\n    App-&gt;&gt;Ctx: from_settings()\n    Ctx-&gt;&gt;Ctx: Criar Settings\n    Ctx-&gt;&gt;Wrapper: Criar Wrapper\n    Ctx-&gt;&gt;Wrapper: login()\n    Wrapper-&gt;&gt;API: POST /mge/service.sbr (ABORTAR/login)\n    API--&gt;&gt;Wrapper: jsessionid cookie\n    Wrapper--&gt;&gt;Ctx: Token de sess\u00e3o\n    Ctx--&gt;&gt;App: Contexto autenticado\n\n    Note over App,API: Opera\u00e7\u00f5es...\n\n    App-&gt;&gt;Ctx: __exit__() / dispose()\n    Ctx-&gt;&gt;Wrapper: logout()\n    Wrapper-&gt;&gt;API: POST /mge/service.sbr (ABORTAR/logout)\n    API--&gt;&gt;Wrapper: OK\n    Ctx--&gt;&gt;App: Contexto fechado</code></pre>"},{"location":"core-concepts/session-management/#sem-context-manager","title":"Sem Context Manager","text":"<p>Para controle manual do ciclo de vida:</p> Python<pre><code>from sankhya_sdk import SankhyaContext\n\nctx = SankhyaContext.from_settings()\ntry:\n    # Opera\u00e7\u00f5es\n    resultado = ctx.wrapper.find(Partner, \"CODPARC &gt; 0\")\nfinally:\n    ctx.dispose()  # Importante: sempre chamar dispose()\n</code></pre> <p>Importante</p> <p>Sempre chame <code>dispose()</code> quando n\u00e3o usar context manager para evitar sess\u00f5es \u00f3rf\u00e3s.</p>"},{"location":"core-concepts/session-management/#multiplas-sessoes","title":"M\u00faltiplas Sess\u00f5es","text":"<p>Para aplica\u00e7\u00f5es que precisam de paralelismo ou isolamento de opera\u00e7\u00f5es.</p>"},{"location":"core-concepts/session-management/#adquirindo-sessoes","title":"Adquirindo Sess\u00f5es","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\n\n# Cria contexto principal\nctx = SankhyaContext.from_settings()\n\n# Adquire sess\u00f5es adicionais\ntoken1 = ctx.acquire_session()  # Retorna UUID\ntoken2 = ctx.acquire_session()\n\nprint(f\"Sess\u00e3o 1: {token1}\")\nprint(f\"Sess\u00e3o 2: {token2}\")\n\n# Usa sess\u00f5es\nresult1 = ctx.invoke_with_token(token1, \"ServiceName\", request1)\nresult2 = ctx.invoke_with_token(token2, \"ServiceName\", request2)\n\n# Finaliza sess\u00f5es\nctx.finalize_session(token1)\nctx.finalize_session(token2)\n\nctx.dispose()\n</code></pre>"},{"location":"core-concepts/session-management/#diagrama-de-multiplas-sessoes","title":"Diagrama de M\u00faltiplas Sess\u00f5es","text":"<pre><code>graph TD\n    subgraph SankhyaContext\n        M[Sess\u00e3o Principal]\n        T1[Token 1]\n        T2[Token 2]\n        T3[Token 3]\n    end\n\n    subgraph \"Wrappers Registrados\"\n        W1[Wrapper 1]\n        W2[Wrapper 2]\n        W3[Wrapper 3]\n    end\n\n    M --&gt; W1\n    T1 --&gt; W1\n    T2 --&gt; W2\n    T3 --&gt; W3\n\n    W1 --&gt; API[API Sankhya]\n    W2 --&gt; API\n    W3 --&gt; API</code></pre>"},{"location":"core-concepts/session-management/#detachando-sessoes","title":"Detachando Sess\u00f5es","text":"<p>Para transferir uma sess\u00e3o para outro contexto ou processo:</p> Python<pre><code># Processo 1: Cria e detacha sess\u00e3o\nctx1 = SankhyaContext.from_settings()\ntoken = ctx1.acquire_session()\nwrapper_serializado = ctx1.detach_session(token)\n\n# Processo 2: Usa sess\u00e3o detachada\nctx2 = SankhyaContext.from_settings()\nctx2.attach_session(token, wrapper_serializado)\nresult = ctx2.invoke_with_token(token, \"ServiceName\", request)\n</code></pre>"},{"location":"core-concepts/session-management/#thread-safety","title":"Thread Safety","text":"<p>O SDK \u00e9 thread-safe por design. Cada thread pode usar sess\u00f5es independentes.</p>"},{"location":"core-concepts/session-management/#exemplo-multi-threaded","title":"Exemplo Multi-threaded","text":"Python<pre><code>import threading\nfrom concurrent.futures import ThreadPoolExecutor\nfrom sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\n\nctx = SankhyaContext.from_settings()\n\ndef process_batch(batch_id: int, items: list):\n    \"\"\"Processa um lote em uma thread separada.\"\"\"\n    token = ctx.acquire_session()\n    try:\n        # Cada thread tem sua pr\u00f3pria sess\u00e3o\n        for item in items:\n            result = ctx.invoke_with_token(\n                token, \n                \"CRUDServiceProvider.saveRecord\",\n                build_request(item)\n            )\n            print(f\"Batch {batch_id}: Processado item {item['id']}\")\n    finally:\n        ctx.finalize_session(token)\n\n# Divide trabalho em lotes\nall_items = [...]  # Lista de items\nbatches = [all_items[i:i+100] for i in range(0, len(all_items), 100)]\n\n# Processa em paralelo\nwith ThreadPoolExecutor(max_workers=5) as executor:\n    futures = [\n        executor.submit(process_batch, i, batch)\n        for i, batch in enumerate(batches)\n    ]\n\n    for future in futures:\n        future.result()  # Aguarda conclus\u00e3o\n\nctx.dispose()\n</code></pre>"},{"location":"core-concepts/session-management/#locks-internos","title":"Locks Internos","text":"<p>O SDK usa locks para opera\u00e7\u00f5es cr\u00edticas:</p> <pre><code>sequenceDiagram\n    participant T1 as Thread 1\n    participant T2 as Thread 2\n    participant Lock as Lock Manager\n    participant Ctx as SankhyaContext\n\n    T1-&gt;&gt;Lock: acquire_lock(\"session_registry\")\n    Lock--&gt;&gt;T1: Lock acquired\n    T1-&gt;&gt;Ctx: acquire_session()\n    T1-&gt;&gt;Lock: release_lock()\n\n    T2-&gt;&gt;Lock: acquire_lock(\"session_registry\")\n    Note over T2,Lock: Aguarda lock...\n    Lock--&gt;&gt;T2: Lock acquired\n    T2-&gt;&gt;Ctx: acquire_session()\n    T2-&gt;&gt;Lock: release_lock()</code></pre>"},{"location":"core-concepts/session-management/#asyncawait","title":"Async/Await","text":"<p>Para aplica\u00e7\u00f5es ass\u00edncronas (requires <code>httpx</code> e <code>aiofiles</code>):</p> Python<pre><code>import asyncio\nfrom sankhya_sdk import AsyncSankhyaContext\n\nasync def main():\n    async with AsyncSankhyaContext.from_settings() as ctx:\n        # Opera\u00e7\u00f5es ass\u00edncronas\n        partners = await ctx.wrapper.find_async(Partner, \"CODPARC &gt; 0\")\n\n        # M\u00faltiplas requisi\u00e7\u00f5es em paralelo\n        tasks = [\n            ctx.wrapper.find_async(Partner, f\"CODPARC = {i}\")\n            for i in range(1, 10)\n        ]\n        results = await asyncio.gather(*tasks)\n\nasyncio.run(main())\n</code></pre>"},{"location":"core-concepts/session-management/#multiplas-sessoes-assincronas","title":"M\u00faltiplas Sess\u00f5es Ass\u00edncronas","text":"Python<pre><code>async def process_with_session(ctx, item):\n    \"\"\"Processa item com sess\u00e3o pr\u00f3pria.\"\"\"\n    token = await ctx.acquire_session_async()\n    try:\n        result = await ctx.invoke_with_token_async(\n            token, \"ServiceName\", build_request(item)\n        )\n        return result\n    finally:\n        await ctx.finalize_session_async(token)\n\nasync def main():\n    async with AsyncSankhyaContext.from_settings() as ctx:\n        items = [...]\n\n        # Processa todos em paralelo\n        results = await asyncio.gather(*[\n            process_with_session(ctx, item)\n            for item in items\n        ])\n</code></pre>"},{"location":"core-concepts/session-management/#renovacao-de-token","title":"Renova\u00e7\u00e3o de Token","text":"<p>O SDK gerencia automaticamente tokens expirados:</p> <pre><code>flowchart TD\n    A[Requisi\u00e7\u00e3o] --&gt; B[Enviar com Token]\n    B --&gt; C{Token V\u00e1lido?}\n    C --&gt;|Sim| D[Processar Resposta]\n    C --&gt;|N\u00e3o| E[Detectar Erro de Sess\u00e3o]\n    E --&gt; F[Reautenticar]\n    F --&gt; G{Sucesso?}\n    G --&gt;|Sim| H[Atualizar Token]\n    H --&gt; A\n    G --&gt;|N\u00e3o| I[Lan\u00e7ar Exce\u00e7\u00e3o]\n    D --&gt; J[Retornar Resultado]</code></pre>"},{"location":"core-concepts/session-management/#configurando-timeout-de-sessao","title":"Configurando Timeout de Sess\u00e3o","text":"Python<pre><code>from sankhya_sdk.core.settings import SankhyaSettings\n\nsettings = SankhyaSettings(\n    base_url=\"https://api.sankhya.com.br\",\n    username=\"usuario\",\n    password=\"senha\",\n    session_timeout=300,  # 5 minutos\n    auto_renew_session=True  # Renova\u00e7\u00e3o autom\u00e1tica\n)\n\nctx = SankhyaContext(settings)\n</code></pre>"},{"location":"core-concepts/session-management/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"core-concepts/session-management/#1-use-context-managers","title":"1. Use Context Managers","text":"Python<pre><code># \u2705 Correto\nwith SankhyaContext.from_settings() as ctx:\n    ...\n\n# \u274c Evitar (pode deixar sess\u00f5es abertas)\nctx = SankhyaContext.from_settings()\n...\n# Se exce\u00e7\u00e3o ocorrer aqui, sess\u00e3o n\u00e3o fecha\n</code></pre>"},{"location":"core-concepts/session-management/#2-limite-sessoes-simultaneas","title":"2. Limite Sess\u00f5es Simult\u00e2neas","text":"Python<pre><code>from concurrent.futures import ThreadPoolExecutor\n\n# \u2705 Limitar workers\nwith ThreadPoolExecutor(max_workers=5) as executor:\n    ...\n\n# \u274c Evitar muitas sess\u00f5es\nwith ThreadPoolExecutor(max_workers=100) as executor:\n    # Pode exceder limite do servidor\n    ...\n</code></pre>"},{"location":"core-concepts/session-management/#3-feche-sessoes-nao-utilizadas","title":"3. Feche Sess\u00f5es N\u00e3o Utilizadas","text":"Python<pre><code># \u2705 Finalizar explicitamente\ntoken = ctx.acquire_session()\ntry:\n    # opera\u00e7\u00f5es\nfinally:\n    ctx.finalize_session(token)\n\n# \u274c N\u00e3o deixar sess\u00f5es abertas\ntoken = ctx.acquire_session()\n# opera\u00e7\u00f5es (se exce\u00e7\u00e3o, sess\u00e3o fica aberta)\n</code></pre>"},{"location":"core-concepts/session-management/#4-trate-erros-de-sessao","title":"4. Trate Erros de Sess\u00e3o","text":"Python<pre><code>from sankhya_sdk.exceptions import (\n    ServiceRequestInvalidAuthorizationException,\n    ServiceRequestException,\n)\n\ntry:\n    result = ctx.wrapper.find(Partner, \"CODPARC &gt; 0\")\nexcept ServiceRequestInvalidAuthorizationException:\n    # Credenciais inv\u00e1lidas - n\u00e3o adianta retry\n    raise\nexcept ServiceRequestException as e:\n    if \"session expired\" in str(e).lower():\n        # Sess\u00e3o expirada - SDK deve reautenticar automaticamente\n        # Se chegou aqui, algo est\u00e1 errado\n        ctx.dispose()\n        ctx = SankhyaContext.from_settings()\n        result = ctx.wrapper.find(Partner, \"CODPARC &gt; 0\")\n</code></pre>"},{"location":"core-concepts/session-management/#monitoramento","title":"Monitoramento","text":""},{"location":"core-concepts/session-management/#logging-de-sessoes","title":"Logging de Sess\u00f5es","text":"Python<pre><code>import logging\n\n# Configura logging detalhado\nlogging.basicConfig(level=logging.DEBUG)\nlogger = logging.getLogger('sankhya_sdk.session')\nlogger.setLevel(logging.DEBUG)\n\n# Logs incluir\u00e3o:\n# - Login/logout\n# - Aquisi\u00e7\u00e3o/libera\u00e7\u00e3o de sess\u00f5es\n# - Renova\u00e7\u00e3o de tokens\n# - Erros de autentica\u00e7\u00e3o\n</code></pre>"},{"location":"core-concepts/session-management/#metricas-de-sessao","title":"M\u00e9tricas de Sess\u00e3o","text":"Python<pre><code># Obt\u00e9m estat\u00edsticas\nstats = ctx.get_session_stats()\nprint(f\"Sess\u00f5es ativas: {stats['active_sessions']}\")\nprint(f\"Total de sess\u00f5es criadas: {stats['total_created']}\")\nprint(f\"Sess\u00f5es finalizadas: {stats['total_finalized']}\")\nprint(f\"Renova\u00e7\u00f5es de token: {stats['token_renewals']}\")\n</code></pre>"},{"location":"core-concepts/session-management/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Sistema de Entidades - Cria\u00e7\u00e3o de entidades</li> <li>Tratamento de Erros - Estrat\u00e9gias de erro</li> <li>Exemplos - Exemplos pr\u00e1ticos</li> </ul>"},{"location":"examples/","title":"Exemplos","text":"<p>Exemplos pr\u00e1ticos de uso do Sankhya SDK Python.</p>"},{"location":"examples/#categorias","title":"Categorias","text":"<ul> <li> <p> Opera\u00e7\u00f5es CRUD</p> <p>Find, Insert, Update, Remove com entidades.</p> <p> CRUD</p> </li> <li> <p> Requisi\u00e7\u00f5es Paginadas</p> <p>Consultas com grandes volumes de dados.</p> <p> Pagina\u00e7\u00e3o</p> </li> <li> <p> Gerenciamento de Sess\u00f5es</p> <p>M\u00faltiplas sess\u00f5es, threading, async.</p> <p> Sess\u00f5es</p> </li> <li> <p> Opera\u00e7\u00f5es com Arquivos</p> <p>Download/upload de arquivos e imagens.</p> <p> Arquivos</p> </li> <li> <p> Queries Avan\u00e7adas</p> <p>Filtros complexos, joins, ordena\u00e7\u00e3o.</p> <p> Queries</p> </li> <li> <p> Tratamento de Erros</p> <p>Exce\u00e7\u00f5es, retry, circuit breaker.</p> <p> Erros</p> </li> <li> <p> Entidades Customizadas</p> <p>Cria\u00e7\u00e3o de entidades para tabelas customizadas.</p> <p> Entidades</p> </li> </ul>"},{"location":"examples/#por-nivel","title":"Por N\u00edvel","text":""},{"location":"examples/#basico","title":"B\u00e1sico","text":"Exemplo Descri\u00e7\u00e3o Hello World Primeira conex\u00e3o Find simples Busca de entidades Insert b\u00e1sico Cria\u00e7\u00e3o de entidades"},{"location":"examples/#intermediario","title":"Intermedi\u00e1rio","text":"Exemplo Descri\u00e7\u00e3o Pagina\u00e7\u00e3o Grandes volumes Filtros complexos FilterExpression Tratamento de erros Exce\u00e7\u00f5es e retry"},{"location":"examples/#avancado","title":"Avan\u00e7ado","text":"Exemplo Descri\u00e7\u00e3o Multi-threading Processamento paralelo Async/await Opera\u00e7\u00f5es ass\u00edncronas Entidades customizadas Tabelas personalizadas"},{"location":"examples/#codigo-fonte","title":"C\u00f3digo Fonte","text":"<p>Todos os exemplos est\u00e3o dispon\u00edveis como arquivos Python execut\u00e1veis:</p> Text Only<pre><code>examples/\n\u251c\u2500\u2500 crud_operations_example.py\n\u251c\u2500\u2500 paged_request_example.py\n\u251c\u2500\u2500 session_management_example.py\n\u251c\u2500\u2500 file_operations_example.py\n\u251c\u2500\u2500 advanced_queries_example.py\n\u251c\u2500\u2500 error_handling_example.py\n\u2514\u2500\u2500 custom_entities_example.py\n</code></pre>"},{"location":"examples/#executar-exemplos","title":"Executar Exemplos","text":"Bash<pre><code># Ative o ambiente virtual\nsource .venv/bin/activate  # Linux/macOS\n.venv\\Scripts\\activate     # Windows\n\n# Execute um exemplo\npython examples/crud_operations_example.py\n</code></pre> <p>Configura\u00e7\u00e3o Necess\u00e1ria</p> <p>Todos os exemplos requerem um arquivo <code>.env</code> configurado com credenciais v\u00e1lidas.</p>"},{"location":"examples/advanced-queries/","title":"Queries Avan\u00e7adas","text":"<p>Exemplos de filtros complexos, joins e ordena\u00e7\u00e3o.</p>"},{"location":"examples/advanced-queries/#filterexpression","title":"FilterExpression","text":""},{"location":"examples/advanced-queries/#operadores-basicos","title":"Operadores B\u00e1sicos","text":"Python<pre><code>from sankhya_sdk.helpers import FilterExpression\n\n# Igualdade\nfilter_expr = FilterExpression().equals(\"CODPARC\", 1)\n# CODPARC = 1\n\n# Diferen\u00e7a\nfilter_expr = FilterExpression().not_equals(\"STATUS\", \"C\")\n# STATUS &lt;&gt; 'C'\n\n# Maior que\nfilter_expr = FilterExpression().greater_than(\"VLRNOTA\", 1000)\n# VLRNOTA &gt; 1000\n\n# Menor ou igual\nfilter_expr = FilterExpression().less_or_equal(\"ESTOQUE\", 10)\n# ESTOQUE &lt;= 10\n\n# LIKE\nfilter_expr = FilterExpression().like(\"NOMEPARC\", \"%LTDA%\")\n# NOMEPARC LIKE '%LTDA%'\n\n# IN\nfilter_expr = FilterExpression().in_(\"CODPARC\", [1, 2, 3])\n# CODPARC IN (1, 2, 3)\n\n# BETWEEN\nfrom datetime import date\nfilter_expr = FilterExpression().between(\n    \"DTMOV\",\n    date(2024, 1, 1),\n    date(2024, 12, 31)\n)\n# DTMOV BETWEEN '01/01/2024' AND '31/12/2024'\n\n# IS NULL / IS NOT NULL\nfilter_expr = FilterExpression().is_null(\"EMAIL\")\n# EMAIL IS NULL\n\nfilter_expr = FilterExpression().is_not_null(\"CGC_CPF\")\n# CGC_CPF IS NOT NULL\n</code></pre>"},{"location":"examples/advanced-queries/#filtros-compostos","title":"Filtros Compostos","text":""},{"location":"examples/advanced-queries/#and-or","title":"AND / OR","text":"Python<pre><code>from sankhya_sdk.helpers import FilterExpression\n\n# Combina\u00e7\u00e3o AND\nfilter_expr = (\n    FilterExpression()\n    .equals(\"ATIVO\", \"S\")\n    .and_()\n    .equals(\"TIPPESSOA\", \"C\")\n)\n# ATIVO = 'S' AND TIPPESSOA = 'C'\n\n# Combina\u00e7\u00e3o OR\nfilter_expr = (\n    FilterExpression()\n    .equals(\"TIPPESSOA\", \"C\")\n    .or_()\n    .equals(\"TIPPESSOA\", \"F\")\n)\n# TIPPESSOA = 'C' OR TIPPESSOA = 'F'\n</code></pre>"},{"location":"examples/advanced-queries/#grupos-parenteses","title":"Grupos (Par\u00eanteses)","text":"Python<pre><code>filter_expr = (\n    FilterExpression()\n    .equals(\"ATIVO\", \"S\")\n    .and_()\n    .group_start()\n        .equals(\"TIPPESSOA\", \"C\")\n        .or_()\n        .equals(\"TIPPESSOA\", \"A\")\n    .group_end()\n)\n# ATIVO = 'S' AND (TIPPESSOA = 'C' OR TIPPESSOA = 'A')\n</code></pre>"},{"location":"examples/advanced-queries/#exemplo-complexo","title":"Exemplo Complexo","text":"Python<pre><code>from datetime import date, timedelta\n\nhoje = date.today()\nmes_passado = hoje - timedelta(days=30)\n\nfilter_expr = (\n    FilterExpression()\n    .equals(\"ATIVO\", \"S\")\n    .and_()\n    .group_start()\n        .in_(\"TIPPESSOA\", [\"C\", \"A\"])\n    .group_end()\n    .and_()\n    .greater_or_equal(\"DTMOV\", mes_passado)\n    .and_()\n    .greater_than(\"VLRNOTA\", 1000)\n    .and_()\n    .is_not_null(\"EMAIL\")\n    .and_()\n    .like(\"NOMEPARC\", \"%LTDA%\")\n)\n\ncriteria = filter_expr.build()\n# ATIVO = 'S' AND (TIPPESSOA IN ('C', 'A')) AND DTMOV &gt;= '...' ...\n</code></pre>"},{"location":"examples/advanced-queries/#entityqueryoptions","title":"EntityQueryOptions","text":""},{"location":"examples/advanced-queries/#campos-especificos","title":"Campos Espec\u00edficos","text":"Python<pre><code>from sankhya_sdk.helpers import EntityQueryOptions\n\noptions = EntityQueryOptions(\n    include_fields=[\"CODPARC\", \"NOMEPARC\", \"CGC_CPF\", \"EMAIL\"]\n)\n\npartners = crud.find_with_options(Partner, \"ATIVO = 'S'\", options)\n</code></pre>"},{"location":"examples/advanced-queries/#ordenacao","title":"Ordena\u00e7\u00e3o","text":"Python<pre><code>options = EntityQueryOptions(\n    order_by=\"NOMEPARC ASC\"\n)\n\n# M\u00faltiplas ordena\u00e7\u00f5es\noptions = EntityQueryOptions(\n    order_by=\"ATIVO DESC, NOMEPARC ASC\"\n)\n</code></pre>"},{"location":"examples/advanced-queries/#limite-e-distinct","title":"Limite e Distinct","text":"Python<pre><code>options = EntityQueryOptions(\n    max_results=100,\n    distinct=True\n)\n</code></pre>"},{"location":"examples/advanced-queries/#incluir-referencias","title":"Incluir Refer\u00eancias","text":"Python<pre><code>options = EntityQueryOptions(\n    include_references=True  # Carrega entidades relacionadas\n)\n\npartners = crud.find_with_options(Partner, \"CODPARC &gt; 0\", options)\n\nfor partner in partners:\n    # Refer\u00eancias carregadas\n    print(partner.city_reference)  # Objeto City, n\u00e3o apenas c\u00f3digo\n</code></pre>"},{"location":"examples/advanced-queries/#queries-com-datas","title":"Queries com Datas","text":"Python<pre><code>from datetime import date, datetime, timedelta\nfrom sankhya_sdk.helpers import FilterExpression\n\n# Hoje\ntoday = date.today()\n\n# \u00daltimos 7 dias\nlast_week = today - timedelta(days=7)\nfilter_expr = FilterExpression().greater_or_equal(\"DTMOV\", last_week)\n\n# M\u00eas atual\nfirst_day = date(today.year, today.month, 1)\nfilter_expr = (\n    FilterExpression()\n    .greater_or_equal(\"DTMOV\", first_day)\n    .and_()\n    .less_or_equal(\"DTMOV\", today)\n)\n\n# Ano espec\u00edfico\nfilter_expr = (\n    FilterExpression()\n    .between(\"DTMOV\", date(2024, 1, 1), date(2024, 12, 31))\n)\n</code></pre>"},{"location":"examples/advanced-queries/#queries-com-valores-numericos","title":"Queries com Valores Num\u00e9ricos","text":"Python<pre><code>from decimal import Decimal\nfrom sankhya_sdk.helpers import FilterExpression\n\n# Valor exato\nfilter_expr = FilterExpression().equals(\"VLRNOTA\", Decimal(\"1500.00\"))\n\n# Faixa de valores\nfilter_expr = FilterExpression().between(\"VLRNOTA\", 1000, 5000)\n\n# Maior que zero\nfilter_expr = FilterExpression().greater_than(\"ESTOQUE\", 0)\n\n# Porcentagem\nfilter_expr = FilterExpression().less_than(\"PERCDESC\", 50)\n</code></pre>"},{"location":"examples/advanced-queries/#queries-com-texto","title":"Queries com Texto","text":"Python<pre><code>from sankhya_sdk.helpers import FilterExpression\n\n# Cont\u00e9m texto\nfilter_expr = FilterExpression().like(\"NOMEPARC\", \"%COMERCIO%\")\n\n# Come\u00e7a com\nfilter_expr = FilterExpression().like(\"NOMEPARC\", \"EMPRESA%\")\n\n# Termina com\nfilter_expr = FilterExpression().like(\"EMAIL\", \"%@gmail.com\")\n\n# Case insensitive (depende do banco)\nfilter_expr = FilterExpression().like(\"UPPER(NOMEPARC)\", \"%LTDA%\")\n</code></pre>"},{"location":"examples/advanced-queries/#exemplo-com-crud","title":"Exemplo com CRUD","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner, InvoiceHeader\nfrom sankhya_sdk.helpers import FilterExpression, EntityQueryOptions\nfrom datetime import date, timedelta\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Query complexa de parceiros\n    partner_filter = (\n        FilterExpression()\n        .equals(\"ATIVO\", \"S\")\n        .and_()\n        .in_(\"TIPPESSOA\", [\"C\", \"A\"])\n        .and_()\n        .is_not_null(\"EMAIL\")\n    )\n\n    partner_options = EntityQueryOptions(\n        include_fields=[\"CODPARC\", \"NOMEPARC\", \"EMAIL\", \"TIPPESSOA\"],\n        order_by=\"NOMEPARC ASC\",\n        max_results=50\n    )\n\n    partners = crud.find_with_options(\n        Partner,\n        partner_filter.build(),\n        partner_options\n    )\n\n    print(f\"Parceiros: {len(partners)}\")\n\n    # Query de notas do \u00faltimo m\u00eas\n    last_month = date.today() - timedelta(days=30)\n\n    invoice_filter = (\n        FilterExpression()\n        .greater_or_equal(\"DTMOV\", last_month)\n        .and_()\n        .equals(\"STATUSNOTA\", \"F\")\n        .and_()\n        .greater_than(\"VLRNOTA\", 1000)\n    )\n\n    invoice_options = EntityQueryOptions(\n        order_by=\"VLRNOTA DESC\",\n        max_results=100\n    )\n\n    invoices = crud.find_with_options(\n        InvoiceHeader,\n        invoice_filter.build(),\n        invoice_options\n    )\n\n    print(f\"Notas: {len(invoices)}\")\n\n    for invoice in invoices[:5]:\n        print(f\"  {invoice.single_number}: R${invoice.total_value}\")\n</code></pre>"},{"location":"examples/advanced-queries/#exemplo-completo","title":"Exemplo Completo","text":"Python<pre><code>#!/usr/bin/env python3\n\"\"\"\nExemplo completo de queries avan\u00e7adas.\n\nDemonstra constru\u00e7\u00e3o de filtros complexos e relat\u00f3rios.\n\"\"\"\n\nfrom sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner, InvoiceHeader\nfrom sankhya_sdk.helpers import FilterExpression, EntityQueryOptions\nfrom dotenv import load_dotenv\nfrom datetime import date, timedelta\nfrom decimal import Decimal\nimport logging\n\nload_dotenv()\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\n\ndef build_partner_query(\n    active_only=True,\n    partner_types=None,\n    min_purchases=None,\n    has_email=False\n):\n    \"\"\"Constr\u00f3i query de parceiros com filtros opcionais.\"\"\"\n    filter_expr = FilterExpression()\n\n    if active_only:\n        filter_expr.equals(\"ATIVO\", \"S\")\n\n    if partner_types:\n        if active_only:\n            filter_expr.and_()\n        filter_expr.in_(\"TIPPESSOA\", partner_types)\n\n    if has_email:\n        filter_expr.and_().is_not_null(\"EMAIL\")\n\n    if min_purchases:\n        filter_expr.and_().greater_or_equal(\"VLRCOMPRAS\", min_purchases)\n\n    return filter_expr.build()\n\n\ndef build_invoice_query(\n    start_date=None,\n    end_date=None,\n    min_value=None,\n    status=None,\n    partner_id=None\n):\n    \"\"\"Constr\u00f3i query de notas com filtros opcionais.\"\"\"\n    filter_expr = FilterExpression()\n    has_filter = False\n\n    if start_date:\n        filter_expr.greater_or_equal(\"DTMOV\", start_date)\n        has_filter = True\n\n    if end_date:\n        if has_filter:\n            filter_expr.and_()\n        filter_expr.less_or_equal(\"DTMOV\", end_date)\n        has_filter = True\n\n    if min_value:\n        if has_filter:\n            filter_expr.and_()\n        filter_expr.greater_than(\"VLRNOTA\", min_value)\n        has_filter = True\n\n    if status:\n        if has_filter:\n            filter_expr.and_()\n        if isinstance(status, list):\n            filter_expr.in_(\"STATUSNOTA\", status)\n        else:\n            filter_expr.equals(\"STATUSNOTA\", status)\n        has_filter = True\n\n    if partner_id:\n        if has_filter:\n            filter_expr.and_()\n        filter_expr.equals(\"CODPARC\", partner_id)\n\n    return filter_expr.build() if has_filter else \"\"\n\n\ndef main():\n    with SankhyaContext.from_settings() as ctx:\n        crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n        # 1. Clientes ativos com email\n        logger.info(\"=== Clientes Ativos com Email ===\")\n        criteria = build_partner_query(\n            active_only=True,\n            partner_types=[\"C\", \"A\"],\n            has_email=True\n        )\n\n        options = EntityQueryOptions(\n            include_fields=[\"CODPARC\", \"NOMEPARC\", \"EMAIL\"],\n            order_by=\"NOMEPARC\",\n            max_results=10\n        )\n\n        partners = crud.find_with_options(Partner, criteria, options)\n        for p in partners:\n            logger.info(f\"  {p.code_partner}: {p.name} - {p.email}\")\n\n        # 2. Notas do \u00faltimo m\u00eas acima de R$5.000\n        logger.info(\"=== Notas do \u00daltimo M\u00eas &gt; R$5.000 ===\")\n        criteria = build_invoice_query(\n            start_date=date.today() - timedelta(days=30),\n            min_value=Decimal(\"5000\"),\n            status=[\"F\", \"A\"]\n        )\n\n        options = EntityQueryOptions(\n            order_by=\"VLRNOTA DESC\",\n            max_results=10\n        )\n\n        invoices = crud.find_with_options(InvoiceHeader, criteria, options)\n\n        total = Decimal(\"0\")\n        for inv in invoices:\n            logger.info(f\"  {inv.single_number}: R${inv.total_value}\")\n            total += inv.total_value or Decimal(\"0\")\n\n        logger.info(f\"  Total: R${total:,.2f}\")\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"examples/advanced-queries/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Tratamento de Erros - Exce\u00e7\u00f5es</li> <li>Helpers - API completa</li> <li>Exemplos CRUD - Opera\u00e7\u00f5es b\u00e1sicas</li> </ul>"},{"location":"examples/crud-operations/","title":"Opera\u00e7\u00f5es CRUD","text":"<p>Exemplos de opera\u00e7\u00f5es Create, Read, Update e Delete.</p>"},{"location":"examples/crud-operations/#exemplo-basico","title":"Exemplo B\u00e1sico","text":"Python<pre><code>#!/usr/bin/env python3\n\"\"\"Exemplo b\u00e1sico de CRUD com Sankhya SDK.\"\"\"\n\nfrom sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\nfrom dotenv import load_dotenv\n\n# Carrega configura\u00e7\u00f5es\nload_dotenv()\n\n# Conecta \u00e0 API\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Busca parceiros\n    partners = crud.find(Partner, \"CODPARC &gt; 0\", max_results=5)\n\n    for partner in partners:\n        print(f\"{partner.code_partner}: {partner.name}\")\n</code></pre>"},{"location":"examples/crud-operations/#find","title":"Find","text":""},{"location":"examples/crud-operations/#busca-simples","title":"Busca Simples","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Todos os parceiros ativos\n    partners = crud.find(Partner, \"ATIVO = 'S'\")\n\n    # Com limite de resultados\n    partners = crud.find(Partner, \"ATIVO = 'S'\", max_results=100)\n\n    # Por c\u00f3digo espec\u00edfico\n    partners = crud.find(Partner, \"CODPARC = 1\")\n    if partners:\n        partner = partners[0]\n        print(f\"Nome: {partner.name}\")\n</code></pre>"},{"location":"examples/crud-operations/#busca-com-opcoes","title":"Busca com Op\u00e7\u00f5es","text":"Python<pre><code>from sankhya_sdk.helpers import EntityQueryOptions\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Op\u00e7\u00f5es de consulta\n    options = EntityQueryOptions(\n        include_fields=[\"CODPARC\", \"NOMEPARC\", \"CGC_CPF\", \"EMAIL\"],\n        order_by=\"NOMEPARC ASC\",\n        max_results=50,\n        include_references=False\n    )\n\n    partners = crud.find_with_options(\n        Partner,\n        \"ATIVO = 'S' AND TIPPESSOA = 'C'\",\n        options\n    )\n\n    for partner in partners:\n        print(f\"{partner.name} - {partner.email or 'Sem email'}\")\n</code></pre>"},{"location":"examples/crud-operations/#busca-com-filterexpression","title":"Busca com FilterExpression","text":"Python<pre><code>from sankhya_sdk.helpers import FilterExpression\nfrom datetime import date\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Construir filtro com fluent API\n    filter_expr = (\n        FilterExpression()\n        .equals(\"ATIVO\", \"S\")\n        .and_()\n        .in_(\"TIPPESSOA\", [\"C\", \"A\"])\n        .and_()\n        .is_not_null(\"EMAIL\")\n    )\n\n    partners = crud.find(Partner, filter_expr.build())\n    print(f\"Encontrados: {len(partners)} parceiros\")\n</code></pre>"},{"location":"examples/crud-operations/#insert","title":"Insert","text":""},{"location":"examples/crud-operations/#insercao-simples","title":"Inser\u00e7\u00e3o Simples","text":"Python<pre><code>from sankhya_sdk.transport_entities import Partner\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Cria novo parceiro\n    partner = Partner()\n    partner.name = \"Novo Cliente LTDA\"\n    partner.cgc_cpf = \"12345678000199\"\n    partner.type_partner = \"C\"  # Cliente\n    partner.active = True\n\n    # Insere\n    created = crud.insert(partner)\n    print(f\"Parceiro criado com c\u00f3digo: {created.code_partner}\")\n</code></pre>"},{"location":"examples/crud-operations/#insercao-com-validacao","title":"Inser\u00e7\u00e3o com Valida\u00e7\u00e3o","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidator\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n    validator = EntityValidator()\n\n    # Cria parceiro\n    partner = Partner()\n    partner.name = \"Novo Fornecedor LTDA\"\n    partner.cgc_cpf = \"98765432000111\"\n    partner.type_partner = \"F\"  # Fornecedor\n\n    # Valida antes de inserir\n    result = validator.validate(partner)\n\n    if result.is_valid:\n        created = crud.insert(partner)\n        print(f\"Criado: {created.code_partner}\")\n    else:\n        for error in result.errors:\n            print(f\"Erro: {error.field} - {error.message}\")\n</code></pre>"},{"location":"examples/crud-operations/#insercao-em-lote","title":"Inser\u00e7\u00e3o em Lote","text":"Python<pre><code>partners_data = [\n    {\"name\": \"Cliente 1\", \"type\": \"C\"},\n    {\"name\": \"Cliente 2\", \"type\": \"C\"},\n    {\"name\": \"Fornecedor 1\", \"type\": \"F\"},\n]\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    created_count = 0\n    for data in partners_data:\n        try:\n            partner = Partner()\n            partner.name = data[\"name\"]\n            partner.type_partner = data[\"type\"]\n            partner.active = True\n\n            crud.insert(partner)\n            created_count += 1\n        except Exception as e:\n            print(f\"Erro ao criar {data['name']}: {e}\")\n\n    print(f\"Criados: {created_count}/{len(partners_data)}\")\n</code></pre>"},{"location":"examples/crud-operations/#update","title":"Update","text":""},{"location":"examples/crud-operations/#atualizacao-simples","title":"Atualiza\u00e7\u00e3o Simples","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Busca parceiro\n    partners = crud.find(Partner, \"CODPARC = 1\")\n\n    if partners:\n        partner = partners[0]\n\n        # Altera campos\n        partner.email = \"novo.email@empresa.com\"\n        partner.phone = \"11999998888\"\n\n        # Atualiza\n        updated = crud.update(partner)\n        print(f\"Atualizado: {updated.name}\")\n</code></pre>"},{"location":"examples/crud-operations/#atualizacao-condicional","title":"Atualiza\u00e7\u00e3o Condicional","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Busca parceiros sem email\n    partners = crud.find(Partner, \"EMAIL IS NULL AND ATIVO = 'S'\")\n\n    updated_count = 0\n    for partner in partners:\n        # Define email padr\u00e3o baseado no nome\n        partner.email = f\"contato@{partner.name.lower().replace(' ', '')}.com\"\n\n        try:\n            crud.update(partner)\n            updated_count += 1\n        except Exception as e:\n            print(f\"Erro ao atualizar {partner.code_partner}: {e}\")\n\n    print(f\"Atualizados: {updated_count}/{len(partners)}\")\n</code></pre>"},{"location":"examples/crud-operations/#atualizacao-com-historico","title":"Atualiza\u00e7\u00e3o com Hist\u00f3rico","text":"Python<pre><code>from sankhya_sdk.helpers import EntityExtensions\nfrom datetime import datetime\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    partners = crud.find(Partner, \"CODPARC = 1\")\n\n    if partners:\n        original = partners[0]\n\n        # Clone para compara\u00e7\u00e3o\n        modified = EntityExtensions.clone(original)\n        modified.email = \"atualizado@email.com\"\n\n        # Verifica mudan\u00e7as\n        changes = EntityExtensions.get_changed_fields(original, modified)\n\n        if changes:\n            print(f\"Campos alterados: {changes}\")\n\n            # Atualiza\n            crud.update(modified)\n            print(f\"Atualizado em {datetime.now()}\")\n</code></pre>"},{"location":"examples/crud-operations/#remove","title":"Remove","text":""},{"location":"examples/crud-operations/#remocao-simples","title":"Remo\u00e7\u00e3o Simples","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Busca parceiro para remover\n    partners = crud.find(Partner, \"CODPARC = 999\")\n\n    if partners:\n        partner = partners[0]\n\n        # Remove\n        success = crud.remove(partner)\n\n        if success:\n            print(f\"Parceiro {partner.code_partner} removido\")\n        else:\n            print(\"Falha ao remover\")\n</code></pre>"},{"location":"examples/crud-operations/#remocao-com-confirmacao","title":"Remo\u00e7\u00e3o com Confirma\u00e7\u00e3o","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Busca parceiros inativos h\u00e1 muito tempo\n    partners = crud.find(\n        Partner,\n        \"ATIVO = 'N' AND DTALTER &lt; '01/01/2020'\"\n    )\n\n    print(f\"Parceiros para remover: {len(partners)}\")\n\n    for partner in partners:\n        confirm = input(f\"Remover {partner.name}? (s/n): \")\n\n        if confirm.lower() == 's':\n            try:\n                crud.remove(partner)\n                print(f\"  Removido: {partner.code_partner}\")\n            except Exception as e:\n                print(f\"  Erro: {e}\")\n</code></pre>"},{"location":"examples/crud-operations/#soft-delete-inativacao","title":"Soft Delete (Inativa\u00e7\u00e3o)","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Em vez de remover, inativa\n    partners = crud.find(Partner, \"CODPARC = 999\")\n\n    if partners:\n        partner = partners[0]\n        partner.active = False  # Inativa em vez de remover\n\n        crud.update(partner)\n        print(f\"Parceiro {partner.code_partner} inativado\")\n</code></pre>"},{"location":"examples/crud-operations/#exemplo-completo","title":"Exemplo Completo","text":"Python<pre><code>#!/usr/bin/env python3\n\"\"\"\nExemplo completo de opera\u00e7\u00f5es CRUD.\n\nDemonstra todas as opera\u00e7\u00f5es b\u00e1sicas com tratamento de erros.\n\"\"\"\n\nfrom sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\nfrom sankhya_sdk.validations import EntityValidator\nfrom sankhya_sdk.exceptions import (\n    SankhyaException,\n    ServiceRequestException,\n    OperationException,\n)\nfrom dotenv import load_dotenv\nimport logging\n\n# Configura\u00e7\u00e3o\nload_dotenv()\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\n\ndef main():\n    try:\n        with SankhyaContext.from_settings() as ctx:\n            crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n            validator = EntityValidator()\n\n            # 1. CREATE\n            logger.info(\"=== CREATE ===\")\n            new_partner = Partner()\n            new_partner.name = \"Teste CRUD Python\"\n            new_partner.type_partner = \"C\"\n            new_partner.active = True\n\n            result = validator.validate(new_partner)\n            if result.is_valid:\n                created = crud.insert(new_partner)\n                partner_id = created.code_partner\n                logger.info(f\"Criado parceiro: {partner_id}\")\n            else:\n                logger.error(f\"Valida\u00e7\u00e3o falhou: {result.errors}\")\n                return\n\n            # 2. READ\n            logger.info(\"=== READ ===\")\n            partners = crud.find(Partner, f\"CODPARC = {partner_id}\")\n            if partners:\n                partner = partners[0]\n                logger.info(f\"Lido: {partner.name}\")\n\n            # 3. UPDATE\n            logger.info(\"=== UPDATE ===\")\n            partner.email = \"teste@example.com\"\n            updated = crud.update(partner)\n            logger.info(f\"Atualizado email: {updated.email}\")\n\n            # 4. DELETE\n            logger.info(\"=== DELETE ===\")\n            success = crud.remove(partner)\n            logger.info(f\"Removido: {success}\")\n\n            logger.info(\"CRUD completo!\")\n\n    except ServiceRequestException as e:\n        logger.error(f\"Erro de servi\u00e7o: {e.status_message}\")\n    except OperationException as e:\n        logger.error(f\"Erro de opera\u00e7\u00e3o: {e.message}\")\n    except SankhyaException as e:\n        logger.error(f\"Erro SDK: {e.message}\")\n    except Exception as e:\n        logger.exception(f\"Erro inesperado: {e}\")\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"examples/crud-operations/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Requisi\u00e7\u00f5es Paginadas - Grandes volumes</li> <li>Queries Avan\u00e7adas - Filtros complexos</li> <li>Tratamento de Erros - Exce\u00e7\u00f5es</li> </ul>"},{"location":"examples/custom-entities/","title":"Entidades Customizadas","text":"<p>Exemplos de cria\u00e7\u00e3o de entidades para tabelas customizadas.</p>"},{"location":"examples/custom-entities/#estrutura-basica","title":"Estrutura B\u00e1sica","text":"Python<pre><code>from sankhya_sdk.attributes import entity, entity_key, entity_element\nfrom sankhya_sdk.transport_entities import EntityBase\n\n@entity(\"MeuCampo\", \"AD_MEUCAMPO\")\nclass MinhaEntidade(EntityBase):\n    \"\"\"Entidade para tabela customizada AD_MEUCAMPO.\"\"\"\n\n    @entity_key(\"IDCAMPO\")\n    id_campo: int\n\n    @entity_element(\"DESCRICAO\")\n    descricao: str\n\n    @entity_element(\"VALOR\", required=False)\n    valor: float = 0.0\n</code></pre>"},{"location":"examples/custom-entities/#com-tipos-complexos","title":"Com Tipos Complexos","text":"Python<pre><code>from datetime import date, datetime\nfrom decimal import Decimal\n\n@entity(\"Contrato\", \"AD_CONTRATO\")\nclass Contrato(EntityBase):\n    @entity_key(\"IDCONTRATO\")\n    id: int\n\n    @entity_element(\"CODPARC\")\n    code_partner: int\n\n    @entity_element(\"DTINICIO\")\n    data_inicio: date\n\n    @entity_element(\"DTFIM\")\n    data_fim: date\n\n    @entity_element(\"VLRTOTAL\")\n    valor_total: Decimal\n\n    @entity_element(\"ATIVO\", required=False)\n    ativo: bool = True\n</code></pre>"},{"location":"examples/custom-entities/#uso-com-crud","title":"Uso com CRUD","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Find\n    contratos = crud.find(Contrato, \"ATIVO = 'S'\")\n\n    # Insert\n    novo = Contrato()\n    novo.code_partner = 1\n    novo.data_inicio = date.today()\n    novo.valor_total = Decimal(\"10000.00\")\n    crud.insert(novo)\n\n    # Update\n    contrato = contratos[0]\n    contrato.ativo = False\n    crud.update(contrato)\n</code></pre>"},{"location":"examples/custom-entities/#com-validacao-customizada","title":"Com Valida\u00e7\u00e3o Customizada","text":"Python<pre><code>from sankhya_sdk.validations import EntityValidation\n\n@entity(\"Contrato\", \"AD_CONTRATO\")\nclass Contrato(EntityBase):\n    @entity_key(\"IDCONTRATO\")\n    id: int\n\n    @entity_element(\"DTINICIO\")\n    data_inicio: date\n\n    @entity_element(\"DTFIM\")\n    data_fim: date\n\n    def validate(self) -&gt; list[EntityValidation]:\n        errors = super().validate()\n\n        if self.data_fim &lt; self.data_inicio:\n            errors.append(EntityValidation.custom(\n                \"DTFIM\",\n                \"Data fim n\u00e3o pode ser anterior \u00e0 data in\u00edcio\"\n            ))\n\n        return errors\n</code></pre>"},{"location":"examples/custom-entities/#chave-composta","title":"Chave Composta","text":"Python<pre><code>@entity(\"ItemContrato\", \"AD_ITEMCONTRATO\")\nclass ItemContrato(EntityBase):\n    @entity_key(\"IDCONTRATO\")\n    id_contrato: int\n\n    @entity_key(\"SEQUENCIA\")\n    sequencia: int\n\n    @entity_element(\"CODPROD\")\n    code_product: int\n\n    @entity_element(\"QTDE\")\n    quantidade: Decimal\n</code></pre>"},{"location":"examples/custom-entities/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Sistema de Entidades</li> <li>Valida\u00e7\u00f5es</li> </ul>"},{"location":"examples/error-handling/","title":"Tratamento de Erros","text":"<p>Exemplos de tratamento de exce\u00e7\u00f5es e retry.</p>"},{"location":"examples/error-handling/#tratamento-basico","title":"Tratamento B\u00e1sico","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.exceptions import (\n    SankhyaException,\n    ServiceRequestException,\n    ServiceRequestInvalidAuthorizationException,\n)\n\ntry:\n    with SankhyaContext.from_settings() as ctx:\n        result = ctx.wrapper.find(Partner, \"CODPARC &gt; 0\")\n\nexcept ServiceRequestInvalidAuthorizationException:\n    print(\"Credenciais inv\u00e1lidas\")\n\nexcept ServiceRequestException as e:\n    print(f\"Erro de servi\u00e7o: {e.status_message}\")\n\nexcept SankhyaException as e:\n    print(f\"Erro SDK: {e.message}\")\n</code></pre>"},{"location":"examples/error-handling/#retry-com-backoff","title":"Retry com Backoff","text":"Python<pre><code>import time\n\ndef execute_with_retry(func, max_retries=3, delay=1.0):\n    \"\"\"Executa fun\u00e7\u00e3o com retry exponencial.\"\"\"\n    for attempt in range(max_retries):\n        try:\n            return func()\n        except ServiceRequestException as e:\n            if attempt &lt; max_retries - 1:\n                wait = delay * (2 ** attempt)\n                print(f\"Retry em {wait}s...\")\n                time.sleep(wait)\n            else:\n                raise\n\n# Uso\nresult = execute_with_retry(lambda: crud.find(Partner))\n</code></pre>"},{"location":"examples/error-handling/#retry-por-tipo-de-erro","title":"Retry por Tipo de Erro","text":"Python<pre><code>from sankhya_sdk.exceptions import (\n    ServiceRequestCompetitionException,\n    ServiceRequestDeadlockException,\n)\n\ndef smart_retry(func, max_retries=3):\n    for attempt in range(max_retries):\n        try:\n            return func()\n        except ServiceRequestInvalidAuthorizationException:\n            raise  # N\u00e3o retry\n        except ServiceRequestCompetitionException as e:\n            time.sleep(e.retry_after or 5)\n        except ServiceRequestDeadlockException:\n            time.sleep(1)\n</code></pre>"},{"location":"examples/error-handling/#processamento-em-lote","title":"Processamento em Lote","text":"Python<pre><code>def process_batch(crud, items, operation):\n    \"\"\"Processa lote coletando erros.\"\"\"\n    success, failed = [], []\n\n    for item in items:\n        try:\n            if operation == \"update\":\n                crud.update(item)\n            success.append(item)\n        except ServiceRequestException as e:\n            failed.append((item, str(e)))\n\n    return {\"success\": len(success), \"failed\": len(failed)}\n</code></pre>"},{"location":"examples/error-handling/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Entidades Customizadas</li> <li>Exce\u00e7\u00f5es</li> </ul>"},{"location":"examples/file-operations/","title":"Opera\u00e7\u00f5es com Arquivos","text":"<p>Exemplos de download e upload de arquivos e imagens.</p>"},{"location":"examples/file-operations/#download-de-arquivo","title":"Download de Arquivo","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nwith SankhyaContext.from_settings() as ctx:\n    # Baixa arquivo\n    content = ctx.wrapper.get_file(\"relatorio.pdf\")\n\n    # Salva localmente\n    with open(\"relatorio.pdf\", \"wb\") as f:\n        f.write(content)\n\n    print(\"Arquivo baixado com sucesso!\")\n</code></pre>"},{"location":"examples/file-operations/#download-de-imagem","title":"Download de Imagem","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.transport_entities import Product\n\nwith SankhyaContext.from_settings() as ctx:\n    # Baixa imagem de produto\n    image_data = ctx.wrapper.get_image(\n        primary_key={\"CODPROD\": 100},\n        entity_name=\"Produto\"\n    )\n\n    # Salva imagem\n    with open(\"produto_100.jpg\", \"wb\") as f:\n        f.write(image_data)\n\n    print(\"Imagem baixada!\")\n</code></pre>"},{"location":"examples/file-operations/#download-em-lote","title":"Download em Lote","text":"Python<pre><code>import os\nfrom sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Product\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Busca produtos\n    products = crud.find(Product, \"ATIVO = 'S'\", max_results=50)\n\n    # Cria diret\u00f3rio\n    os.makedirs(\"product_images\", exist_ok=True)\n\n    downloaded = 0\n    for product in products:\n        try:\n            image = ctx.wrapper.get_image(\n                {\"CODPROD\": product.code_product},\n                \"Produto\"\n            )\n\n            if image:\n                path = f\"product_images/{product.code_product}.jpg\"\n                with open(path, \"wb\") as f:\n                    f.write(image)\n                downloaded += 1\n        except Exception as e:\n            print(f\"Erro {product.code_product}: {e}\")\n\n    print(f\"Baixadas: {downloaded}/{len(products)} imagens\")\n</code></pre>"},{"location":"examples/file-operations/#upload-de-arquivo","title":"Upload de Arquivo","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.service_models import ServiceRequest, RequestBody\n\nwith SankhyaContext.from_settings() as ctx:\n    # L\u00ea arquivo\n    with open(\"documento.pdf\", \"rb\") as f:\n        file_content = f.read()\n\n    # Prepara requisi\u00e7\u00e3o de upload\n    request = ServiceRequest(\n        service_name=\"FileService.uploadFile\",\n        request_body=RequestBody(\n            filename=\"documento.pdf\",\n            content=file_content\n        )\n    )\n\n    response = ctx.wrapper.invoke_service(\"FileService.uploadFile\", request)\n\n    if response.is_success:\n        print(\"Arquivo enviado!\")\n    else:\n        print(f\"Erro: {response.status_message}\")\n</code></pre>"},{"location":"examples/file-operations/#usando-knowservicesrequestwrapper","title":"Usando KnowServicesRequestWrapper","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import KnowServicesRequestWrapper\n\nwith SankhyaContext.from_settings() as ctx:\n    services = KnowServicesRequestWrapper(ctx.wrapper)\n\n    # Download de arquivo\n    content = services.get_file(\"relatorio_vendas.pdf\")\n\n    with open(\"vendas.pdf\", \"wb\") as f:\n        f.write(content)\n\n    # Download de imagem\n    image = services.get_image(\n        primary_key={\"CODPARCEIRO\": 1},\n        entity_name=\"Parceiro\"\n    )\n\n    with open(\"parceiro_1.jpg\", \"wb\") as f:\n        f.write(image)\n</code></pre>"},{"location":"examples/file-operations/#tratamento-de-erros","title":"Tratamento de Erros","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.exceptions import ServiceRequestException\n\nwith SankhyaContext.from_settings() as ctx:\n    try:\n        content = ctx.wrapper.get_file(\"arquivo_inexistente.pdf\")\n\n    except ServiceRequestException as e:\n        if \"not found\" in e.status_message.lower():\n            print(\"Arquivo n\u00e3o encontrado\")\n        else:\n            print(f\"Erro: {e.status_message}\")\n\n    except Exception as e:\n        print(f\"Erro inesperado: {e}\")\n</code></pre>"},{"location":"examples/file-operations/#download-assincrono","title":"Download Ass\u00edncrono","text":"Python<pre><code>import asyncio\nfrom sankhya_sdk import AsyncSankhyaContext\n\nasync def download_file(ctx, filename):\n    \"\"\"Download ass\u00edncrono de arquivo.\"\"\"\n    content = await ctx.wrapper.get_file_async(filename)\n    return content\n\nasync def main():\n    async with AsyncSankhyaContext.from_settings() as ctx:\n        # Download m\u00faltiplos arquivos em paralelo\n        filenames = [\"rel1.pdf\", \"rel2.pdf\", \"rel3.pdf\"]\n\n        tasks = [download_file(ctx, name) for name in filenames]\n        results = await asyncio.gather(*tasks, return_exceptions=True)\n\n        for filename, result in zip(filenames, results):\n            if isinstance(result, Exception):\n                print(f\"Erro {filename}: {result}\")\n            else:\n                with open(f\"downloads/{filename}\", \"wb\") as f:\n                    f.write(result)\n                print(f\"Baixado: {filename}\")\n\nasyncio.run(main())\n</code></pre>"},{"location":"examples/file-operations/#exemplo-completo","title":"Exemplo Completo","text":"Python<pre><code>#!/usr/bin/env python3\n\"\"\"\nExemplo completo de opera\u00e7\u00f5es com arquivos.\n\nDemonstra download em lote com progresso e tratamento de erros.\n\"\"\"\n\nimport os\nfrom pathlib import Path\nfrom sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Product\nfrom sankhya_sdk.exceptions import ServiceRequestException\nfrom dotenv import load_dotenv\nimport logging\n\nload_dotenv()\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\n\nclass ProductImageDownloader:\n    \"\"\"Baixa imagens de produtos.\"\"\"\n\n    def __init__(self, context, output_dir=\"product_images\"):\n        self.context = context\n        self.output_dir = Path(output_dir)\n        self.output_dir.mkdir(parents=True, exist_ok=True)\n        self.downloaded = 0\n        self.failed = 0\n        self.skipped = 0\n\n    def download_all(self, criteria=\"ATIVO = 'S'\", max_products=100):\n        \"\"\"Baixa todas as imagens de produtos.\"\"\"\n        crud = SimpleCRUDRequestWrapper(self.context.wrapper)\n        products = crud.find(Product, criteria, max_results=max_products)\n\n        logger.info(f\"Encontrados {len(products)} produtos\")\n\n        for i, product in enumerate(products, 1):\n            self._download_product_image(product)\n\n            if i % 10 == 0:\n                logger.info(f\"Progresso: {i}/{len(products)}\")\n\n        return self._summary()\n\n    def _download_product_image(self, product):\n        \"\"\"Baixa imagem de um produto.\"\"\"\n        filepath = self.output_dir / f\"{product.code_product}.jpg\"\n\n        # Pula se j\u00e1 existe\n        if filepath.exists():\n            self.skipped += 1\n            return\n\n        try:\n            image = self.context.wrapper.get_image(\n                {\"CODPROD\": product.code_product},\n                \"Produto\"\n            )\n\n            if image and len(image) &gt; 100:  # Ignora imagens muito pequenas\n                filepath.write_bytes(image)\n                self.downloaded += 1\n            else:\n                self.skipped += 1\n\n        except ServiceRequestException as e:\n            self.failed += 1\n            logger.warning(f\"Produto {product.code_product}: {e.status_message}\")\n        except Exception as e:\n            self.failed += 1\n            logger.error(f\"Produto {product.code_product}: {e}\")\n\n    def _summary(self):\n        \"\"\"Retorna resumo do download.\"\"\"\n        return {\n            \"downloaded\": self.downloaded,\n            \"failed\": self.failed,\n            \"skipped\": self.skipped,\n            \"total\": self.downloaded + self.failed + self.skipped\n        }\n\n\ndef main():\n    with SankhyaContext.from_settings() as ctx:\n        downloader = ProductImageDownloader(ctx)\n        result = downloader.download_all(max_products=50)\n\n        logger.info(\"=== Resumo ===\")\n        logger.info(f\"Baixadas: {result['downloaded']}\")\n        logger.info(f\"Falhas: {result['failed']}\")\n        logger.info(f\"Puladas: {result['skipped']}\")\n        logger.info(f\"Total: {result['total']}\")\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"examples/file-operations/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Queries Avan\u00e7adas - Filtros complexos</li> <li>Tratamento de Erros - Exce\u00e7\u00f5es</li> <li>Request Wrappers - API completa</li> </ul>"},{"location":"examples/paged-requests/","title":"Requisi\u00e7\u00f5es Paginadas","text":"<p>Exemplos de consultas paginadas para grandes volumes de dados.</p>"},{"location":"examples/paged-requests/#uso-basico","title":"Uso B\u00e1sico","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import PagedRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nwith SankhyaContext.from_settings() as ctx:\n    paged = PagedRequestWrapper(ctx.wrapper)\n\n    # Itera sobre todos os parceiros ativos\n    count = 0\n    for partner in paged.get_paged_results(Partner, \"ATIVO = 'S'\"):\n        count += 1\n        print(f\"{partner.code_partner}: {partner.name}\")\n\n    print(f\"Total: {count} parceiros\")\n</code></pre>"},{"location":"examples/paged-requests/#configuracao","title":"Configura\u00e7\u00e3o","text":""},{"location":"examples/paged-requests/#parametros-do-wrapper","title":"Par\u00e2metros do Wrapper","text":"Python<pre><code>paged = PagedRequestWrapper(\n    wrapper=ctx.wrapper,\n    page_size=100,        # Itens por p\u00e1gina\n    max_results=5000,     # Limite total (0 = sem limite)\n    timeout=600,          # Timeout em segundos\n    enable_cache=True     # Cache em mem\u00f3ria\n)\n</code></pre>"},{"location":"examples/paged-requests/#com-opcoes-de-query","title":"Com Op\u00e7\u00f5es de Query","text":"Python<pre><code>from sankhya_sdk.helpers import EntityQueryOptions\n\noptions = EntityQueryOptions(\n    include_fields=[\"CODPARC\", \"NOMEPARC\", \"EMAIL\"],\n    order_by=\"NOMEPARC ASC\"\n)\n\nfor partner in paged.get_paged_results_with_options(\n    Partner,\n    \"ATIVO = 'S'\",\n    options\n):\n    process(partner)\n</code></pre>"},{"location":"examples/paged-requests/#callbacks","title":"Callbacks","text":""},{"location":"examples/paged-requests/#monitorando-progresso","title":"Monitorando Progresso","text":"Python<pre><code>from sankhya_sdk.value_objects import PagedRequestEventArgs\n\ndef on_page_loaded(args: PagedRequestEventArgs):\n    \"\"\"Chamado quando uma p\u00e1gina \u00e9 carregada.\"\"\"\n    print(f\"P\u00e1gina {args.current_page}/{args.total_pages}\")\n    print(f\"  Itens na p\u00e1gina: {args.items_in_page}\")\n    print(f\"  Total processado: {args.total_processed}\")\n\ndef on_page_processed(args: PagedRequestEventArgs):\n    \"\"\"Chamado quando uma p\u00e1gina \u00e9 processada.\"\"\"\n    elapsed = args.elapsed_time_ms / 1000\n    print(f\"  Processada em {elapsed:.2f}s\")\n\ndef on_error(args: PagedRequestEventArgs):\n    \"\"\"Chamado em caso de erro.\"\"\"\n    print(f\"Erro na p\u00e1gina {args.current_page}: {args.error}\")\n    # Retorne True para continuar, False para parar\n    return True\n\n# Configura callbacks\npaged.on_page_loaded = on_page_loaded\npaged.on_page_processed = on_page_processed\npaged.on_error = on_error\n\n# Executa\nfor partner in paged.get_paged_results(Partner, \"CODPARC &gt; 0\"):\n    process(partner)\n</code></pre>"},{"location":"examples/paged-requests/#processamento-em-lote","title":"Processamento em Lote","text":""},{"location":"examples/paged-requests/#processar-por-lotes","title":"Processar por Lotes","text":"Python<pre><code>def process_batch(partners: list[Partner]):\n    \"\"\"Processa um lote de parceiros.\"\"\"\n    for partner in partners:\n        # L\u00f3gica de processamento\n        update_external_system(partner)\n\n    return len(partners)\n\nwith SankhyaContext.from_settings() as ctx:\n    paged = PagedRequestWrapper(ctx.wrapper, page_size=50)\n\n    batch = []\n    processed = 0\n\n    for partner in paged.get_paged_results(Partner, \"ATIVO = 'S'\"):\n        batch.append(partner)\n\n        # Processa a cada 50 itens\n        if len(batch) &gt;= 50:\n            processed += process_batch(batch)\n            print(f\"Processados: {processed}\")\n            batch = []\n\n    # Processa \u00faltimos itens\n    if batch:\n        processed += process_batch(batch)\n\n    print(f\"Total processado: {processed}\")\n</code></pre>"},{"location":"examples/paged-requests/#limitando-resultados","title":"Limitando Resultados","text":""},{"location":"examples/paged-requests/#com-max_results","title":"Com max_results","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    paged = PagedRequestWrapper(\n        ctx.wrapper,\n        page_size=100,\n        max_results=500  # M\u00e1ximo 500 resultados\n    )\n\n    count = 0\n    for partner in paged.get_paged_results(Partner, \"CODPARC &gt; 0\"):\n        count += 1\n        print(f\"{count}: {partner.name}\")\n\n    print(f\"Total: {count}\")  # M\u00e1ximo 500\n</code></pre>"},{"location":"examples/paged-requests/#interrupcao-manual","title":"Interrup\u00e7\u00e3o Manual","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    paged = PagedRequestWrapper(ctx.wrapper)\n\n    found_target = False\n\n    for partner in paged.get_paged_results(Partner, \"CODPARC &gt; 0\"):\n        if partner.name == \"ALVO\":\n            print(f\"Encontrado: {partner.code_partner}\")\n            found_target = True\n            break  # Para a itera\u00e7\u00e3o\n\n    if not found_target:\n        print(\"Alvo n\u00e3o encontrado\")\n</code></pre>"},{"location":"examples/paged-requests/#versao-assincrona","title":"Vers\u00e3o Ass\u00edncrona","text":"Python<pre><code>import asyncio\nfrom sankhya_sdk import AsyncSankhyaContext\nfrom sankhya_sdk.request_wrappers import AsyncPagedRequestWrapper\n\nasync def process_partners():\n    async with AsyncSankhyaContext.from_settings() as ctx:\n        paged = AsyncPagedRequestWrapper(ctx.wrapper)\n\n        count = 0\n        async for partner in paged.get_paged_results_async(\n            Partner,\n            \"ATIVO = 'S'\"\n        ):\n            count += 1\n            await process_async(partner)\n\n        print(f\"Processados: {count}\")\n\nasyncio.run(process_partners())\n</code></pre>"},{"location":"examples/paged-requests/#cache-de-resultados","title":"Cache de Resultados","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    paged = PagedRequestWrapper(\n        ctx.wrapper,\n        enable_cache=True  # Habilita cache\n    )\n\n    # Primeira itera\u00e7\u00e3o - carrega da API\n    partners_1 = list(paged.get_paged_results(Partner, \"ATIVO = 'S'\"))\n    print(f\"Primeira: {len(partners_1)} parceiros\")\n\n    # Segunda itera\u00e7\u00e3o - usa cache\n    partners_2 = list(paged.get_paged_results(Partner, \"ATIVO = 'S'\"))\n    print(f\"Segunda: {len(partners_2)} parceiros (do cache)\")\n\n    # Limpar cache\n    paged.clear_cache()\n</code></pre>"},{"location":"examples/paged-requests/#tratamento-de-erros","title":"Tratamento de Erros","text":"Python<pre><code>from sankhya_sdk.exceptions import PagedRequestException\n\ndef on_error(args):\n    \"\"\"Handler de erro que tenta recuperar.\"\"\"\n    print(f\"Erro na p\u00e1gina {args.current_page}: {args.error}\")\n\n    # Tenta at\u00e9 3 vezes\n    if args.retry_count &lt; 3:\n        args.should_retry = True\n        args.retry_delay_ms = 1000 * (args.retry_count + 1)\n        return True  # Continuar\n\n    return False  # Parar\n\nwith SankhyaContext.from_settings() as ctx:\n    paged = PagedRequestWrapper(ctx.wrapper)\n    paged.on_error = on_error\n\n    try:\n        for partner in paged.get_paged_results(Partner, \"CODPARC &gt; 0\"):\n            process(partner)\n    except PagedRequestException as e:\n        print(f\"Falha ap\u00f3s retries: {e}\")\n        print(f\"\u00daltima p\u00e1gina: {e.page_number}/{e.total_pages}\")\n</code></pre>"},{"location":"examples/paged-requests/#exportacao-para-arquivo","title":"Exporta\u00e7\u00e3o para Arquivo","text":"Python<pre><code>import csv\n\nwith SankhyaContext.from_settings() as ctx:\n    paged = PagedRequestWrapper(ctx.wrapper, page_size=500)\n\n    with open(\"partners.csv\", \"w\", newline=\"\", encoding=\"utf-8\") as f:\n        writer = csv.writer(f)\n        writer.writerow([\"C\u00f3digo\", \"Nome\", \"CNPJ/CPF\", \"Email\"])\n\n        count = 0\n        for partner in paged.get_paged_results(Partner, \"ATIVO = 'S'\"):\n            writer.writerow([\n                partner.code_partner,\n                partner.name,\n                partner.cgc_cpf or \"\",\n                partner.email or \"\"\n            ])\n            count += 1\n\n            if count % 1000 == 0:\n                print(f\"Exportados: {count}\")\n\n        print(f\"Total exportado: {count}\")\n</code></pre>"},{"location":"examples/paged-requests/#exemplo-completo","title":"Exemplo Completo","text":"Python<pre><code>#!/usr/bin/env python3\n\"\"\"\nExemplo completo de requisi\u00e7\u00f5es paginadas.\n\nDemonstra pagina\u00e7\u00e3o com callbacks, progresso e exporta\u00e7\u00e3o.\n\"\"\"\n\nfrom sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import PagedRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\nfrom sankhya_sdk.value_objects import PagedRequestEventArgs\nfrom sankhya_sdk.exceptions import PagedRequestException\nfrom dotenv import load_dotenv\nimport json\nimport logging\nfrom datetime import datetime\n\nload_dotenv()\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\n\nclass PartnerExporter:\n    \"\"\"Exporta parceiros com pagina\u00e7\u00e3o.\"\"\"\n\n    def __init__(self, context):\n        self.context = context\n        self.paged = PagedRequestWrapper(\n            context.wrapper,\n            page_size=100,\n            timeout=600\n        )\n        self.paged.on_page_loaded = self._on_page_loaded\n        self.paged.on_error = self._on_error\n        self.total = 0\n        self.errors = 0\n\n    def _on_page_loaded(self, args: PagedRequestEventArgs):\n        elapsed = args.elapsed_time_ms / 1000\n        logger.info(\n            f\"P\u00e1gina {args.current_page}/{args.total_pages} \"\n            f\"({args.items_in_page} itens) em {elapsed:.2f}s\"\n        )\n\n    def _on_error(self, args: PagedRequestEventArgs):\n        self.errors += 1\n        logger.error(f\"Erro p\u00e1gina {args.current_page}: {args.error}\")\n        return True  # Continuar\n\n    def export(self, criteria: str, output_file: str):\n        \"\"\"Exporta parceiros para JSON.\"\"\"\n        partners = []\n\n        try:\n            for partner in self.paged.get_paged_results(Partner, criteria):\n                partners.append({\n                    \"codigo\": partner.code_partner,\n                    \"nome\": partner.name,\n                    \"cnpj_cpf\": partner.cgc_cpf,\n                    \"email\": partner.email,\n                    \"tipo\": partner.type_partner,\n                })\n                self.total += 1\n        except PagedRequestException as e:\n            logger.error(f\"Pagina\u00e7\u00e3o interrompida: {e}\")\n\n        # Salva resultado\n        with open(output_file, \"w\", encoding=\"utf-8\") as f:\n            json.dump({\n                \"exported_at\": datetime.now().isoformat(),\n                \"total\": self.total,\n                \"errors\": self.errors,\n                \"partners\": partners\n            }, f, indent=2, ensure_ascii=False)\n\n        logger.info(f\"Exportados {self.total} parceiros para {output_file}\")\n\n\ndef main():\n    with SankhyaContext.from_settings() as ctx:\n        exporter = PartnerExporter(ctx)\n        exporter.export(\"ATIVO = 'S'\", \"partners_export.json\")\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"examples/paged-requests/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Gerenciamento de Sess\u00f5es - Multi-threading</li> <li>Queries Avan\u00e7adas - Filtros complexos</li> <li>Tratamento de Erros - Exce\u00e7\u00f5es</li> </ul>"},{"location":"examples/session-management/","title":"Gerenciamento de Sess\u00f5es","text":"<p>Exemplos de gerenciamento de sess\u00f5es, multi-threading e async/await.</p>"},{"location":"examples/session-management/#sessao-unica","title":"Sess\u00e3o \u00danica","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\n# Context manager gerencia login/logout automaticamente\nwith SankhyaContext.from_settings() as ctx:\n    print(f\"Conectado: {ctx.user_code}\")\n    # Opera\u00e7\u00f5es...\n# Logout autom\u00e1tico\n</code></pre>"},{"location":"examples/session-management/#multiplas-sessoes","title":"M\u00faltiplas Sess\u00f5es","text":""},{"location":"examples/session-management/#adquirir-e-finalizar","title":"Adquirir e Finalizar","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\n\nctx = SankhyaContext.from_settings()\n\n# Adquire sess\u00f5es paralelas\ntoken1 = ctx.acquire_session()\ntoken2 = ctx.acquire_session()\n\nprint(f\"Sess\u00e3o 1: {token1}\")\nprint(f\"Sess\u00e3o 2: {token2}\")\n\n# Usa sess\u00f5es espec\u00edficas\nresult1 = ctx.invoke_with_token(token1, \"ServiceName\", request1)\nresult2 = ctx.invoke_with_token(token2, \"ServiceName\", request2)\n\n# Finaliza sess\u00f5es\nctx.finalize_session(token1)\nctx.finalize_session(token2)\n\n# Fecha contexto principal\nctx.dispose()\n</code></pre>"},{"location":"examples/session-management/#multi-threading","title":"Multi-threading","text":""},{"location":"examples/session-management/#threadpoolexecutor","title":"ThreadPoolExecutor","text":"Python<pre><code>import threading\nfrom concurrent.futures import ThreadPoolExecutor, as_completed\nfrom sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\n\ndef process_partner(ctx, partner_id):\n    \"\"\"Processa parceiro em thread separada.\"\"\"\n    token = ctx.acquire_session()\n    try:\n        # Cada thread tem sess\u00e3o pr\u00f3pria\n        wrapper = ctx.get_wrapper_for_token(token)\n        crud = SimpleCRUDRequestWrapper(wrapper)\n\n        partners = crud.find(Partner, f\"CODPARC = {partner_id}\")\n        if partners:\n            partner = partners[0]\n            partner.email = f\"updated_{partner_id}@email.com\"\n            crud.update(partner)\n            return f\"Atualizado: {partner_id}\"\n        return f\"N\u00e3o encontrado: {partner_id}\"\n    finally:\n        ctx.finalize_session(token)\n\n# Uso\nctx = SankhyaContext.from_settings()\npartner_ids = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n\nwith ThreadPoolExecutor(max_workers=5) as executor:\n    futures = {\n        executor.submit(process_partner, ctx, pid): pid\n        for pid in partner_ids\n    }\n\n    for future in as_completed(futures):\n        pid = futures[future]\n        try:\n            result = future.result()\n            print(result)\n        except Exception as e:\n            print(f\"Erro {pid}: {e}\")\n\nctx.dispose()\n</code></pre>"},{"location":"examples/session-management/#thread-locks","title":"Thread Locks","text":"Python<pre><code>import threading\nfrom sankhya_sdk import SankhyaContext\n\nctx = SankhyaContext.from_settings()\nresults = []\nresults_lock = threading.Lock()\n\ndef worker(thread_id, items):\n    \"\"\"Worker thread com lock para resultados.\"\"\"\n    token = ctx.acquire_session()\n    local_results = []\n\n    try:\n        for item in items:\n            result = process_item(ctx, token, item)\n            local_results.append(result)\n    finally:\n        ctx.finalize_session(token)\n\n    # Adiciona resultados de forma thread-safe\n    with results_lock:\n        results.extend(local_results)\n\n# Divide trabalho\nall_items = list(range(100))\nchunks = [all_items[i:i+20] for i in range(0, len(all_items), 20)]\n\nthreads = [\n    threading.Thread(target=worker, args=(i, chunk))\n    for i, chunk in enumerate(chunks)\n]\n\nfor t in threads:\n    t.start()\n\nfor t in threads:\n    t.join()\n\nprint(f\"Total processado: {len(results)}\")\nctx.dispose()\n</code></pre>"},{"location":"examples/session-management/#asyncawait","title":"Async/Await","text":""},{"location":"examples/session-management/#basico","title":"B\u00e1sico","text":"Python<pre><code>import asyncio\nfrom sankhya_sdk import AsyncSankhyaContext\nfrom sankhya_sdk.request_wrappers import AsyncSimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\n\nasync def main():\n    async with AsyncSankhyaContext.from_settings() as ctx:\n        crud = AsyncSimpleCRUDRequestWrapper(ctx.wrapper)\n\n        # Busca ass\u00edncrona\n        partners = await crud.find(Partner, \"ATIVO = 'S'\")\n\n        for partner in partners[:5]:\n            print(f\"{partner.code_partner}: {partner.name}\")\n\nasyncio.run(main())\n</code></pre>"},{"location":"examples/session-management/#operacoes-paralelas","title":"Opera\u00e7\u00f5es Paralelas","text":"Python<pre><code>import asyncio\nfrom sankhya_sdk import AsyncSankhyaContext\n\nasync def fetch_partner(ctx, partner_id):\n    \"\"\"Busca parceiro de forma ass\u00edncrona.\"\"\"\n    partners = await ctx.wrapper.find_async(Partner, f\"CODPARC = {partner_id}\")\n    return partners[0] if partners else None\n\nasync def main():\n    async with AsyncSankhyaContext.from_settings() as ctx:\n        # Busca m\u00faltiplos parceiros em paralelo\n        partner_ids = [1, 2, 3, 4, 5]\n\n        tasks = [fetch_partner(ctx, pid) for pid in partner_ids]\n        partners = await asyncio.gather(*tasks)\n\n        for partner in partners:\n            if partner:\n                print(f\"{partner.code_partner}: {partner.name}\")\n\nasyncio.run(main())\n</code></pre>"},{"location":"examples/session-management/#semaphore-para-limite-de-concorrencia","title":"Semaphore para Limite de Concorr\u00eancia","text":"Python<pre><code>import asyncio\nfrom sankhya_sdk import AsyncSankhyaContext\n\nasync def process_with_semaphore(sem, ctx, item):\n    \"\"\"Processa com limite de concorr\u00eancia.\"\"\"\n    async with sem:\n        result = await ctx.wrapper.find_async(Partner, f\"CODPARC = {item}\")\n        return result\n\nasync def main():\n    async with AsyncSankhyaContext.from_settings() as ctx:\n        # M\u00e1ximo 10 requisi\u00e7\u00f5es simult\u00e2neas\n        sem = asyncio.Semaphore(10)\n\n        items = list(range(1, 101))\n\n        tasks = [process_with_semaphore(sem, ctx, item) for item in items]\n        results = await asyncio.gather(*tasks)\n\n        print(f\"Processados: {len(results)}\")\n\nasyncio.run(main())\n</code></pre>"},{"location":"examples/session-management/#sessoes-detachadas","title":"Sess\u00f5es Detachadas","text":""},{"location":"examples/session-management/#detach-e-attach","title":"Detach e Attach","text":"Python<pre><code>import pickle\nfrom sankhya_sdk import SankhyaContext\n\n# Processo 1: Cria e detacha sess\u00e3o\nctx1 = SankhyaContext.from_settings()\ntoken = ctx1.acquire_session()\n\n# Serializa sess\u00e3o para transfer\u00eancia\nsession_data = ctx1.detach_session(token)\nserialized = pickle.dumps(session_data)\n\n# Simula envio para outro processo\n# send_to_other_process(serialized)\n\n# Processo 2: Recebe e usa sess\u00e3o\nreceived = pickle.loads(serialized)\nctx2 = SankhyaContext.from_settings()\nctx2.attach_session(token, received)\n\n# Usa sess\u00e3o do processo 1\nresult = ctx2.invoke_with_token(token, \"ServiceName\", request)\n\nctx2.dispose()\nctx1.dispose()\n</code></pre>"},{"location":"examples/session-management/#tratamento-de-sessao-expirada","title":"Tratamento de Sess\u00e3o Expirada","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.exceptions import ServiceRequestInvalidAuthorizationException\n\nctx = SankhyaContext.from_settings()\n\ndef execute_with_retry(operation, max_retries=3):\n    \"\"\"Executa opera\u00e7\u00e3o com retry para sess\u00e3o expirada.\"\"\"\n    for attempt in range(max_retries):\n        try:\n            return operation()\n        except ServiceRequestInvalidAuthorizationException:\n            if attempt &lt; max_retries - 1:\n                print(f\"Sess\u00e3o expirada, reconectando (tentativa {attempt + 1})\")\n                ctx.wrapper.login()  # Reconecta\n            else:\n                raise\n\n# Uso\nresult = execute_with_retry(lambda: ctx.wrapper.find(Partner, \"CODPARC &gt; 0\"))\n</code></pre>"},{"location":"examples/session-management/#exemplo-completo","title":"Exemplo Completo","text":"Python<pre><code>#!/usr/bin/env python3\n\"\"\"\nExemplo completo de gerenciamento de sess\u00f5es.\n\nDemonstra multi-threading com pool de sess\u00f5es.\n\"\"\"\n\nimport threading\nfrom concurrent.futures import ThreadPoolExecutor, as_completed\nfrom sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\nfrom dotenv import load_dotenv\nimport logging\n\nload_dotenv()\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\n\nclass SessionPool:\n    \"\"\"Pool de sess\u00f5es para uso multi-thread.\"\"\"\n\n    def __init__(self, context, pool_size=5):\n        self.context = context\n        self.pool_size = pool_size\n        self._lock = threading.Lock()\n        self._available = []\n        self._in_use = set()\n\n        # Cria sess\u00f5es\n        for _ in range(pool_size):\n            token = context.acquire_session()\n            self._available.append(token)\n\n        logger.info(f\"Pool criado com {pool_size} sess\u00f5es\")\n\n    def acquire(self):\n        \"\"\"Adquire sess\u00e3o do pool.\"\"\"\n        with self._lock:\n            if not self._available:\n                raise RuntimeError(\"Sem sess\u00f5es dispon\u00edveis\")\n\n            token = self._available.pop()\n            self._in_use.add(token)\n            return token\n\n    def release(self, token):\n        \"\"\"Devolve sess\u00e3o ao pool.\"\"\"\n        with self._lock:\n            if token in self._in_use:\n                self._in_use.remove(token)\n                self._available.append(token)\n\n    def dispose(self):\n        \"\"\"Fecha todas as sess\u00f5es.\"\"\"\n        for token in self._available + list(self._in_use):\n            try:\n                self.context.finalize_session(token)\n            except Exception as e:\n                logger.error(f\"Erro ao fechar sess\u00e3o {token}: {e}\")\n\n\ndef process_batch(pool, context, batch_id, items):\n    \"\"\"Processa lote usando sess\u00e3o do pool.\"\"\"\n    token = pool.acquire()\n    try:\n        wrapper = context.get_wrapper_for_token(token)\n        crud = SimpleCRUDRequestWrapper(wrapper)\n\n        processed = 0\n        for item in items:\n            partners = crud.find(Partner, f\"CODPARC = {item}\")\n            if partners:\n                processed += 1\n\n        logger.info(f\"Batch {batch_id}: processados {processed}/{len(items)}\")\n        return processed\n    finally:\n        pool.release(token)\n\n\ndef main():\n    ctx = SankhyaContext.from_settings()\n    pool = SessionPool(ctx, pool_size=5)\n\n    try:\n        # Divide trabalho em lotes\n        items = list(range(1, 101))\n        batches = [items[i:i+10] for i in range(0, len(items), 10)]\n\n        total = 0\n\n        with ThreadPoolExecutor(max_workers=5) as executor:\n            futures = {\n                executor.submit(process_batch, pool, ctx, i, batch): i\n                for i, batch in enumerate(batches)\n            }\n\n            for future in as_completed(futures):\n                batch_id = futures[future]\n                try:\n                    result = future.result()\n                    total += result\n                except Exception as e:\n                    logger.error(f\"Erro batch {batch_id}: {e}\")\n\n        logger.info(f\"Total processado: {total}\")\n\n    finally:\n        pool.dispose()\n        ctx.dispose()\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"examples/session-management/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Opera\u00e7\u00f5es com Arquivos - Download/upload</li> <li>Tratamento de Erros - Exce\u00e7\u00f5es</li> <li>Arquitetura - Detalhes</li> </ul>"},{"location":"getting-started/","title":"In\u00edcio R\u00e1pido","text":"<p>Bem-vindo \u00e0 se\u00e7\u00e3o de in\u00edcio r\u00e1pido do Sankhya SDK Python! Aqui voc\u00ea encontrar\u00e1 tudo o que precisa para come\u00e7ar a usar o SDK.</p>"},{"location":"getting-started/#primeiros-passos","title":"Primeiros Passos","text":"<ul> <li> <p> Instala\u00e7\u00e3o</p> <p>Configure o SDK em seu ambiente de desenvolvimento em minutos.</p> <p> Instala\u00e7\u00e3o</p> </li> <li> <p> In\u00edcio R\u00e1pido</p> <p>Crie sua primeira integra\u00e7\u00e3o com a API Sankhya em poucos passos.</p> <p> In\u00edcio R\u00e1pido</p> </li> <li> <p> Autentica\u00e7\u00e3o</p> <p>Gerencie credenciais e sess\u00f5es de forma segura.</p> <p> Autentica\u00e7\u00e3o</p> </li> </ul>"},{"location":"getting-started/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<p>Antes de come\u00e7ar, certifique-se de ter:</p> <ul> <li>Python 3.10+ instalado</li> <li>Acesso a uma inst\u00e2ncia Sankhya (produ\u00e7\u00e3o ou homologa\u00e7\u00e3o)</li> <li>Credenciais v\u00e1lidas (usu\u00e1rio e senha)</li> </ul>"},{"location":"getting-started/#exemplo-minimo","title":"Exemplo M\u00ednimo","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\n\n# Conecta usando vari\u00e1veis de ambiente\nwith SankhyaContext.from_settings() as ctx:\n    print(f\"Conectado como: {ctx.user_code}\")\n</code></pre>"},{"location":"getting-started/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<p>Ap\u00f3s configurar o SDK, explore as se\u00e7\u00f5es de Conceitos Fundamentais e Exemplos para aprofundar seu conhecimento.</p>"},{"location":"getting-started/authentication/","title":"Autentica\u00e7\u00e3o","text":"<p>Este guia detalha os m\u00e9todos de autentica\u00e7\u00e3o dispon\u00edveis no SDK e boas pr\u00e1ticas de seguran\u00e7a.</p>"},{"location":"getting-started/authentication/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O Sankhya SDK suporta m\u00faltiplos m\u00e9todos de autentica\u00e7\u00e3o:</p> M\u00e9todo Seguran\u00e7a Uso Recomendado Vari\u00e1veis de ambiente \u2b50\u2b50\u2b50 Desenvolvimento e CI/CD Arquivo .key \u2b50\u2b50\u2b50\u2b50 Produ\u00e7\u00e3o Configura\u00e7\u00e3o direta \u2b50\u2b50 Testes"},{"location":"getting-started/authentication/#metodo-1-variaveis-de-ambiente","title":"M\u00e9todo 1: Vari\u00e1veis de Ambiente","text":""},{"location":"getting-started/authentication/#configuracao","title":"Configura\u00e7\u00e3o","text":"<p>Crie um arquivo <code>.env</code>:</p> INI<pre><code>SANKHYA_BASE_URL=https://api.sankhya.com.br\nSANKHYA_USERNAME=seu_usuario\nSANKHYA_PASSWORD=sua_senha\nSANKHYA_ENVIRONMENT=producao\n</code></pre>"},{"location":"getting-started/authentication/#uso","title":"Uso","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nwith SankhyaContext.from_settings() as ctx:\n    print(f\"Autenticado como: {ctx.user_code}\")\n</code></pre>"},{"location":"getting-started/authentication/#variaveis-disponiveis","title":"Vari\u00e1veis Dispon\u00edveis","text":"Vari\u00e1vel Obrigat\u00f3ria Descri\u00e7\u00e3o <code>SANKHYA_BASE_URL</code> Sim URL base da API <code>SANKHYA_USERNAME</code> Sim Nome de usu\u00e1rio <code>SANKHYA_PASSWORD</code> Sim Senha do usu\u00e1rio <code>SANKHYA_ENVIRONMENT</code> N\u00e3o Ambiente (producao/homologacao/treinamento) <code>SANKHYA_TIMEOUT</code> N\u00e3o Timeout em segundos (padr\u00e3o: 30) <code>SANKHYA_MAX_RETRIES</code> N\u00e3o M\u00e1ximo de tentativas (padr\u00e3o: 3) <code>SANKHYA_LOG_LEVEL</code> N\u00e3o N\u00edvel de log (DEBUG/INFO/WARNING/ERROR)"},{"location":"getting-started/authentication/#metodo-2-arquivo-key","title":"M\u00e9todo 2: Arquivo .key","text":"<p>Para maior seguran\u00e7a em produ\u00e7\u00e3o, use arquivos de chave encriptados.</p>"},{"location":"getting-started/authentication/#criando-um-arquivo-key","title":"Criando um Arquivo .key","text":"Python<pre><code>from sankhya_sdk.core.settings import SankhyaSettings\n\n# Cria configura\u00e7\u00f5es\nsettings = SankhyaSettings(\n    base_url=\"https://api.sankhya.com.br\",\n    username=\"seu_usuario\",\n    password=\"sua_senha\",\n    environment=\"producao\"\n)\n\n# Exporta para arquivo .key (encriptado)\nsettings.to_key_file(\"credenciais.key\", passphrase=\"sua_frase_secreta\")\n</code></pre>"},{"location":"getting-started/authentication/#usando-um-arquivo-key","title":"Usando um Arquivo .key","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.core.settings import SankhyaSettings\n\n# Carrega do arquivo .key\nsettings = SankhyaSettings.from_key_file(\n    \"credenciais.key\",\n    passphrase=\"sua_frase_secreta\"\n)\n\nwith SankhyaContext(settings) as ctx:\n    print(f\"Autenticado via .key: {ctx.user_code}\")\n</code></pre> <p>Seguran\u00e7a</p> <ul> <li>Nunca versione arquivos <code>.key</code></li> <li>Armazene a passphrase em um gerenciador de segredos</li> <li>Use permiss\u00f5es de arquivo restritivas (chmod 600)</li> </ul>"},{"location":"getting-started/authentication/#metodo-3-configuracao-direta","title":"M\u00e9todo 3: Configura\u00e7\u00e3o Direta","text":"<p>Para testes e desenvolvimento r\u00e1pido:</p> Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.core.settings import SankhyaSettings\n\nsettings = SankhyaSettings(\n    base_url=\"https://api.sankhya.com.br\",\n    username=\"usuario_teste\",\n    password=\"senha_teste\"\n)\n\nwith SankhyaContext(settings) as ctx:\n    # ...\n</code></pre> <p>Aviso</p> <p>Nunca use credenciais hardcoded em c\u00f3digo de produ\u00e7\u00e3o!</p>"},{"location":"getting-started/authentication/#gerenciamento-de-sessoes","title":"Gerenciamento de Sess\u00f5es","text":""},{"location":"getting-started/authentication/#sessao-unica-padrao","title":"Sess\u00e3o \u00danica (Padr\u00e3o)","text":"<p>O context manager gerencia automaticamente login/logout:</p> Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    # Sess\u00e3o aberta\n    resultado = ctx.wrapper.find(...)\n# Sess\u00e3o fechada (logout autom\u00e1tico)\n</code></pre>"},{"location":"getting-started/authentication/#multiplas-sessoes","title":"M\u00faltiplas Sess\u00f5es","text":"<p>Para aplica\u00e7\u00f5es que precisam de m\u00faltiplas sess\u00f5es simult\u00e2neas:</p> Python<pre><code>from sankhya_sdk import SankhyaContext\n\n# Cria contexto principal\nctx = SankhyaContext.from_settings()\n\n# Adquire sess\u00f5es adicionais\ntoken1 = ctx.acquire_session()\ntoken2 = ctx.acquire_session()\n\n# Usa sess\u00f5es espec\u00edficas\nresult1 = ctx.invoke_with_token(token1, service_name, request)\nresult2 = ctx.invoke_with_token(token2, service_name, request)\n\n# Finaliza sess\u00f5es\nctx.finalize_session(token1)\nctx.finalize_session(token2)\n\n# Fecha contexto principal\nctx.dispose()\n</code></pre> <pre><code>sequenceDiagram\n    participant App as Aplica\u00e7\u00e3o\n    participant Ctx as SankhyaContext\n    participant API as API Sankhya\n\n    App-&gt;&gt;Ctx: from_settings()\n    Ctx-&gt;&gt;API: Login\n    API--&gt;&gt;Ctx: Session Token (Principal)\n\n    App-&gt;&gt;Ctx: acquire_session()\n    Ctx-&gt;&gt;API: Login\n    API--&gt;&gt;Ctx: Session Token 1\n\n    App-&gt;&gt;Ctx: acquire_session()\n    Ctx-&gt;&gt;API: Login\n    API--&gt;&gt;Ctx: Session Token 2\n\n    App-&gt;&gt;Ctx: invoke_with_token(token1, ...)\n    Ctx-&gt;&gt;API: Request com Token 1\n    API--&gt;&gt;Ctx: Response\n\n    App-&gt;&gt;Ctx: finalize_session(token1)\n    Ctx-&gt;&gt;API: Logout Token 1\n\n    App-&gt;&gt;Ctx: dispose()\n    Ctx-&gt;&gt;API: Logout Token 2\n    Ctx-&gt;&gt;API: Logout Principal</code></pre>"},{"location":"getting-started/authentication/#thread-safety","title":"Thread Safety","text":"<p>O SDK \u00e9 thread-safe. Para aplica\u00e7\u00f5es multi-thread:</p> Python<pre><code>import threading\nfrom sankhya_sdk import SankhyaContext\n\nctx = SankhyaContext.from_settings()\n\ndef worker(thread_id):\n    \"\"\"Cada thread usa uma sess\u00e3o separada.\"\"\"\n    token = ctx.acquire_session()\n    try:\n        # Opera\u00e7\u00f5es usando invoke_with_token\n        result = ctx.invoke_with_token(token, \"ServiceName\", request)\n        print(f\"Thread {thread_id}: {result}\")\n    finally:\n        ctx.finalize_session(token)\n\n# Cria threads\nthreads = [\n    threading.Thread(target=worker, args=(i,))\n    for i in range(5)\n]\n\n# Inicia threads\nfor t in threads:\n    t.start()\n\n# Aguarda conclus\u00e3o\nfor t in threads:\n    t.join()\n\nctx.dispose()\n</code></pre>"},{"location":"getting-started/authentication/#renovacao-automatica-de-token","title":"Renova\u00e7\u00e3o Autom\u00e1tica de Token","text":"<p>O SDK gerencia automaticamente a renova\u00e7\u00e3o de tokens expirados:</p> Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    # Se o token expirar durante uma opera\u00e7\u00e3o,\n    # o SDK automaticamente:\n    # 1. Detecta o erro de autentica\u00e7\u00e3o\n    # 2. Faz login novamente\n    # 3. Repete a opera\u00e7\u00e3o\n\n    for i in range(1000):  # Opera\u00e7\u00e3o longa\n        crud.find(Partner, f\"CODPARC = {i}\")\n        # Token renovado automaticamente se necess\u00e1rio\n</code></pre>"},{"location":"getting-started/authentication/#boas-praticas-de-seguranca","title":"Boas Pr\u00e1ticas de Seguran\u00e7a","text":""},{"location":"getting-started/authentication/#1-nunca-versione-credenciais","title":"1. Nunca Versione Credenciais","text":"Text Only<pre><code># .gitignore\n.env\n.env.*\n*.key\ncredentials/\n</code></pre>"},{"location":"getting-started/authentication/#2-use-variaveis-de-ambiente-em-cicd","title":"2. Use Vari\u00e1veis de Ambiente em CI/CD","text":"YAML<pre><code># GitHub Actions\nenv:\n  SANKHYA_BASE_URL: ${{ secrets.SANKHYA_URL }}\n  SANKHYA_USERNAME: ${{ secrets.SANKHYA_USER }}\n  SANKHYA_PASSWORD: ${{ secrets.SANKHYA_PASS }}\n</code></pre>"},{"location":"getting-started/authentication/#3-rotacione-credenciais-regularmente","title":"3. Rotacione Credenciais Regularmente","text":"Python<pre><code># Script de rota\u00e7\u00e3o (executar periodicamente)\nfrom sankhya_sdk.core.settings import SankhyaSettings\n\nold_settings = SankhyaSettings.from_key_file(\"old.key\", passphrase)\nnew_settings = SankhyaSettings(\n    base_url=old_settings.base_url,\n    username=old_settings.username,\n    password=new_password  # Nova senha\n)\nnew_settings.to_key_file(\"new.key\", new_passphrase)\n</code></pre>"},{"location":"getting-started/authentication/#4-use-usuarios-com-permissoes-minimas","title":"4. Use Usu\u00e1rios com Permiss\u00f5es M\u00ednimas","text":"<p>Crie usu\u00e1rios espec\u00edficos para cada integra\u00e7\u00e3o com apenas as permiss\u00f5es necess\u00e1rias:</p> Integra\u00e7\u00e3o Permiss\u00f5es Sincroniza\u00e7\u00e3o de Produtos Leitura de produtos Faturamento CRUD de notas fiscais Relat\u00f3rios Leitura geral"},{"location":"getting-started/authentication/#5-monitore-acessos","title":"5. Monitore Acessos","text":"Python<pre><code>import logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger('sankhya_sdk.auth')\n\n# Cada login/logout ser\u00e1 registrado\nwith SankhyaContext.from_settings() as ctx:\n    # [INFO] Login successful: user=admin, session=abc123\n    ...\n# [INFO] Logout: session=abc123\n</code></pre>"},{"location":"getting-started/authentication/#configuracao-por-ambiente","title":"Configura\u00e7\u00e3o por Ambiente","text":""},{"location":"getting-started/authentication/#estrutura-recomendada","title":"Estrutura Recomendada","text":"Text Only<pre><code>config/\n\u251c\u2500\u2500 .env.development\n\u251c\u2500\u2500 .env.staging\n\u251c\u2500\u2500 .env.production\n\u2514\u2500\u2500 credentials/\n    \u251c\u2500\u2500 dev.key\n    \u251c\u2500\u2500 staging.key\n    \u2514\u2500\u2500 prod.key\n</code></pre>"},{"location":"getting-started/authentication/#carregamento-dinamico","title":"Carregamento Din\u00e2mico","text":"Python<pre><code>import os\nfrom dotenv import load_dotenv\nfrom sankhya_sdk import SankhyaContext\n\n# Determina ambiente\nenv = os.getenv(\"APP_ENV\", \"development\")\n\n# Carrega arquivo correspondente\nload_dotenv(f\"config/.env.{env}\")\n\nwith SankhyaContext.from_settings() as ctx:\n    print(f\"Conectado ao ambiente: {env}\")\n</code></pre>"},{"location":"getting-started/authentication/#solucao-de-problemas","title":"Solu\u00e7\u00e3o de Problemas","text":""},{"location":"getting-started/authentication/#erro-invalid-credentials","title":"Erro: Invalid Credentials","text":"Python<pre><code>ServiceRequestInvalidAuthorizationException: Invalid credentials\n</code></pre> <p>Verifica\u00e7\u00f5es:</p> <ol> <li>Usu\u00e1rio e senha corretos</li> <li>Usu\u00e1rio tem acesso \u00e0 API</li> <li>Ambiente correto (produ\u00e7\u00e3o vs homologa\u00e7\u00e3o)</li> </ol>"},{"location":"getting-started/authentication/#erro-session-expired","title":"Erro: Session Expired","text":"Python<pre><code>ServiceRequestException: Session expired\n</code></pre> <p>Solu\u00e7\u00e3o: O SDK deve renovar automaticamente. Se persistir:</p> Python<pre><code>ctx.wrapper.logout()\nctx.wrapper.login()\n</code></pre>"},{"location":"getting-started/authentication/#erro-too-many-sessions","title":"Erro: Too Many Sessions","text":"Python<pre><code>ServiceRequestException: Maximum sessions exceeded\n</code></pre> <p>Solu\u00e7\u00e3o:</p> <ol> <li>Feche sess\u00f5es n\u00e3o utilizadas</li> <li>Use <code>dispose()</code> corretamente</li> <li>Aguarde expira\u00e7\u00e3o de sess\u00f5es antigas</li> </ol>"},{"location":"getting-started/authentication/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Arquitetura - Entenda a estrutura do SDK</li> <li>Gerenciamento de Sess\u00f5es - Detalhes avan\u00e7ados</li> <li>Tratamento de Erros - Estrat\u00e9gias de erro</li> </ul>"},{"location":"getting-started/installation/","title":"Instala\u00e7\u00e3o","text":"<p>Este guia detalha como instalar e configurar o Sankhya SDK Python em seu ambiente de desenvolvimento.</p>"},{"location":"getting-started/installation/#requisitos-do-sistema","title":"Requisitos do Sistema","text":"Requisito Vers\u00e3o M\u00ednima Recomendada Python 3.10 3.11+ pip 21.0 \u00daltima Sistema Operacional Windows/Linux/macOS -"},{"location":"getting-started/installation/#instalacao-via-pip","title":"Instala\u00e7\u00e3o via pip","text":""},{"location":"getting-started/installation/#modo-producao","title":"Modo Produ\u00e7\u00e3o","text":"Bash<pre><code># Instala\u00e7\u00e3o b\u00e1sica\npip install sankhya-sdk-python\n\n# Com suporte a opera\u00e7\u00f5es ass\u00edncronas\npip install sankhya-sdk-python[async]\n</code></pre>"},{"location":"getting-started/installation/#modo-desenvolvimento","title":"Modo Desenvolvimento","text":"<p>Para contribuir ou desenvolver localmente:</p> Bash<pre><code># Clone o reposit\u00f3rio\ngit clone https://github.com/onixbrasil/Sankhya-SDK-python.git\ncd Sankhya-SDK-python\n\n# Crie um ambiente virtual\npython -m venv .venv\n\n# Ative o ambiente virtual\n# Windows\n.venv\\Scripts\\activate\n# Linux/macOS\nsource .venv/bin/activate\n\n# Instale em modo desenvolvimento\npip install -e \".[dev,async,docs]\"\n</code></pre>"},{"location":"getting-started/installation/#configuracao-do-ambiente","title":"Configura\u00e7\u00e3o do Ambiente","text":""},{"location":"getting-started/installation/#variaveis-de-ambiente","title":"Vari\u00e1veis de Ambiente","text":"<p>Crie um arquivo <code>.env</code> na raiz do seu projeto:</p> INI<pre><code># .env\n# Configura\u00e7\u00f5es de Conex\u00e3o Sankhya\n\n# URL base da API (sem barra final)\nSANKHYA_BASE_URL=https://api.sankhya.com.br\n\n# Credenciais\nSANKHYA_USERNAME=seu_usuario\nSANKHYA_PASSWORD=sua_senha\n\n# Ambiente (producao, homologacao, treinamento)\nSANKHYA_ENVIRONMENT=producao\n\n# Configura\u00e7\u00f5es Opcionais\nSANKHYA_TIMEOUT=30\nSANKHYA_MAX_RETRIES=3\nSANKHYA_LOG_LEVEL=INFO\n</code></pre> <p>Seguran\u00e7a</p> <p>Nunca versione arquivos <code>.env</code> com credenciais reais. Adicione <code>.env</code> ao seu <code>.gitignore</code>.</p>"},{"location":"getting-started/installation/#exemplo-de-gitignore","title":"Exemplo de .gitignore","text":"Text Only<pre><code># Arquivos de configura\u00e7\u00e3o sens\u00edveis\n.env\n.env.local\n*.key\n\n# Ambiente virtual\n.venv/\nvenv/\n\n# Cache Python\n__pycache__/\n*.pyc\n</code></pre>"},{"location":"getting-started/installation/#configuracao-alternativa-arquivo-key","title":"Configura\u00e7\u00e3o Alternativa: Arquivo .key","text":"<p>Para ambientes mais seguros, voc\u00ea pode usar um arquivo de chave encriptado:</p> Python<pre><code>from sankhya_sdk import SankhyaContext, SankhyaSettings\n\nsettings = SankhyaSettings.from_key_file(\"caminho/para/credenciais.key\")\nctx = SankhyaContext(settings)\n</code></pre>"},{"location":"getting-started/installation/#verificacao-da-instalacao","title":"Verifica\u00e7\u00e3o da Instala\u00e7\u00e3o","text":"<p>Execute o seguinte script para verificar se a instala\u00e7\u00e3o est\u00e1 correta:</p> Python<pre><code>#!/usr/bin/env python3\n\"\"\"Verifica a instala\u00e7\u00e3o do Sankhya SDK.\"\"\"\n\nfrom sankhya_sdk import __version__\nfrom sankhya_sdk import SankhyaContext, SankhyaSettings\nfrom dotenv import load_dotenv\nimport os\n\n# Carrega vari\u00e1veis de ambiente\nload_dotenv()\n\nprint(f\"Sankhya SDK Python v{__version__}\")\nprint(\"-\" * 40)\n\n# Verifica configura\u00e7\u00e3o\ntry:\n    settings = SankhyaSettings()\n    print(f\"\u2705 URL Base: {settings.base_url}\")\n    print(f\"\u2705 Usu\u00e1rio: {settings.username}\")\n    print(f\"\u2705 Ambiente: {settings.environment}\")\nexcept Exception as e:\n    print(f\"\u274c Erro na configura\u00e7\u00e3o: {e}\")\n    exit(1)\n\n# Testa conex\u00e3o\ntry:\n    with SankhyaContext.from_settings() as ctx:\n        print(f\"\u2705 Conex\u00e3o estabelecida!\")\n        print(f\"\u2705 C\u00f3digo do usu\u00e1rio: {ctx.user_code}\")\nexcept Exception as e:\n    print(f\"\u274c Erro de conex\u00e3o: {e}\")\n    exit(1)\n\nprint(\"-\" * 40)\nprint(\"Instala\u00e7\u00e3o verificada com sucesso! \ud83c\udf89\")\n</code></pre>"},{"location":"getting-started/installation/#estrutura-do-projeto-recomendada","title":"Estrutura do Projeto Recomendada","text":"Text Only<pre><code>meu-projeto/\n\u251c\u2500\u2500 .env                    # Configura\u00e7\u00f5es (n\u00e3o versionado)\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 requirements.txt\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 integracao.py       # Seu c\u00f3digo de integra\u00e7\u00e3o\n\u251c\u2500\u2500 tests/\n\u2502   \u2514\u2500\u2500 test_integracao.py\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"getting-started/installation/#dependencias","title":"Depend\u00eancias","text":"<p>O SDK inclui as seguintes depend\u00eancias principais:</p> Pacote Vers\u00e3o Descri\u00e7\u00e3o <code>requests</code> \u22652.31.0 Cliente HTTP <code>pydantic</code> \u22652.5.0 Valida\u00e7\u00e3o de dados <code>pydantic-settings</code> \u22652.1.0 Configura\u00e7\u00f5es <code>python-dotenv</code> \u22651.0.0 Vari\u00e1veis de ambiente <code>lxml</code> \u22655.0.0 Processamento XML"},{"location":"getting-started/installation/#dependencias-opcionais","title":"Depend\u00eancias Opcionais","text":"Pacote Grupo Descri\u00e7\u00e3o <code>httpx</code> async Cliente HTTP ass\u00edncrono <code>aiofiles</code> async I/O de arquivos ass\u00edncrono <code>pytest</code> dev Framework de testes <code>mkdocs</code> docs Documenta\u00e7\u00e3o"},{"location":"getting-started/installation/#solucao-de-problemas","title":"Solu\u00e7\u00e3o de Problemas","text":""},{"location":"getting-started/installation/#erro-modulenotfounderror","title":"Erro: ModuleNotFoundError","text":"Text Only<pre><code>ModuleNotFoundError: No module named 'sankhya_sdk'\n</code></pre> <p>Solu\u00e7\u00e3o: Verifique se o ambiente virtual est\u00e1 ativado e o pacote instalado:</p> Bash<pre><code>pip list | grep sankhya\n</code></pre>"},{"location":"getting-started/installation/#erro-conexao-recusada","title":"Erro: Conex\u00e3o Recusada","text":"Text Only<pre><code>ConnectionError: Unable to connect to API\n</code></pre> <p>Solu\u00e7\u00f5es:</p> <ol> <li>Verifique a URL no <code>.env</code></li> <li>Teste conectividade de rede</li> <li>Verifique se h\u00e1 firewall bloqueando</li> </ol>"},{"location":"getting-started/installation/#erro-credenciais-invalidas","title":"Erro: Credenciais Inv\u00e1lidas","text":"Text Only<pre><code>ServiceRequestInvalidAuthorizationException: Invalid credentials\n</code></pre> <p>Solu\u00e7\u00f5es:</p> <ol> <li>Verifique usu\u00e1rio e senha</li> <li>Confirme que o usu\u00e1rio tem acesso \u00e0 API</li> <li>Verifique o ambiente (produ\u00e7\u00e3o vs homologa\u00e7\u00e3o)</li> </ol>"},{"location":"getting-started/installation/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>In\u00edcio R\u00e1pido - Crie sua primeira integra\u00e7\u00e3o</li> <li>Autentica\u00e7\u00e3o - Aprofunde-se em autentica\u00e7\u00e3o</li> <li>Arquitetura - Entenda a estrutura do SDK</li> </ul>"},{"location":"getting-started/quick-start/","title":"In\u00edcio R\u00e1pido","text":"<p>Este guia mostra como criar sua primeira integra\u00e7\u00e3o com a API Sankhya usando o SDK Python.</p>"},{"location":"getting-started/quick-start/#exemplo-hello-world","title":"Exemplo \"Hello World\"","text":"<p>O exemplo mais simples de uso do SDK:</p> Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom dotenv import load_dotenv\n\n# Carrega configura\u00e7\u00f5es do arquivo .env\nload_dotenv()\n\n# Conecta \u00e0 API usando context manager\nwith SankhyaContext.from_settings() as ctx:\n    print(f\"Conectado com sucesso!\")\n    print(f\"Usu\u00e1rio: {ctx.user_code}\")\n</code></pre>"},{"location":"getting-started/quick-start/#sua-primeira-consulta","title":"Sua Primeira Consulta","text":"<p>Vamos buscar dados de parceiros (clientes/fornecedores):</p> Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nwith SankhyaContext.from_settings() as ctx:\n    # Cria o wrapper CRUD\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Busca os 10 primeiros parceiros\n    partners = crud.find(\n        entity_type=Partner,\n        criteria=\"CODPARC &gt; 0\",\n        max_results=10\n    )\n\n    # Exibe resultados\n    for partner in partners:\n        print(f\"C\u00f3digo: {partner.code_partner}\")\n        print(f\"Nome: {partner.name}\")\n        print(\"-\" * 40)\n</code></pre>"},{"location":"getting-started/quick-start/#entendendo-o-codigo","title":"Entendendo o C\u00f3digo","text":""},{"location":"getting-started/quick-start/#1-context-manager","title":"1. Context Manager","text":"<p>O <code>SankhyaContext</code> gerencia o ciclo de vida da conex\u00e3o:</p> Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    # Conex\u00e3o automaticamente aberta\n    ...\n# Conex\u00e3o automaticamente fechada (logout)\n</code></pre> <p>Boas Pr\u00e1ticas</p> <p>Sempre use o context manager (<code>with</code>) para garantir que a sess\u00e3o seja fechada corretamente, mesmo em caso de exce\u00e7\u00f5es.</p>"},{"location":"getting-started/quick-start/#2-request-wrappers","title":"2. Request Wrappers","text":"<p>O SDK fornece wrappers de alto n\u00edvel para opera\u00e7\u00f5es comuns:</p> Wrapper Descri\u00e7\u00e3o <code>SimpleCRUDRequestWrapper</code> Opera\u00e7\u00f5es CRUD b\u00e1sicas <code>PagedRequestWrapper</code> Consultas paginadas para grandes volumes <code>OnDemandRequestWrapper</code> Processamento em lote ass\u00edncrono <code>KnowServicesRequestWrapper</code> Servi\u00e7os espec\u00edficos (NF-e, faturamento, etc.)"},{"location":"getting-started/quick-start/#3-transport-entities","title":"3. Transport Entities","text":"<p>Entidades pr\u00e9-definidas para intera\u00e7\u00e3o com a API:</p> Python<pre><code>from sankhya_sdk.transport_entities import (\n    Partner,        # Parceiros (clientes/fornecedores)\n    Product,        # Produtos\n    InvoiceHeader,  # Cabe\u00e7alho de notas fiscais\n    # ... e mais\n)\n</code></pre>"},{"location":"getting-started/quick-start/#exemplo-completo-crud-de-parceiros","title":"Exemplo Completo: CRUD de Parceiros","text":""},{"location":"getting-started/quick-start/#buscar-find","title":"Buscar (Find)","text":"Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.request_wrappers import SimpleCRUDRequestWrapper\nfrom sankhya_sdk.transport_entities import Partner\nfrom sankhya_sdk.helpers import EntityQueryOptions\n\nwith SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Busca simples\n    partners = crud.find(Partner, \"CODPARC = 1\")\n\n    # Busca com op\u00e7\u00f5es avan\u00e7adas\n    options = EntityQueryOptions(\n        include_fields=[\"CODPARC\", \"NOMEPARC\", \"CGC_CPF\"],\n        order_by=\"NOMEPARC\",\n        max_results=100\n    )\n    partners = crud.find_with_options(Partner, \"ATIVO = 'S'\", options)\n</code></pre>"},{"location":"getting-started/quick-start/#atualizar-update","title":"Atualizar (Update)","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Busca o parceiro\n    partners = crud.find(Partner, \"CODPARC = 1\")\n\n    if partners:\n        partner = partners[0]\n        partner.email = \"novo@email.com\"\n\n        # Atualiza\n        result = crud.update(partner)\n        print(f\"Parceiro atualizado: {result}\")\n</code></pre>"},{"location":"getting-started/quick-start/#criar-insert","title":"Criar (Insert)","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Cria novo parceiro\n    new_partner = Partner()\n    new_partner.name = \"Novo Cliente LTDA\"\n    new_partner.cgc_cpf = \"12345678000199\"\n    new_partner.type_partner = \"C\"  # Cliente\n\n    # Insere\n    result = crud.insert(new_partner)\n    print(f\"Parceiro criado com c\u00f3digo: {result.code_partner}\")\n</code></pre>"},{"location":"getting-started/quick-start/#remover-delete","title":"Remover (Delete)","text":"Python<pre><code>with SankhyaContext.from_settings() as ctx:\n    crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n\n    # Remove parceiro\n    partner = Partner()\n    partner.code_partner = 999  # ID do parceiro a remover\n\n    result = crud.remove(partner)\n    print(f\"Parceiro removido: {result}\")\n</code></pre>"},{"location":"getting-started/quick-start/#tratamento-de-erros","title":"Tratamento de Erros","text":"<p>Sempre trate exce\u00e7\u00f5es para uma integra\u00e7\u00e3o robusta:</p> Python<pre><code>from sankhya_sdk import SankhyaContext\nfrom sankhya_sdk.exceptions import (\n    SankhyaException,\n    ServiceRequestException,\n    ServiceRequestInvalidAuthorizationException,\n)\n\ntry:\n    with SankhyaContext.from_settings() as ctx:\n        crud = SimpleCRUDRequestWrapper(ctx.wrapper)\n        partners = crud.find(Partner, \"CODPARC &gt; 0\")\n\nexcept ServiceRequestInvalidAuthorizationException:\n    print(\"Erro: Credenciais inv\u00e1lidas\")\n\nexcept ServiceRequestException as e:\n    print(f\"Erro na requisi\u00e7\u00e3o: {e.message}\")\n    print(f\"Status: {e.status_message}\")\n\nexcept SankhyaException as e:\n    print(f\"Erro geral do SDK: {e}\")\n\nexcept Exception as e:\n    print(f\"Erro inesperado: {e}\")\n</code></pre>"},{"location":"getting-started/quick-start/#logging","title":"Logging","text":"<p>O SDK suporta logging integrado:</p> Python<pre><code>import logging\n\n# Configura logging\nlogging.basicConfig(\n    level=logging.DEBUG,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'\n)\n\n# O SDK usar\u00e1 o logger 'sankhya_sdk'\nlogger = logging.getLogger('sankhya_sdk')\nlogger.setLevel(logging.DEBUG)\n\nwith SankhyaContext.from_settings() as ctx:\n    # Logs detalhados ser\u00e3o exibidos\n    ...\n</code></pre>"},{"location":"getting-started/quick-start/#fluxo-tipico-de-integracao","title":"Fluxo T\u00edpico de Integra\u00e7\u00e3o","text":"<pre><code>flowchart TD\n    A[Carregar Configura\u00e7\u00f5es] --&gt; B[Criar SankhyaContext]\n    B --&gt; C[Autentica\u00e7\u00e3o Autom\u00e1tica]\n    C --&gt; D{Sucesso?}\n    D --&gt;|N\u00e3o| E[Tratar Erro]\n    D --&gt;|Sim| F[Criar Request Wrapper]\n    F --&gt; G[Executar Opera\u00e7\u00f5es]\n    G --&gt; H[Processar Resultados]\n    H --&gt; I[Fechar Contexto]\n    E --&gt; J[Logging/Retry]\n    J --&gt; B</code></pre>"},{"location":"getting-started/quick-start/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Autentica\u00e7\u00e3o - M\u00e9todos avan\u00e7ados de autentica\u00e7\u00e3o</li> <li>Arquitetura - Entenda a arquitetura do SDK</li> <li>Exemplos - Mais exemplos pr\u00e1ticos</li> <li>Refer\u00eancia da API - Documenta\u00e7\u00e3o completa</li> </ul>"}]}